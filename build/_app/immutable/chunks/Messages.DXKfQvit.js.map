{"version":3,"file":"Messages.DXKfQvit.js","sources":["../../../../../../src/lib/workers/KokoroWorker.ts","../../../../../../src/lib/components/icons/Bolt.svelte","../../../../../../src/lib/components/chat/Suggestions.svelte","../../../../../../src/lib/components/icons/EyeSlash.svelte","../../../../../../src/lib/components/chat/Messages/Skeleton.svelte","../../../../../../src/lib/components/chat/Messages/RateComment.svelte","../../../../../../src/lib/components/chat/Messages/ResponseMessage/WebSearchResults.svelte","../../../../../../src/lib/components/icons/Sparkles.svelte","../../../../../../src/lib/components/chat/Messages/Error.svelte","../../../../../../src/lib/components/chat/Messages/CitationsModal.svelte","../../../../../../src/lib/components/chat/Messages/Citations.svelte","../../../../../../src/lib/components/chat/Messages/CodeExecutionModal.svelte","../../../../../../src/lib/components/chat/Messages/CodeExecutions.svelte","../../../../../../src/lib/components/icons/ChatBubble.svelte","../../../../../../src/lib/components/icons/LightBlub.svelte","../../../../../../src/lib/components/chat/ContentRenderer/FloatingButtons.svelte","../../../../../../src/lib/components/chat/Messages/ContentRenderer.svelte","../../../../../../src/lib/components/chat/Messages/ResponseMessage.svelte","../../../../../../src/lib/components/icons/Merge.svelte","../../../../../../src/lib/components/chat/Messages/MultiResponseMessages.svelte","../../../../../../src/lib/components/chat/Messages/UserMessage.svelte","../../../../../../src/lib/components/chat/Messages/Message.svelte","../../../../../../src/lib/components/chat/ChatPlaceholder.svelte","../../../../../../src/lib/components/chat/Messages.svelte"],"sourcesContent":["import WorkerInstance from '$lib/workers/kokoro.worker?worker';\r\n\r\nexport class KokoroWorker {\r\n\tprivate worker: Worker | null = null;\r\n\tprivate initialized: boolean = false;\r\n\tprivate dtype: string;\r\n\tprivate requestQueue: Array<{\r\n\t\ttext: string;\r\n\t\tvoice: string;\r\n\t\tresolve: (value: string) => void;\r\n\t\treject: (reason: any) => void;\r\n\t}> = [];\r\n\tprivate processing = false; // To track if a request is being processed\r\n\r\n\tconstructor(dtype: string = 'fp32') {\r\n\t\tthis.dtype = dtype;\r\n\t}\r\n\r\n\tpublic async init() {\r\n\t\tif (this.worker) {\r\n\t\t\tconsole.warn('KokoroWorker is already initialized.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.worker = new WorkerInstance();\r\n\r\n\t\t// Handle worker messages\r\n\t\tthis.worker.onmessage = (event) => {\r\n\t\t\tconst { status, error, audioUrl } = event.data;\r\n\r\n\t\t\tif (status === 'init:complete') {\r\n\t\t\t\tthis.initialized = true;\r\n\t\t\t} else if (status === 'init:error') {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t\tthis.initialized = false;\r\n\t\t\t} else if (status === 'generate:complete') {\r\n\t\t\t\t// Resolve promise from queue\r\n\t\t\t\tconst request = this.requestQueue.shift();\r\n\t\t\t\tif (request) {\r\n\t\t\t\t\trequest.resolve(audioUrl);\r\n\t\t\t\t\tthis.processNextRequest(); // Process next request in queue\r\n\t\t\t\t}\r\n\t\t\t} else if (status === 'generate:error') {\r\n\t\t\t\tconst request = this.requestQueue.shift();\r\n\t\t\t\tif (request) {\r\n\t\t\t\t\trequest.reject(new Error(error));\r\n\t\t\t\t\tthis.processNextRequest(); // Continue processing next in queue\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn new Promise<void>((resolve, reject) => {\r\n\t\t\tthis.worker!.postMessage({\r\n\t\t\t\ttype: 'init',\r\n\t\t\t\tpayload: { dtype: this.dtype }\r\n\t\t\t});\r\n\r\n\t\t\tconst handleMessage = (event: MessageEvent) => {\r\n\t\t\t\tif (event.data.status === 'init:complete') {\r\n\t\t\t\t\tthis.worker!.removeEventListener('message', handleMessage);\r\n\t\t\t\t\tthis.initialized = true;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t} else if (event.data.status === 'init:error') {\r\n\t\t\t\t\tthis.worker!.removeEventListener('message', handleMessage);\r\n\t\t\t\t\treject(new Error(event.data.error));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.worker!.addEventListener('message', handleMessage);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic async generate({ text, voice }: { text: string; voice: string }): Promise<string> {\r\n\t\tif (!this.initialized || !this.worker) {\r\n\t\t\tthrow new Error('KokoroTTS Worker is not initialized yet.');\r\n\t\t}\r\n\r\n\t\treturn new Promise<string>((resolve, reject) => {\r\n\t\t\tthis.requestQueue.push({ text, voice, resolve, reject });\r\n\t\t\tif (!this.processing) {\r\n\t\t\t\tthis.processNextRequest();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate processNextRequest() {\r\n\t\tif (this.requestQueue.length === 0) {\r\n\t\t\tthis.processing = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.processing = true;\r\n\t\tconst { text, voice } = this.requestQueue[0]; // Get first request but don't remove yet\r\n\t\tthis.worker!.postMessage({ type: 'generate', payload: { text, voice } });\r\n\t}\r\n\r\n\tpublic terminate() {\r\n\t\tif (this.worker) {\r\n\t\t\tthis.worker.terminate();\r\n\t\t\tthis.worker = null;\r\n\t\t\tthis.initialized = false;\r\n\t\t\tthis.requestQueue = [];\r\n\t\t\tthis.processing = false;\r\n\t\t}\r\n\t}\r\n}\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-3';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport Fuse from 'fuse.js';\r\n\timport Bolt from '$lib/components/icons/Bolt.svelte';\r\n\timport { onMount, getContext, createEventDispatcher } from 'svelte';\r\n\timport { WEBUI_NAME } from '$lib/stores';\r\n\timport { WEBUI_VERSION } from '$lib/constants';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let suggestionPrompts = [];\r\n\texport let className = '';\r\n\texport let inputValue = '';\r\n\r\n\tlet sortedPrompts = [];\r\n\r\n\tconst fuseOptions = {\r\n\t\tkeys: ['content', 'title'],\r\n\t\tthreshold: 0.5\r\n\t};\r\n\r\n\tlet fuse;\r\n\tlet filteredPrompts = [];\r\n\r\n\t// Initialize Fuse\r\n\t$: fuse = new Fuse(sortedPrompts, fuseOptions);\r\n\r\n\t// Update the filteredPrompts if inputValue changes\r\n\t// Only increase version if something wirklich geändert hat\r\n\t$: getFilteredPrompts(inputValue);\r\n\r\n\t// Helper function to check if arrays are the same\r\n\t// (based on unique IDs oder content)\r\n\tfunction arraysEqual(a, b) {\r\n\t\tif (a.length !== b.length) return false;\r\n\t\tfor (let i = 0; i < a.length; i++) {\r\n\t\t\tif ((a[i].id ?? a[i].content) !== (b[i].id ?? b[i].content)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tconst getFilteredPrompts = (inputValue) => {\r\n\t\tif (inputValue.length > 500) {\r\n\t\t\tfilteredPrompts = [];\r\n\t\t} else {\r\n\t\t\tconst newFilteredPrompts = inputValue.trim()\r\n\t\t\t\t? fuse.search(inputValue.trim()).map((result) => result.item)\r\n\t\t\t\t: sortedPrompts;\r\n\r\n\t\t\t// Compare with the oldFilteredPrompts\r\n\t\t\t// If there's a difference, update array + version\r\n\t\t\tif (!arraysEqual(filteredPrompts, newFilteredPrompts)) {\r\n\t\t\t\tfilteredPrompts = newFilteredPrompts;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t$: if (suggestionPrompts) {\r\n\t\tsortedPrompts = [...(suggestionPrompts ?? [])].sort(() => Math.random() - 0.5);\r\n\t\tgetFilteredPrompts(inputValue);\r\n\t}\r\n</script>\r\n\r\n<div class=\"mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600\">\r\n\t{#if filteredPrompts.length > 0}\r\n\t\t<Bolt />\r\n\t\t{$i18n.t('Suggested')}\r\n\t{:else}\r\n\t\t<!-- Keine Vorschläge -->\r\n\r\n\t\t<div\r\n\t\t\tclass=\"flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600\"\r\n\t\t>\r\n\t\t\t{$WEBUI_NAME} ‧ v{WEBUI_VERSION}\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n\r\n<div class=\"h-40 overflow-auto scrollbar-none {className} items-start\">\r\n\t{#if filteredPrompts.length > 0}\r\n\t\t{#each filteredPrompts as prompt, idx (prompt.id || prompt.content)}\r\n\t\t\t<button\r\n\t\t\t\tclass=\"waterfall flex flex-col flex-1 shrink-0 w-full justify-between\r\n\t\t\t\t       px-3 py-2 rounded-xl bg-transparent hover:bg-black/5\r\n\t\t\t\t       dark:hover:bg-white/5 transition group\"\r\n\t\t\t\tstyle=\"animation-delay: {idx * 60}ms\"\r\n\t\t\t\ton:click={() => dispatch('select', prompt.content)}\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex flex-col text-left\">\r\n\t\t\t\t\t{#if prompt.title && prompt.title[0] !== ''}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{prompt.title[0]}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500 font-normal line-clamp-1\">\r\n\t\t\t\t\t\t\t{prompt.title[1]}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{prompt.content}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"text-xs text-gray-500 font-normal line-clamp-1\">{$i18n.t('Prompt')}</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</button>\r\n\t\t{/each}\r\n\t{/if}\r\n</div>\r\n\r\n<style>\r\n\t/* Waterfall animation for the suggestions */\r\n\t@keyframes fadeInUp {\r\n\t\t0% {\r\n\t\t\topacity: 0;\r\n\t\t\ttransform: translateY(20px);\r\n\t\t}\r\n\t\t100% {\r\n\t\t\topacity: 1;\r\n\t\t\ttransform: translateY(0);\r\n\t\t}\r\n\t}\r\n\r\n\t.waterfall {\r\n\t\topacity: 0;\r\n\t\tanimation-name: fadeInUp;\r\n\t\tanimation-duration: 200ms;\r\n\t\tanimation-fill-mode: forwards;\r\n\t\tanimation-timing-function: ease;\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let size = 'md';\r\n</script>\r\n\r\n<div class=\"w-full mt-2 mb-2\">\r\n\t<div class=\"animate-pulse flex w-full\">\r\n\t\t<div class=\"{size === 'md' ? 'space-y-2' : 'space-y-1.5'} w-full\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"{size === 'md' ? 'h-2' : 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm mr-14\"\r\n\t\t\t/>\r\n\r\n\t\t\t<div class=\"grid grid-cols-3 gap-4\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"grid grid-cols-4 gap-4\">\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"{size === 'md'\r\n\t\t\t\t\t\t? 'h-2'\r\n\t\t\t\t\t\t: 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"{size === 'md' ? 'h-2' : 'h-1.5'} bg-gray-200 dark:bg-gray-600 rounded-sm\" />\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { createEventDispatcher, onMount, getContext } from 'svelte';\r\n\timport { config, models } from '$lib/stores';\r\n\timport Tags from '$lib/components/common/Tags.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let message;\r\n\texport let show = false;\r\n\r\n\tlet LIKE_REASONS = [\r\n\t\t'accurate_information',\r\n\t\t'followed_instructions_perfectly',\r\n\t\t'showcased_creativity',\r\n\t\t'positive_attitude',\r\n\t\t'attention_to_detail',\r\n\t\t'thorough_explanation',\r\n\t\t'other'\r\n\t];\r\n\tlet DISLIKE_REASONS = [\r\n\t\t'dont_like_the_style',\r\n\t\t'too_verbose',\r\n\t\t'not_helpful',\r\n\t\t'not_factually_correct',\r\n\t\t'didnt_fully_follow_instructions',\r\n\t\t'refused_when_it_shouldnt_have',\r\n\t\t'being_lazy',\r\n\t\t'other'\r\n\t];\r\n\r\n\tlet tags = [];\r\n\r\n\tlet reasons = [];\r\n\tlet selectedReason = null;\r\n\tlet comment = '';\r\n\r\n\tlet detailedRating = null;\r\n\tlet selectedModel = null;\r\n\r\n\t$: if (message?.annotation?.rating === 1) {\r\n\t\treasons = LIKE_REASONS;\r\n\t} else if (message?.annotation?.rating === -1) {\r\n\t\treasons = DISLIKE_REASONS;\r\n\t}\r\n\r\n\t$: if (message) {\r\n\t\tinit();\r\n\t}\r\n\r\n\tconst init = () => {\r\n\t\tif (!selectedReason) {\r\n\t\t\tselectedReason = message?.annotation?.reason ?? '';\r\n\t\t}\r\n\r\n\t\tif (!comment) {\r\n\t\t\tcomment = message?.annotation?.comment ?? '';\r\n\t\t}\r\n\r\n\t\ttags = (message?.annotation?.tags ?? []).map((tag) => ({\r\n\t\t\tname: tag\r\n\t\t}));\r\n\r\n\t\tif (!detailedRating) {\r\n\t\t\tdetailedRating = message?.annotation?.details?.rating ?? null;\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tif (message?.arena) {\r\n\t\t\tselectedModel = $models.find((m) => m.id === message.selectedModelId);\r\n\t\t\ttoast.success(\r\n\t\t\t\t$i18n.t('This response was generated by \"{{model}}\"', {\r\n\t\t\t\t\tmodel: selectedModel ? (selectedModel?.name ?? selectedModel.id) : message.selectedModelId\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t});\r\n\r\n\tconst saveHandler = () => {\r\n\t\tconsole.log('saveHandler');\r\n\t\t// if (!selectedReason) {\r\n\t\t// \ttoast.error($i18n.t('Please select a reason'));\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\tdispatch('save', {\r\n\t\t\treason: selectedReason,\r\n\t\t\tcomment: comment,\r\n\t\t\ttags: tags.map((tag) => tag.name),\r\n\t\t\tdetails: {\r\n\t\t\t\trating: detailedRating\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\ttoast.success($i18n.t('Thanks for your feedback!'));\r\n\t\tshow = false;\r\n\t};\r\n</script>\r\n\r\n{#if message?.arena}\r\n\t<div class=\"text-xs font-medium pt-1.5 -mb-0.5\">\r\n\t\t{$i18n.t('This response was generated by \"{{model}}\"', {\r\n\t\t\tmodel: selectedModel ? (selectedModel?.name ?? selectedModel.id) : message.selectedModelId\r\n\t\t})}\r\n\t</div>\r\n{/if}\r\n\r\n<div\r\n\tclass=\" my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850\"\r\n\tid=\"message-feedback-{message.id}\"\r\n>\r\n\t<div class=\"flex justify-between items-center\">\r\n\t\t<div class=\"text-sm font-medium\">{$i18n.t('How would you rate this response?')}</div>\r\n\r\n\t\t<!-- <div class=\" text-sm\">{$i18n.t('Tell us more:')}</div> -->\r\n\r\n\t\t<button\r\n\t\t\ton:click={() => {\r\n\t\t\t\tshow = false;\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\tclass=\"size-4\"\r\n\t\t\t>\r\n\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18 18 6M6 6l12 12\" />\r\n\t\t\t</svg>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div class=\"w-full flex justify-center\">\r\n\t\t<div class=\" relative w-fit\">\r\n\t\t\t<div class=\"mt-1.5 w-fit flex gap-1 pb-5\">\r\n\t\t\t\t<!-- 1-10 scale -->\r\n\t\t\t\t{#each Array.from({ length: 10 }).map((_, i) => i + 1) as rating}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 {detailedRating ===\r\n\t\t\t\t\t\trating\r\n\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t: ''} transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tdetailedRating = rating;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdisabled={message?.annotation?.rating === -1 ? rating > 5 : rating < 6}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{rating}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"absolute bottom-0 left-0 right-0 flex justify-between text-xs\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t1 - {$i18n.t('Awful')}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t10 - {$i18n.t('Amazing')}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div>\r\n\t\t{#if reasons.length > 0}\r\n\t\t\t<div class=\"text-sm mt-1.5 font-medium\">{$i18n.t('Why?')}</div>\r\n\r\n\t\t\t<div class=\"flex flex-wrap gap-1.5 text-sm mt-1.5\">\r\n\t\t\t\t{#each reasons as reason}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 {selectedReason ===\r\n\t\t\t\t\t\treason\r\n\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t: ''} transition rounded-xl\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tselectedReason = reason;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if reason === 'accurate_information'}\r\n\t\t\t\t\t\t\t{$i18n.t('Accurate information')}\r\n\t\t\t\t\t\t{:else if reason === 'followed_instructions_perfectly'}\r\n\t\t\t\t\t\t\t{$i18n.t('Followed instructions perfectly')}\r\n\t\t\t\t\t\t{:else if reason === 'showcased_creativity'}\r\n\t\t\t\t\t\t\t{$i18n.t('Showcased creativity')}\r\n\t\t\t\t\t\t{:else if reason === 'positive_attitude'}\r\n\t\t\t\t\t\t\t{$i18n.t('Positive attitude')}\r\n\t\t\t\t\t\t{:else if reason === 'attention_to_detail'}\r\n\t\t\t\t\t\t\t{$i18n.t('Attention to detail')}\r\n\t\t\t\t\t\t{:else if reason === 'thorough_explanation'}\r\n\t\t\t\t\t\t\t{$i18n.t('Thorough explanation')}\r\n\t\t\t\t\t\t{:else if reason === 'dont_like_the_style'}\r\n\t\t\t\t\t\t\t{$i18n.t(\"Don't like the style\")}\r\n\t\t\t\t\t\t{:else if reason === 'too_verbose'}\r\n\t\t\t\t\t\t\t{$i18n.t('Too verbose')}\r\n\t\t\t\t\t\t{:else if reason === 'not_helpful'}\r\n\t\t\t\t\t\t\t{$i18n.t('Not helpful')}\r\n\t\t\t\t\t\t{:else if reason === 'not_factually_correct'}\r\n\t\t\t\t\t\t\t{$i18n.t('Not factually correct')}\r\n\t\t\t\t\t\t{:else if reason === 'didnt_fully_follow_instructions'}\r\n\t\t\t\t\t\t\t{$i18n.t(\"Didn't fully follow instructions\")}\r\n\t\t\t\t\t\t{:else if reason === 'refused_when_it_shouldnt_have'}\r\n\t\t\t\t\t\t\t{$i18n.t(\"Refused when it shouldn't have\")}\r\n\t\t\t\t\t\t{:else if reason === 'being_lazy'}\r\n\t\t\t\t\t\t\t{$i18n.t('Being lazy')}\r\n\t\t\t\t\t\t{:else if reason === 'other'}\r\n\t\t\t\t\t\t\t{$i18n.t('Other')}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{reason}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t</div>\r\n\r\n\t<div class=\"mt-2\">\r\n\t\t<textarea\r\n\t\t\tbind:value={comment}\r\n\t\t\tclass=\"w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl\"\r\n\t\t\tplaceholder={$i18n.t('Feel free to add specific details')}\r\n\t\t\trows=\"3\"\r\n\t\t/>\r\n\t</div>\r\n\r\n\t<div class=\"mt-2 gap-1.5 flex justify-between\">\r\n\t\t<div class=\"flex items-end group\">\r\n\t\t\t<Tags\r\n\t\t\t\t{tags}\r\n\t\t\t\ton:delete={(e) => {\r\n\t\t\t\t\ttags = tags.filter(\r\n\t\t\t\t\t\t(tag) =>\r\n\t\t\t\t\t\t\ttag.name.replaceAll(' ', '_').toLowerCase() !==\r\n\t\t\t\t\t\t\te.detail.replaceAll(' ', '_').toLowerCase()\r\n\t\t\t\t\t);\r\n\t\t\t\t}}\r\n\t\t\t\ton:add={(e) => {\r\n\t\t\t\t\ttags = [...tags, { name: e.detail }];\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\r\n\t\t<button\r\n\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\r\n\t\t\ton:click={() => {\r\n\t\t\t\tsaveHandler();\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{$i18n.t('Save')}\r\n\t\t</button>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport ChevronDown from '$lib/components/icons/ChevronDown.svelte';\r\n\timport ChevronUp from '$lib/components/icons/ChevronUp.svelte';\r\n\timport MagnifyingGlass from '$lib/components/icons/MagnifyingGlass.svelte';\r\n\timport Collapsible from '$lib/components/common/Collapsible.svelte';\r\n\r\n\texport let status = { urls: [], query: '' };\r\n\tlet state = false;\r\n</script>\r\n\r\n<Collapsible bind:open={state} className=\"w-full space-y-1\">\r\n\t<div\r\n\t\tclass=\"flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition\"\r\n\t>\r\n\t\t<slot />\r\n\r\n\t\t{#if state}\r\n\t\t\t<ChevronUp strokeWidth=\"3.5\" className=\"size-3.5 \" />\r\n\t\t{:else}\r\n\t\t\t<ChevronDown strokeWidth=\"3.5\" className=\"size-3.5 \" />\r\n\t\t{/if}\r\n\t</div>\r\n\t<div\r\n\t\tclass=\"text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5\"\r\n\t\tslot=\"content\"\r\n\t>\r\n\t\t{#if status?.query}\r\n\t\t\t<a\r\n\t\t\t\thref=\"https://www.google.com/search?q={status.query}\"\r\n\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\tclass=\"flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex gap-2 items-center\">\r\n\t\t\t\t\t<MagnifyingGlass />\r\n\r\n\t\t\t\t\t<div class=\" line-clamp-1\">\r\n\t\t\t\t\t\t{status.query}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!--  -->\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\r\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t</a>\r\n\t\t{/if}\r\n\r\n\t\t{#each status.urls as url, urlIdx}\r\n\t\t\t<a\r\n\t\t\t\thref={url}\r\n\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\tclass=\"flex w-full items-center p-3 px-4 {urlIdx === status.urls.length - 1\r\n\t\t\t\t\t? ''\r\n\t\t\t\t\t: 'border-b border-gray-300/30 dark:border-gray-700/50'} group/item justify-between font-normal text-gray-800 dark:text-gray-300\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\" line-clamp-1\">\r\n\t\t\t\t\t{url}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\" ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<!--  -->\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\r\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</div>\r\n\t\t\t</a>\r\n\t\t{/each}\r\n\t</div>\r\n</Collapsible>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport Info from '$lib/components/icons/Info.svelte';\r\n\r\n\texport let content = '';\r\n</script>\r\n\r\n<div class=\"flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg\">\r\n\t<div class=\" self-start mt-0.5\">\r\n\t\t<Info className=\"size-5 text-red-700 dark:text-red-400\" />\r\n\t</div>\r\n\r\n\t<div class=\" self-center text-sm\">\r\n\t\t{typeof content === 'string' ? content : JSON.stringify(content)}\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { getContext, onMount, tick } from 'svelte';\r\n\timport Modal from '$lib/components/common/Modal.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let show = false;\r\n\texport let citation;\r\n\texport let showPercentage = false;\r\n\texport let showRelevance = true;\r\n\r\n\tlet mergedDocuments = [];\r\n\r\n\tfunction calculatePercentage(distance: number) {\r\n\t\tif (distance < 0) return 0;\r\n\t\tif (distance > 1) return 100;\r\n\t\treturn Math.round(distance * 10000) / 100;\r\n\t}\r\n\r\n\tfunction getRelevanceColor(percentage: number) {\r\n\t\tif (percentage >= 80)\r\n\t\t\treturn 'bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200';\r\n\t\tif (percentage >= 60)\r\n\t\t\treturn 'bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200';\r\n\t\tif (percentage >= 40)\r\n\t\t\treturn 'bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200';\r\n\t\treturn 'bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200';\r\n\t}\r\n\r\n\t$: if (citation) {\r\n\t\tmergedDocuments = citation.document?.map((c, i) => {\r\n\t\t\treturn {\r\n\t\t\t\tsource: citation.source,\r\n\t\t\t\tdocument: c,\r\n\t\t\t\tmetadata: citation.metadata?.[i],\r\n\t\t\t\tdistance: citation.distances?.[i]\r\n\t\t\t};\r\n\t\t});\r\n\t\tif (mergedDocuments.every((doc) => doc.distance !== undefined)) {\r\n\t\t\tmergedDocuments = mergedDocuments.sort(\r\n\t\t\t\t(a, b) => (b.distance ?? Infinity) - (a.distance ?? Infinity)\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<Modal size=\"lg\" bind:show>\r\n\t<div>\r\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4 pb-2\">\r\n\t\t\t<div class=\" text-lg font-medium self-center capitalize\">\r\n\t\t\t\t{$i18n.t('Citation')}\r\n\t\t\t</div>\r\n\t\t\t<button\r\n\t\t\t\tclass=\"self-center\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshow = false;\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden\"\r\n\t\t\t>\r\n\t\t\t\t{#each mergedDocuments as document, documentIdx}\r\n\t\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t\t<div class=\"text-sm font-medium dark:text-gray-300\">\r\n\t\t\t\t\t\t\t{$i18n.t('Source')}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{#if document.source?.name}\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\tclassName=\"w-fit\"\r\n\t\t\t\t\t\t\t\tcontent={$i18n.t('Open file')}\r\n\t\t\t\t\t\t\t\tplacement=\"top-start\"\r\n\t\t\t\t\t\t\t\ttippyOptions={{ duration: [500, 0] }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm dark:text-gray-400 flex items-center gap-2 w-fit\">\r\n\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\tclass=\"hover:text-gray-500 dark:hover:text-gray-100 underline grow\"\r\n\t\t\t\t\t\t\t\t\t\thref={document?.metadata?.file_id\r\n\t\t\t\t\t\t\t\t\t\t\t? `${WEBUI_API_BASE_URL}/files/${document?.metadata?.file_id}/content${document?.metadata?.page !== undefined ? `#page=${document.metadata.page + 1}` : ''}`\r\n\t\t\t\t\t\t\t\t\t\t\t: document.source?.url?.includes('http')\r\n\t\t\t\t\t\t\t\t\t\t\t\t? document.source.url\r\n\t\t\t\t\t\t\t\t\t\t\t\t: `#`}\r\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{document?.metadata?.name ?? document.source.name}\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t{#if document?.metadata?.page}\r\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-xs text-gray-500 dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t\t\t\t({$i18n.t('page')}\r\n\t\t\t\t\t\t\t\t\t\t\t{document.metadata.page + 1})\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t{#if showRelevance}\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm font-medium dark:text-gray-300 mt-2\">\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Relevance')}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{#if document.distance !== undefined}\r\n\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-fit\"\r\n\t\t\t\t\t\t\t\t\t\tcontent={$i18n.t('Semantic distance to query')}\r\n\t\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\r\n\t\t\t\t\t\t\t\t\t\ttippyOptions={{ duration: [500, 0] }}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit\">\r\n\t\t\t\t\t\t\t\t\t\t\t{#if showPercentage}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{@const percentage = calculatePercentage(document.distance)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass={`px-1 rounded-sm font-medium ${getRelevanceColor(percentage)}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{percentage.toFixed(2)}%\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-gray-500 dark:text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t({document.distance.toFixed(4)})\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"text-gray-500 dark:text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{document.distance.toFixed(4)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t<div class=\"text-sm dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('No distance available')}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<div class=\"text-sm dark:text-gray-400\">\r\n\t\t\t\t\t\t\t\t{$i18n.t('No source available')}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t\t<div class=\" text-sm font-medium dark:text-gray-300 mt-2\">\r\n\t\t\t\t\t\t\t{$i18n.t('Content')}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{#if document.metadata?.html}\r\n\t\t\t\t\t\t\t<iframe\r\n\t\t\t\t\t\t\t\tclass=\"w-full border-0 h-auto rounded-none\"\r\n\t\t\t\t\t\t\t\tsandbox=\"allow-scripts allow-forms allow-same-origin\"\r\n\t\t\t\t\t\t\t\tsrcdoc={document.document}\r\n\t\t\t\t\t\t\t\ttitle={$i18n.t('Content')}\r\n\t\t\t\t\t\t\t></iframe>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<pre class=\"text-sm dark:text-gray-400 whitespace-pre-line\">\r\n                {document.document}\r\n              </pre>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if documentIdx !== mergedDocuments.length - 1}\r\n\t\t\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-3\" />\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</Modal>\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport CitationsModal from './CitationsModal.svelte';\r\n\timport Collapsible from '$lib/components/common/Collapsible.svelte';\r\n\timport ChevronDown from '$lib/components/icons/ChevronDown.svelte';\r\n\timport ChevronUp from '$lib/components/icons/ChevronUp.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let id = '';\r\n\texport let sources = [];\r\n\r\n\tlet citations = [];\r\n\tlet showPercentage = false;\r\n\tlet showRelevance = true;\r\n\r\n\tlet showCitationModal = false;\r\n\tlet selectedCitation: any = null;\r\n\tlet isCollapsibleOpen = false;\r\n\r\n\tfunction calculateShowRelevance(sources: any[]) {\r\n\t\tconst distances = sources.flatMap((citation) => citation.distances ?? []);\r\n\t\tconst inRange = distances.filter((d) => d !== undefined && d >= -1 && d <= 1).length;\r\n\t\tconst outOfRange = distances.filter((d) => d !== undefined && (d < -1 || d > 1)).length;\r\n\r\n\t\tif (distances.length === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t(inRange === distances.length - 1 && outOfRange === 1) ||\r\n\t\t\t(outOfRange === distances.length - 1 && inRange === 1)\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction shouldShowPercentage(sources: any[]) {\r\n\t\tconst distances = sources.flatMap((citation) => citation.distances ?? []);\r\n\t\treturn distances.every((d) => d !== undefined && d >= -1 && d <= 1);\r\n\t}\r\n\r\n\t$: {\r\n\t\tconsole.log('sources', sources);\r\n\t\tcitations = sources.reduce((acc, source) => {\r\n\t\t\tif (Object.keys(source).length === 0) {\r\n\t\t\t\treturn acc;\r\n\t\t\t}\r\n\r\n\t\t\tsource.document.forEach((document, index) => {\r\n\t\t\t\tconst metadata = source.metadata?.[index];\r\n\t\t\t\tconst distance = source.distances?.[index];\r\n\r\n\t\t\t\t// Within the same citation there could be multiple documents\r\n\t\t\t\tconst id = metadata?.source ?? source?.source?.id ?? 'N/A';\r\n\t\t\t\tlet _source = source?.source;\r\n\r\n\t\t\t\tif (metadata?.name) {\r\n\t\t\t\t\t_source = { ..._source, name: metadata.name };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (id.startsWith('http://') || id.startsWith('https://')) {\r\n\t\t\t\t\t_source = { ..._source, name: id, url: id };\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst existingSource = acc.find((item) => item.id === id);\r\n\r\n\t\t\t\tif (existingSource) {\r\n\t\t\t\t\texistingSource.document.push(document);\r\n\t\t\t\t\texistingSource.metadata.push(metadata);\r\n\t\t\t\t\tif (distance !== undefined) existingSource.distances.push(distance);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tacc.push({\r\n\t\t\t\t\t\tid: id,\r\n\t\t\t\t\t\tsource: _source,\r\n\t\t\t\t\t\tdocument: [document],\r\n\t\t\t\t\t\tmetadata: metadata ? [metadata] : [],\r\n\t\t\t\t\t\tdistances: distance !== undefined ? [distance] : undefined\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn acc;\r\n\t\t}, []);\r\n\r\n\t\tshowRelevance = calculateShowRelevance(citations);\r\n\t\tshowPercentage = shouldShowPercentage(citations);\r\n\t}\r\n</script>\r\n\r\n<CitationsModal\r\n\tbind:show={showCitationModal}\r\n\tcitation={selectedCitation}\r\n\t{showPercentage}\r\n\t{showRelevance}\r\n/>\r\n\r\n{#if citations.length > 0}\r\n\t<div class=\" py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap\">\r\n\t\t{#if citations.length <= 3}\r\n\t\t\t<div class=\"flex text-xs font-medium flex-wrap\">\r\n\t\t\t\t{#each citations as citation, idx}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tid={`source-${id}-${idx}`}\r\n\t\t\t\t\t\tclass=\"no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tshowCitationModal = true;\r\n\t\t\t\t\t\t\tselectedCitation = citation;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if citations.every((c) => c.distances !== undefined)}\r\n\t\t\t\t\t\t\t<div class=\"bg-gray-50 dark:bg-gray-800 rounded-full size-4\">\r\n\t\t\t\t\t\t\t\t{idx + 1}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{citation.source.name}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<Collapsible\r\n\t\t\t\tid=\"collapsible-sources\"\r\n\t\t\t\tbind:open={isCollapsibleOpen}\r\n\t\t\t\tclassName=\"w-full max-w-full \"\r\n\t\t\t\tbuttonClassName=\"w-fit max-w-full\"\r\n\t\t\t>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span class=\"whitespace-nowrap hidden sm:inline shrink-0\"\r\n\t\t\t\t\t\t\t>{$i18n.t('References from')}</span\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1\">\r\n\t\t\t\t\t\t\t<div class=\"flex text-xs font-medium items-center\">\r\n\t\t\t\t\t\t\t\t{#each citations.slice(0, 2) as citation, idx}\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowCitationModal = true;\r\n\t\t\t\t\t\t\t\t\t\t\tselectedCitation = citation;\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ton:pointerup={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{#if citations.every((c) => c.distances !== undefined)}\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"bg-gray-50 dark:bg-gray-800 rounded-full size-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{idx + 1}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex-1 mx-1 truncate\">\r\n\t\t\t\t\t\t\t\t\t\t\t{citation.source.name}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"flex items-center gap-1 whitespace-nowrap shrink-0\">\r\n\t\t\t\t\t\t\t<span class=\"hidden sm:inline\">{$i18n.t('and')}</span>\r\n\t\t\t\t\t\t\t{citations.length - 2}\r\n\t\t\t\t\t\t\t<span>{$i18n.t('more')}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"shrink-0\">\r\n\t\t\t\t\t\t{#if isCollapsibleOpen}\r\n\t\t\t\t\t\t\t<ChevronUp strokeWidth=\"3.5\" className=\"size-3.5\" />\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<ChevronDown strokeWidth=\"3.5\" className=\"size-3.5\" />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div slot=\"content\">\r\n\t\t\t\t\t<div class=\"flex text-xs font-medium flex-wrap\">\r\n\t\t\t\t\t\t{#each citations as citation, idx}\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tid={`source-${id}-${idx}`}\r\n\t\t\t\t\t\t\t\tclass=\"no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tshowCitationModal = true;\r\n\t\t\t\t\t\t\t\t\tselectedCitation = citation;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{#if citations.every((c) => c.distances !== undefined)}\r\n\t\t\t\t\t\t\t\t\t<div class=\"bg-gray-50 dark:bg-gray-800 rounded-full size-4\">\r\n\t\t\t\t\t\t\t\t\t\t{idx + 1}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t<div class=\"flex-1 mx-1 truncate\">\r\n\t\t\t\t\t\t\t\t\t{citation.source.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Collapsible>\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport CodeBlock from './CodeBlock.svelte';\r\n\timport Modal from '$lib/components/common/Modal.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport Badge from '$lib/components/common/Badge.svelte';\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let show = false;\r\n\texport let codeExecution = null;\r\n</script>\r\n\r\n<Modal size=\"lg\" bind:show>\r\n\t<div>\r\n\t\t<div class=\"flex justify-between dark:text-gray-300 px-5 pt-4 pb-2\">\r\n\t\t\t<div class=\"text-lg font-medium self-center flex flex-col gap-0.5 capitalize\">\r\n\t\t\t\t{#if codeExecution?.result}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{#if codeExecution.result?.error}\r\n\t\t\t\t\t\t\t<Badge type=\"error\" content=\"error\" />\r\n\t\t\t\t\t\t{:else if codeExecution.result?.output}\r\n\t\t\t\t\t\t\t<Badge type=\"success\" content=\"success\" />\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<Badge type=\"warning\" content=\"incomplete\" />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"flex gap-2 items-center\">\r\n\t\t\t\t\t{#if !codeExecution?.result}\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{#if codeExecution?.name}\r\n\t\t\t\t\t\t\t{$i18n.t('Code execution')}: {codeExecution?.name}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{$i18n.t('Code execution')}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<button\r\n\t\t\t\tclass=\"self-center\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshow = false;\r\n\t\t\t\t\tcodeExecution = null;\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex flex-col md:flex-row w-full px-4 pb-5\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t<CodeBlock\r\n\t\t\t\t\t\tid=\"code-exec-{codeExecution?.id}-code\"\r\n\t\t\t\t\t\tlang={codeExecution?.language ?? ''}\r\n\t\t\t\t\t\tcode={codeExecution?.code ?? ''}\r\n\t\t\t\t\t\tclassName=\"\"\r\n\t\t\t\t\t\teditorClassName={codeExecution?.result &&\r\n\t\t\t\t\t\t(codeExecution?.result?.error || codeExecution?.result?.output)\r\n\t\t\t\t\t\t\t? 'rounded-b-none'\r\n\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\tstickyButtonsClassName=\"top-0\"\r\n\t\t\t\t\t\trun={false}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{#if codeExecution?.result && (codeExecution?.result?.error || codeExecution?.result?.output)}\r\n\t\t\t\t\t<div class=\"dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3\">\r\n\t\t\t\t\t\t{#if codeExecution?.result?.error}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 text-xs mb-1\">{$i18n.t('ERROR')}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm\">{codeExecution?.result?.error}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{#if codeExecution?.result?.output}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<div class=\" text-gray-500 text-xs mb-1\">{$i18n.t('OUTPUT')}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"text-sm\">{codeExecution?.result?.output}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t\t{#if codeExecution?.result?.files && codeExecution?.result?.files.length > 0}\r\n\t\t\t\t\t<div class=\"flex flex-col w-full\">\r\n\t\t\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-2\" />\r\n\t\t\t\t\t\t<div class=\" text-sm font-medium dark:text-gray-300\">\r\n\t\t\t\t\t\t\t{$i18n.t('Files')}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<ul class=\"mt-1 list-disc pl-4 text-xs\">\r\n\t\t\t\t\t\t\t{#each codeExecution?.result?.files as file}\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t<a href={file.url} target=\"_blank\">{file.name}</a>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</Modal>\r\n","<script lang=\"ts\">\r\n\timport CodeExecutionModal from './CodeExecutionModal.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport Check from '$lib/components/icons/Check.svelte';\r\n\timport XMark from '$lib/components/icons/XMark.svelte';\r\n\timport EllipsisHorizontal from '$lib/components/icons/EllipsisHorizontal.svelte';\r\n\r\n\texport let codeExecutions = [];\r\n\r\n\tlet selectedCodeExecution = null;\r\n\tlet showCodeExecutionModal = false;\r\n\r\n\t$: if (codeExecutions) {\r\n\t\tupdateSelectedCodeExecution();\r\n\t}\r\n\r\n\tconst updateSelectedCodeExecution = () => {\r\n\t\tif (selectedCodeExecution) {\r\n\t\t\tselectedCodeExecution = codeExecutions.find(\r\n\t\t\t\t(execution) => execution.id === selectedCodeExecution.id\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<CodeExecutionModal bind:show={showCodeExecutionModal} codeExecution={selectedCodeExecution} />\r\n\r\n{#if codeExecutions.length > 0}\r\n\t<div class=\"mt-1 mb-2 w-full flex gap-1 items-center flex-wrap\">\r\n\t\t{#each codeExecutions as execution (execution.id)}\r\n\t\t\t<div class=\"flex gap-1 text-xs font-semibold\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tselectedCodeExecution = execution;\r\n\t\t\t\t\t\tshowCodeExecutionModal = true;\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if execution?.result}\r\n\t\t\t\t\t\t\t{#if execution.result?.error}\r\n\t\t\t\t\t\t\t\t<XMark />\r\n\t\t\t\t\t\t\t{:else if execution.result?.output}\r\n\t\t\t\t\t\t\t\t<Check strokeWidth=\"3\" className=\"size-3\" />\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<EllipsisHorizontal />\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"flex-1 mx-2 line-clamp-1 code-execution-name {execution?.result ? '' : 'pulse'}\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{execution.name}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t{/each}\r\n\t</div>\r\n{/if}\r\n\r\n<style>\r\n\t@keyframes pulse {\r\n\t\t0%,\r\n\t\t100% {\r\n\t\t\topacity: 1;\r\n\t\t}\r\n\t\t50% {\r\n\t\t\topacity: 0.6;\r\n\t\t}\r\n\t}\r\n\r\n\t.pulse {\r\n\t\topacity: 1;\r\n\t\tanimation: pulse 1.5s ease;\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport DOMPurify from 'dompurify';\r\n\timport { marked } from 'marked';\r\n\r\n\timport { getContext, tick } from 'svelte';\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { chatCompletion } from '$lib/apis/openai';\r\n\r\n\timport ChatBubble from '$lib/components/icons/ChatBubble.svelte';\r\n\timport LightBlub from '$lib/components/icons/LightBlub.svelte';\r\n\timport Markdown from '../Messages/Markdown.svelte';\r\n\timport Skeleton from '../Messages/Skeleton.svelte';\r\n\r\n\texport let id = '';\r\n\texport let model = null;\r\n\texport let messages = [];\r\n\texport let onAdd = () => {};\r\n\r\n\tlet floatingInput = false;\r\n\r\n\tlet selectedText = '';\r\n\tlet floatingInputValue = '';\r\n\r\n\tlet prompt = '';\r\n\tlet responseContent = null;\r\n\tlet responseDone = false;\r\n\r\n\tconst autoScroll = async () => {\r\n\t\t// Scroll to bottom only if the scroll is at the bottom give 50px buffer\r\n\t\tconst responseContainer = document.getElementById('response-container');\r\n\t\tif (\r\n\t\t\tresponseContainer.scrollHeight - responseContainer.clientHeight <=\r\n\t\t\tresponseContainer.scrollTop + 50\r\n\t\t) {\r\n\t\t\tresponseContainer.scrollTop = responseContainer.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tconst askHandler = async () => {\r\n\t\tif (!model) {\r\n\t\t\ttoast.error('Model not selected');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tprompt = `${floatingInputValue}\\n\\`\\`\\`\\n${selectedText}\\n\\`\\`\\``;\r\n\t\tfloatingInputValue = '';\r\n\r\n\t\tresponseContent = '';\r\n\t\tconst [res, controller] = await chatCompletion(localStorage.token, {\r\n\t\t\tmodel: model,\r\n\t\t\tmessages: [\r\n\t\t\t\t...messages,\r\n\t\t\t\t{\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: prompt\r\n\t\t\t\t}\r\n\t\t\t].map((message) => ({\r\n\t\t\t\trole: message.role,\r\n\t\t\t\tcontent: message.content\r\n\t\t\t})),\r\n\t\t\tstream: true // Enable streaming\r\n\t\t});\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tconst reader = res.body.getReader();\r\n\t\t\tconst decoder = new TextDecoder();\r\n\r\n\t\t\tconst processStream = async () => {\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\t// Read data chunks from the response stream\r\n\t\t\t\t\tconst { done, value } = await reader.read();\r\n\t\t\t\t\tif (done) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Decode the received chunk\r\n\t\t\t\t\tconst chunk = decoder.decode(value, { stream: true });\r\n\r\n\t\t\t\t\t// Process lines within the chunk\r\n\t\t\t\t\tconst lines = chunk.split('\\n').filter((line) => line.trim() !== '');\r\n\r\n\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\tif (line.startsWith('data: ')) {\r\n\t\t\t\t\t\t\tif (line.startsWith('data: [DONE]')) {\r\n\t\t\t\t\t\t\t\tresponseDone = true;\r\n\r\n\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Parse the JSON chunk\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(line.slice(6));\r\n\r\n\t\t\t\t\t\t\t\t\t// Append the `content` field from the \"choices\" object\r\n\t\t\t\t\t\t\t\t\tif (data.choices && data.choices[0]?.delta?.content) {\r\n\t\t\t\t\t\t\t\t\t\tresponseContent += data.choices[0].delta.content;\r\n\r\n\t\t\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// Process the stream in the background\r\n\t\t\tawait processStream();\r\n\t\t} else {\r\n\t\t\ttoast.error('An error occurred while fetching the explanation');\r\n\t\t}\r\n\t};\r\n\r\n\tconst explainHandler = async () => {\r\n\t\tif (!model) {\r\n\t\t\ttoast.error('Model not selected');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst explainText = $i18n.t('Explain this section to me in more detail');\r\n\t\tprompt = `${explainText}\\n\\n\\`\\`\\`\\n${selectedText}\\n\\`\\`\\``;\r\n\r\n\t\tresponseContent = '';\r\n\t\tconst [res, controller] = await chatCompletion(localStorage.token, {\r\n\t\t\tmodel: model,\r\n\t\t\tmessages: [\r\n\t\t\t\t...messages,\r\n\t\t\t\t{\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: prompt\r\n\t\t\t\t}\r\n\t\t\t].map((message) => ({\r\n\t\t\t\trole: message.role,\r\n\t\t\t\tcontent: message.content\r\n\t\t\t})),\r\n\t\t\tstream: true // Enable streaming\r\n\t\t});\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tconst reader = res.body.getReader();\r\n\t\t\tconst decoder = new TextDecoder();\r\n\r\n\t\t\tconst processStream = async () => {\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\t// Read data chunks from the response stream\r\n\t\t\t\t\tconst { done, value } = await reader.read();\r\n\t\t\t\t\tif (done) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Decode the received chunk\r\n\t\t\t\t\tconst chunk = decoder.decode(value, { stream: true });\r\n\r\n\t\t\t\t\t// Process lines within the chunk\r\n\t\t\t\t\tconst lines = chunk.split('\\n').filter((line) => line.trim() !== '');\r\n\r\n\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\tif (line.startsWith('data: ')) {\r\n\t\t\t\t\t\t\tif (line.startsWith('data: [DONE]')) {\r\n\t\t\t\t\t\t\t\tresponseDone = true;\r\n\r\n\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Parse the JSON chunk\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst data = JSON.parse(line.slice(6));\r\n\r\n\t\t\t\t\t\t\t\t\t// Append the `content` field from the \"choices\" object\r\n\t\t\t\t\t\t\t\t\tif (data.choices && data.choices[0]?.delta?.content) {\r\n\t\t\t\t\t\t\t\t\t\tresponseContent += data.choices[0].delta.content;\r\n\r\n\t\t\t\t\t\t\t\t\t\tautoScroll();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// Process the stream in the background\r\n\t\t\tawait processStream();\r\n\t\t} else {\r\n\t\t\ttoast.error('An error occurred while fetching the explanation');\r\n\t\t}\r\n\t};\r\n\r\n\tconst addHandler = async () => {\r\n\t\tconst messages = [\r\n\t\t\t{\r\n\t\t\t\trole: 'user',\r\n\t\t\t\tcontent: prompt\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\trole: 'assistant',\r\n\t\t\t\tcontent: responseContent\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tonAdd({\r\n\t\t\tmodelId: model,\r\n\t\t\tparentId: id,\r\n\t\t\tmessages: messages\r\n\t\t});\r\n\t};\r\n\r\n\texport const closeHandler = () => {\r\n\t\tresponseContent = null;\r\n\t\tresponseDone = false;\r\n\t\tfloatingInput = false;\r\n\t\tfloatingInputValue = '';\r\n\t};\r\n</script>\r\n\r\n<div\r\n\tid={`floating-buttons-${id}`}\r\n\tclass=\"absolute rounded-lg mt-1 text-xs z-9999\"\r\n\tstyle=\"display: none\"\r\n>\r\n\t{#if responseContent === null}\r\n\t\t{#if !floatingInput}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl\"\r\n\t\t\t>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit\"\r\n\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\tselectedText = window.getSelection().toString();\r\n\t\t\t\t\t\tfloatingInput = true;\r\n\r\n\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tconst input = document.getElementById('floating-message-input');\r\n\t\t\t\t\t\t\tif (input) {\r\n\t\t\t\t\t\t\t\tinput.focus();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChatBubble className=\"size-3 shrink-0\" />\r\n\r\n\t\t\t\t\t<div class=\"shrink-0\">{$i18n.t('Ask')}</div>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tselectedText = window.getSelection().toString();\r\n\t\t\t\t\t\texplainHandler();\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<LightBlub className=\"size-3 shrink-0\" />\r\n\r\n\t\t\t\t\t<div class=\"shrink-0\">{$i18n.t('Explain')}</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-850 w-72 rounded-full shadow-xl\"\r\n\t\t\t>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tid=\"floating-message-input\"\r\n\t\t\t\t\tclass=\"ml-5 bg-transparent outline-hidden w-full flex-1 text-sm\"\r\n\t\t\t\t\tplaceholder={$i18n.t('Ask a question')}\r\n\t\t\t\t\tbind:value={floatingInputValue}\r\n\t\t\t\t\ton:keydown={(e) => {\r\n\t\t\t\t\t\tif (e.key === 'Enter') {\r\n\t\t\t\t\t\t\taskHandler();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<div class=\"ml-1 mr-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"{floatingInputValue !== ''\r\n\t\t\t\t\t\t\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\r\n\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 m-0.5 self-center\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\taskHandler();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\r\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t{:else}\r\n\t\t<div class=\"bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"font-medium\">\r\n\t\t\t\t\t<Markdown id={`${id}-float-prompt`} content={prompt} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\" max-h-80 overflow-y-auto w-full markdown-prose-xs\" id=\"response-container\">\r\n\t\t\t\t\t{#if responseContent.trim() === ''}\r\n\t\t\t\t\t\t<Skeleton size=\"sm\" />\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<Markdown id={`${id}-float-response`} content={responseContent} />\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if responseDone}\r\n\t\t\t\t\t\t<div class=\"flex justify-end pt-3 text-sm font-medium\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full\"\r\n\t\t\t\t\t\t\t\ton:click={addHandler}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{$i18n.t('Add')}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n","<script>\r\n\timport { onDestroy, onMount, tick, getContext, createEventDispatcher } from 'svelte';\r\n\tconst i18n = getContext('i18n');\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport Markdown from './Markdown.svelte';\r\n\timport { chatId, mobile, showArtifacts, showControls, showOverview } from '$lib/stores';\r\n\timport FloatingButtons from '../ContentRenderer/FloatingButtons.svelte';\r\n\timport { createMessagesList } from '$lib/utils';\r\n\r\n\texport let id;\r\n\texport let content;\r\n\texport let history;\r\n\texport let model = null;\r\n\texport let sources = null;\r\n\r\n\texport let save = false;\r\n\texport let floatingButtons = true;\r\n\r\n\texport let onSourceClick = () => {};\r\n\texport let onTaskClick = () => {};\r\n\r\n\texport let onAddMessages = () => {};\r\n\r\n\tlet contentContainerElement;\r\n\r\n\tlet floatingButtonsElement;\r\n\r\n\tconst updateButtonPosition = (event) => {\r\n\t\tconst buttonsContainerElement = document.getElementById(`floating-buttons-${id}`);\r\n\t\tif (\r\n\t\t\t!contentContainerElement?.contains(event.target) &&\r\n\t\t\t!buttonsContainerElement?.contains(event.target)\r\n\t\t) {\r\n\t\t\tcloseFloatingButtons();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetTimeout(async () => {\r\n\t\t\tawait tick();\r\n\r\n\t\t\tif (!contentContainerElement?.contains(event.target)) return;\r\n\r\n\t\t\tlet selection = window.getSelection();\r\n\r\n\t\t\tif (selection.toString().trim().length > 0) {\r\n\t\t\t\tconst range = selection.getRangeAt(0);\r\n\t\t\t\tconst rect = range.getBoundingClientRect();\r\n\r\n\t\t\t\tconst parentRect = contentContainerElement.getBoundingClientRect();\r\n\r\n\t\t\t\t// Adjust based on parent rect\r\n\t\t\t\tconst top = rect.bottom - parentRect.top;\r\n\t\t\t\tconst left = rect.left - parentRect.left;\r\n\r\n\t\t\t\tif (buttonsContainerElement) {\r\n\t\t\t\t\tbuttonsContainerElement.style.display = 'block';\r\n\r\n\t\t\t\t\t// Calculate space available on the right\r\n\t\t\t\t\tconst spaceOnRight = parentRect.width - left;\r\n\t\t\t\t\tlet halfScreenWidth = $mobile ? window.innerWidth / 2 : window.innerWidth / 3;\r\n\r\n\t\t\t\t\tif (spaceOnRight < halfScreenWidth) {\r\n\t\t\t\t\t\tconst right = parentRect.right - rect.right;\r\n\t\t\t\t\t\tbuttonsContainerElement.style.right = `${right}px`;\r\n\t\t\t\t\t\tbuttonsContainerElement.style.left = 'auto'; // Reset left\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Enough space, position using 'left'\r\n\t\t\t\t\t\tbuttonsContainerElement.style.left = `${left}px`;\r\n\t\t\t\t\t\tbuttonsContainerElement.style.right = 'auto'; // Reset right\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbuttonsContainerElement.style.top = `${top + 5}px`; // +5 to add some spacing\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tcloseFloatingButtons();\r\n\t\t\t}\r\n\t\t}, 0);\r\n\t};\r\n\r\n\tconst closeFloatingButtons = () => {\r\n\t\tconst buttonsContainerElement = document.getElementById(`floating-buttons-${id}`);\r\n\t\tif (buttonsContainerElement) {\r\n\t\t\tbuttonsContainerElement.style.display = 'none';\r\n\t\t}\r\n\r\n\t\tif (floatingButtonsElement) {\r\n\t\t\tfloatingButtonsElement.closeHandler();\r\n\t\t}\r\n\t};\r\n\r\n\tconst keydownHandler = (e) => {\r\n\t\tif (e.key === 'Escape') {\r\n\t\t\tcloseFloatingButtons();\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tif (floatingButtons) {\r\n\t\t\tcontentContainerElement?.addEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.addEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.addEventListener('keydown', keydownHandler);\r\n\t\t}\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tif (floatingButtons) {\r\n\t\t\tcontentContainerElement?.removeEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.removeEventListener('mouseup', updateButtonPosition);\r\n\t\t\tdocument.removeEventListener('keydown', keydownHandler);\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<div bind:this={contentContainerElement}>\r\n\t<Markdown\r\n\t\t{id}\r\n\t\t{content}\r\n\t\t{model}\r\n\t\t{save}\r\n\t\tsourceIds={(sources ?? []).reduce((acc, s) => {\r\n\t\t\tlet ids = [];\r\n\t\t\ts.document.forEach((document, index) => {\r\n\t\t\t\tif (model?.info?.meta?.capabilities?.citations == false) {\r\n\t\t\t\t\tids.push('N/A');\r\n\t\t\t\t\treturn ids;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst metadata = s.metadata?.[index];\r\n\t\t\t\tconst id = metadata?.source ?? 'N/A';\r\n\r\n\t\t\t\tif (metadata?.name) {\r\n\t\t\t\t\tids.push(metadata.name);\r\n\t\t\t\t\treturn ids;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (id.startsWith('http://') || id.startsWith('https://')) {\r\n\t\t\t\t\tids.push(id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tids.push(s?.source?.name ?? id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn ids;\r\n\t\t\t});\r\n\r\n\t\t\tacc = [...acc, ...ids];\r\n\r\n\t\t\t// remove duplicates\r\n\t\t\treturn acc.filter((item, index) => acc.indexOf(item) === index);\r\n\t\t}, [])}\r\n\t\t{onSourceClick}\r\n\t\t{onTaskClick}\r\n\t\ton:update={(e) => {\r\n\t\t\tdispatch('update', e.detail);\r\n\t\t}}\r\n\t\ton:code={(e) => {\r\n\t\t\tconst { lang, code } = e.detail;\r\n\r\n\t\t\tif (\r\n\t\t\t\t(['html', 'svg'].includes(lang) || (lang === 'xml' && code.includes('svg'))) &&\r\n\t\t\t\t!$mobile &&\r\n\t\t\t\t$chatId\r\n\t\t\t) {\r\n\t\t\t\tshowArtifacts.set(true);\r\n\t\t\t\tshowControls.set(true);\r\n\t\t\t}\r\n\t\t}}\r\n\t/>\r\n</div>\r\n\r\n{#if floatingButtons && model}\r\n\t<FloatingButtons\r\n\t\tbind:this={floatingButtonsElement}\r\n\t\t{id}\r\n\t\tmodel={model?.id}\r\n\t\tmessages={createMessagesList(history, id)}\r\n\t\tonAdd={({ modelId, parentId, messages }) => {\r\n\t\t\tconsole.log(modelId, parentId, messages);\r\n\t\t\tonAddMessages({ modelId, parentId, messages });\r\n\t\t\tcloseFloatingButtons();\r\n\t\t}}\r\n\t/>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport dayjs from 'dayjs';\r\n\r\n\timport { createEventDispatcher } from 'svelte';\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\timport type { Writable } from 'svelte/store';\r\n\timport type { i18n as i18nType } from 'i18next';\r\n\r\n\tconst i18n = getContext<Writable<i18nType>>('i18n');\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport { createNewFeedback, getFeedbackById, updateFeedbackById } from '$lib/apis/evaluations';\r\n\timport { getChatById } from '$lib/apis/chats';\r\n\timport { generateTags } from '$lib/apis';\r\n\r\n\timport { config, models, settings, temporaryChatEnabled, TTSWorker, user } from '$lib/stores';\r\n\timport { synthesizeOpenAISpeech } from '$lib/apis/audio';\r\n\timport { imageGenerations } from '$lib/apis/images';\r\n\timport {\r\n\t\tcopyToClipboard as _copyToClipboard,\r\n\t\tapproximateToHumanReadable,\r\n\t\tgetMessageContentParts,\r\n\t\tsanitizeResponseContent,\r\n\t\tcreateMessagesList,\r\n\t\tformatDate\r\n\t} from '$lib/utils';\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\r\n\timport Name from './Name.svelte';\r\n\timport ProfileImage from './ProfileImage.svelte';\r\n\timport Skeleton from './Skeleton.svelte';\r\n\timport Image from '$lib/components/common/Image.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport RateComment from './RateComment.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport WebSearchResults from './ResponseMessage/WebSearchResults.svelte';\r\n\timport Sparkles from '$lib/components/icons/Sparkles.svelte';\r\n\r\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\r\n\r\n\timport Error from './Error.svelte';\r\n\timport Citations from './Citations.svelte';\r\n\timport CodeExecutions from './CodeExecutions.svelte';\r\n\timport ContentRenderer from './ContentRenderer.svelte';\r\n\timport { KokoroWorker } from '$lib/workers/KokoroWorker';\r\n\r\n\tinterface MessageType {\r\n\t\tid: string;\r\n\t\tmodel: string;\r\n\t\tcontent: string;\r\n\t\tfiles?: { type: string; url: string }[];\r\n\t\ttimestamp: number;\r\n\t\trole: string;\r\n\t\tstatusHistory?: {\r\n\t\t\tdone: boolean;\r\n\t\t\taction: string;\r\n\t\t\tdescription: string;\r\n\t\t\turls?: string[];\r\n\t\t\tquery?: string;\r\n\t\t}[];\r\n\t\tstatus?: {\r\n\t\t\tdone: boolean;\r\n\t\t\taction: string;\r\n\t\t\tdescription: string;\r\n\t\t\turls?: string[];\r\n\t\t\tquery?: string;\r\n\t\t};\r\n\t\tdone: boolean;\r\n\t\terror?: boolean | { content: string };\r\n\t\tsources?: string[];\r\n\t\tcode_executions?: {\r\n\t\t\tuuid: string;\r\n\t\t\tname: string;\r\n\t\t\tcode: string;\r\n\t\t\tlanguage?: string;\r\n\t\t\tresult?: {\r\n\t\t\t\terror?: string;\r\n\t\t\t\toutput?: string;\r\n\t\t\t\tfiles?: { name: string; url: string }[];\r\n\t\t\t};\r\n\t\t}[];\r\n\t\tinfo?: {\r\n\t\t\topenai?: boolean;\r\n\t\t\tprompt_tokens?: number;\r\n\t\t\tcompletion_tokens?: number;\r\n\t\t\ttotal_tokens?: number;\r\n\t\t\teval_count?: number;\r\n\t\t\teval_duration?: number;\r\n\t\t\tprompt_eval_count?: number;\r\n\t\t\tprompt_eval_duration?: number;\r\n\t\t\ttotal_duration?: number;\r\n\t\t\tload_duration?: number;\r\n\t\t\tusage?: unknown;\r\n\t\t};\r\n\t\tannotation?: { type: string; rating: number };\r\n\t}\r\n\r\n\texport let chatId = '';\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\tlet message: MessageType = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t$: if (history.messages) {\r\n\t\tif (JSON.stringify(message) !== JSON.stringify(history.messages[messageId])) {\r\n\t\t\tmessage = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t\t}\r\n\t}\r\n\r\n\texport let siblings;\r\n\r\n\texport let showPreviousMessage: Function;\r\n\texport let showNextMessage: Function;\r\n\r\n\texport let updateChat: Function;\r\n\texport let editMessage: Function;\r\n\texport let saveMessage: Function;\r\n\texport let rateMessage: Function;\r\n\texport let actionMessage: Function;\r\n\texport let deleteMessage: Function;\r\n\r\n\texport let submitMessage: Function;\r\n\texport let continueResponse: Function;\r\n\texport let regenerateResponse: Function;\r\n\r\n\texport let addMessages: Function;\r\n\r\n\texport let isLastMessage = true;\r\n\texport let readOnly = false;\r\n\r\n\tlet buttonsContainerElement: HTMLDivElement;\r\n\tlet showDeleteConfirm = false;\r\n\r\n\tlet model = null;\r\n\t$: model = $models.find((m) => m.id === message.model);\r\n\r\n\tlet edit = false;\r\n\tlet editedContent = '';\r\n\tlet editTextAreaElement: HTMLTextAreaElement;\r\n\r\n\tlet audioParts: Record<number, HTMLAudioElement | null> = {};\r\n\tlet speaking = false;\r\n\tlet speakingIdx: number | undefined;\r\n\r\n\tlet loadingSpeech = false;\r\n\tlet generatingImage = false;\r\n\r\n\tlet showRateComment = false;\r\n\r\n\tconst copyToClipboard = async (text) => {\r\n\t\tconst res = await _copyToClipboard(text);\r\n\t\tif (res) {\r\n\t\t\ttoast.success($i18n.t('Copying to clipboard was successful!'));\r\n\t\t}\r\n\t};\r\n\r\n\tconst playAudio = (idx: number) => {\r\n\t\treturn new Promise<void>((res) => {\r\n\t\t\tspeakingIdx = idx;\r\n\t\t\tconst audio = audioParts[idx];\r\n\r\n\t\t\tif (!audio) {\r\n\t\t\t\treturn res();\r\n\t\t\t}\r\n\r\n\t\t\taudio.play();\r\n\t\t\taudio.onended = async () => {\r\n\t\t\t\tawait new Promise((r) => setTimeout(r, 300));\r\n\r\n\t\t\t\tif (Object.keys(audioParts).length - 1 === idx) {\r\n\t\t\t\t\tspeaking = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tres();\r\n\t\t\t};\r\n\t\t});\r\n\t};\r\n\r\n\tconst toggleSpeakMessage = async () => {\r\n\t\tif (speaking) {\r\n\t\t\ttry {\r\n\t\t\t\tspeechSynthesis.cancel();\r\n\r\n\t\t\t\tif (speakingIdx !== undefined && audioParts[speakingIdx]) {\r\n\t\t\t\t\taudioParts[speakingIdx]!.pause();\r\n\t\t\t\t\taudioParts[speakingIdx]!.currentTime = 0;\r\n\t\t\t\t}\r\n\t\t\t} catch {}\r\n\r\n\t\t\tspeaking = false;\r\n\t\t\tspeakingIdx = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!(message?.content ?? '').trim().length) {\r\n\t\t\ttoast.info($i18n.t('No content to speak'));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tspeaking = true;\r\n\r\n\t\tif ($config.audio.tts.engine === '') {\r\n\t\t\tlet voices = [];\r\n\t\t\tconst getVoicesLoop = setInterval(() => {\r\n\t\t\t\tvoices = speechSynthesis.getVoices();\r\n\t\t\t\tif (voices.length > 0) {\r\n\t\t\t\t\tclearInterval(getVoicesLoop);\r\n\r\n\t\t\t\t\tconst voice =\r\n\t\t\t\t\t\tvoices\r\n\t\t\t\t\t\t\t?.filter(\r\n\t\t\t\t\t\t\t\t(v) => v.voiceURI === ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t?.at(0) ?? undefined;\r\n\r\n\t\t\t\t\tconsole.log(voice);\r\n\r\n\t\t\t\t\tconst speak = new SpeechSynthesisUtterance(message.content);\r\n\t\t\t\t\tspeak.rate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\tconsole.log(speak);\r\n\r\n\t\t\t\t\tspeak.onend = () => {\r\n\t\t\t\t\t\tspeaking = false;\r\n\t\t\t\t\t\tif ($settings.conversationMode) {\r\n\t\t\t\t\t\t\tdocument.getElementById('voice-input-button')?.click();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (voice) {\r\n\t\t\t\t\t\tspeak.voice = voice;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tspeechSynthesis.speak(speak);\r\n\t\t\t\t}\r\n\t\t\t}, 100);\r\n\t\t} else {\r\n\t\t\tloadingSpeech = true;\r\n\r\n\t\t\tconst messageContentParts: string[] = getMessageContentParts(\r\n\t\t\t\tmessage.content,\r\n\t\t\t\t$config?.audio?.tts?.split_on ?? 'punctuation'\r\n\t\t\t);\r\n\r\n\t\t\tif (!messageContentParts.length) {\r\n\t\t\t\tconsole.log('No content to speak');\r\n\t\t\t\ttoast.info($i18n.t('No content to speak'));\r\n\r\n\t\t\t\tspeaking = false;\r\n\t\t\t\tloadingSpeech = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.debug('Prepared message content for TTS', messageContentParts);\r\n\r\n\t\t\taudioParts = messageContentParts.reduce(\r\n\t\t\t\t(acc, _sentence, idx) => {\r\n\t\t\t\t\tacc[idx] = null;\r\n\t\t\t\t\treturn acc;\r\n\t\t\t\t},\r\n\t\t\t\t{} as typeof audioParts\r\n\t\t\t);\r\n\r\n\t\t\tlet lastPlayedAudioPromise = Promise.resolve(); // Initialize a promise that resolves immediately\r\n\r\n\t\t\tif ($settings.audio?.tts?.engine === 'browser-kokoro') {\r\n\t\t\t\tif (!$TTSWorker) {\r\n\t\t\t\t\tawait TTSWorker.set(\r\n\t\t\t\t\t\tnew KokoroWorker({\r\n\t\t\t\t\t\t\tdtype: $settings.audio?.tts?.engineConfig?.dtype ?? 'fp32'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tawait $TTSWorker.init();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (const [idx, sentence] of messageContentParts.entries()) {\r\n\t\t\t\t\tconst blob = await $TTSWorker\r\n\t\t\t\t\t\t.generate({\r\n\t\t\t\t\t\t\ttext: sentence,\r\n\t\t\t\t\t\t\tvoice: $settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\t\ttoast.error(`${error}`);\r\n\r\n\t\t\t\t\t\t\tspeaking = false;\r\n\t\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (blob) {\r\n\t\t\t\t\t\tconst audio = new Audio(blob);\r\n\t\t\t\t\t\taudio.playbackRate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\t\taudioParts[idx] = audio;\r\n\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t\tlastPlayedAudioPromise = lastPlayedAudioPromise.then(() => playAudio(idx));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (const [idx, sentence] of messageContentParts.entries()) {\r\n\t\t\t\t\tconst res = await synthesizeOpenAISpeech(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\t$settings?.audio?.tts?.defaultVoice === $config.audio.tts.voice\r\n\t\t\t\t\t\t\t? ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\r\n\t\t\t\t\t\t\t: $config?.audio?.tts?.voice,\r\n\t\t\t\t\t\tsentence\r\n\t\t\t\t\t).catch((error) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\ttoast.error(`${error}`);\r\n\r\n\t\t\t\t\t\tspeaking = false;\r\n\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\tconst blob = await res.blob();\r\n\t\t\t\t\t\tconst blobUrl = URL.createObjectURL(blob);\r\n\t\t\t\t\t\tconst audio = new Audio(blobUrl);\r\n\t\t\t\t\t\taudio.playbackRate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\t\taudioParts[idx] = audio;\r\n\t\t\t\t\t\tloadingSpeech = false;\r\n\t\t\t\t\t\tlastPlayedAudioPromise = lastPlayedAudioPromise.then(() => playAudio(idx));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst editMessageHandler = async () => {\r\n\t\tedit = true;\r\n\t\teditedContent = message.content;\r\n\r\n\t\tawait tick();\r\n\r\n\t\teditTextAreaElement.style.height = '';\r\n\t\teditTextAreaElement.style.height = `${editTextAreaElement.scrollHeight}px`;\r\n\t};\r\n\r\n\tconst editMessageConfirmHandler = async () => {\r\n\t\teditMessage(message.id, editedContent ? editedContent : '', false);\r\n\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst saveAsCopyHandler = async () => {\r\n\t\teditMessage(message.id, editedContent ? editedContent : '');\r\n\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst cancelEditMessage = async () => {\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst generateImage = async (message: MessageType) => {\r\n\t\tgeneratingImage = true;\r\n\t\tconst res = await imageGenerations(localStorage.token, message.content).catch((error) => {\r\n\t\t\ttoast.error(`${error}`);\r\n\t\t});\r\n\t\tconsole.log(res);\r\n\r\n\t\tif (res) {\r\n\t\t\tconst files = res.map((image) => ({\r\n\t\t\t\ttype: 'image',\r\n\t\t\t\turl: `${image.url}`\r\n\t\t\t}));\r\n\r\n\t\t\tsaveMessage(message.id, {\r\n\t\t\t\t...message,\r\n\t\t\t\tfiles: files\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tgeneratingImage = false;\r\n\t};\r\n\r\n\tlet feedbackLoading = false;\r\n\r\n\tconst feedbackHandler = async (rating: number | null = null, details: object | null = null) => {\r\n\t\tfeedbackLoading = true;\r\n\t\tconsole.log('Feedback', rating, details);\r\n\r\n\t\tconst updatedMessage = {\r\n\t\t\t...message,\r\n\t\t\tannotation: {\r\n\t\t\t\t...(message?.annotation ?? {}),\r\n\t\t\t\t...(rating !== null ? { rating: rating } : {}),\r\n\t\t\t\t...(details ? details : {})\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst chat = await getChatById(localStorage.token, chatId).catch((error) => {\r\n\t\t\ttoast.error(`${error}`);\r\n\t\t});\r\n\t\tif (!chat) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst messages = createMessagesList(history, message.id);\r\n\r\n\t\tlet feedbackItem = {\r\n\t\t\ttype: 'rating',\r\n\t\t\tdata: {\r\n\t\t\t\t...(updatedMessage?.annotation ? updatedMessage.annotation : {}),\r\n\t\t\t\tmodel_id: message?.selectedModelId ?? message.model,\r\n\t\t\t\t...(history.messages[message.parentId].childrenIds.length > 1\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t\tsibling_model_ids: history.messages[message.parentId].childrenIds\r\n\t\t\t\t\t\t\t\t.filter((id) => id !== message.id)\r\n\t\t\t\t\t\t\t\t.map((id) => history.messages[id]?.selectedModelId ?? history.messages[id].model)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t: {})\r\n\t\t\t},\r\n\t\t\tmeta: {\r\n\t\t\t\tarena: message ? message.arena : false,\r\n\t\t\t\tmodel_id: message.model,\r\n\t\t\t\tmessage_id: message.id,\r\n\t\t\t\tmessage_index: messages.length,\r\n\t\t\t\tchat_id: chatId\r\n\t\t\t},\r\n\t\t\tsnapshot: {\r\n\t\t\t\tchat: chat\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst baseModels = [\r\n\t\t\tfeedbackItem.data.model_id,\r\n\t\t\t...(feedbackItem.data.sibling_model_ids ?? [])\r\n\t\t].reduce((acc, modelId) => {\r\n\t\t\tconst model = $models.find((m) => m.id === modelId);\r\n\t\t\tif (model) {\r\n\t\t\t\tacc[model.id] = model?.info?.base_model_id ?? null;\r\n\t\t\t} else {\r\n\t\t\t\t// Log or handle cases where corresponding model is not found\r\n\t\t\t\tconsole.warn(`Model with ID ${modelId} not found`);\r\n\t\t\t}\r\n\t\t\treturn acc;\r\n\t\t}, {});\r\n\t\tfeedbackItem.meta.base_models = baseModels;\r\n\r\n\t\tlet feedback = null;\r\n\t\tif (message?.feedbackId) {\r\n\t\t\tfeedback = await updateFeedbackById(\r\n\t\t\t\tlocalStorage.token,\r\n\t\t\t\tmessage.feedbackId,\r\n\t\t\t\tfeedbackItem\r\n\t\t\t).catch((error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tfeedback = await createNewFeedback(localStorage.token, feedbackItem).catch((error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t});\r\n\r\n\t\t\tif (feedback) {\r\n\t\t\t\tupdatedMessage.feedbackId = feedback.id;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log(updatedMessage);\r\n\t\tsaveMessage(message.id, updatedMessage);\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif (!details) {\r\n\t\t\tshowRateComment = true;\r\n\r\n\t\t\tif (!updatedMessage.annotation?.tags) {\r\n\t\t\t\t// attempt to generate tags\r\n\t\t\t\tconst tags = await generateTags(localStorage.token, message.model, messages, chatId).catch(\r\n\t\t\t\t\t(error) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t\tconsole.log(tags);\r\n\r\n\t\t\t\tif (tags) {\r\n\t\t\t\t\tupdatedMessage.annotation.tags = tags;\r\n\t\t\t\t\tfeedbackItem.data.tags = tags;\r\n\r\n\t\t\t\t\tsaveMessage(message.id, updatedMessage);\r\n\t\t\t\t\tawait updateFeedbackById(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\tupdatedMessage.feedbackId,\r\n\t\t\t\t\t\tfeedbackItem\r\n\t\t\t\t\t).catch((error) => {\r\n\t\t\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfeedbackLoading = false;\r\n\t};\r\n\r\n\tconst deleteMessageHandler = async () => {\r\n\t\tdeleteMessage(message.id);\r\n\t};\r\n\r\n\t$: if (!edit) {\r\n\t\t(async () => {\r\n\t\t\tawait tick();\r\n\t\t})();\r\n\t}\r\n\r\n\tonMount(async () => {\r\n\t\t// console.log('ResponseMessage mounted');\r\n\r\n\t\tawait tick();\r\n\t\tif (buttonsContainerElement) {\r\n\t\t\tconsole.log(buttonsContainerElement);\r\n\t\t\tbuttonsContainerElement.addEventListener('wheel', function (event) {\r\n\t\t\t\t// console.log(event.deltaY);\r\n\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tif (event.deltaY !== 0) {\r\n\t\t\t\t\t// Adjust horizontal scroll position based on vertical scroll\r\n\t\t\t\t\tbuttonsContainerElement.scrollLeft += event.deltaY;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<DeleteConfirmDialog\r\n\tbind:show={showDeleteConfirm}\r\n\ttitle={$i18n.t('Delete message?')}\r\n\ton:confirm={() => {\r\n\t\tdeleteMessageHandler();\r\n\t}}\r\n/>\r\n\r\n{#key message.id}\r\n\t<div\r\n\t\tclass=\" flex w-full message-{message.id}\"\r\n\t\tid=\"message-{message.id}\"\r\n\t\tdir={$settings.chatDirection}\r\n\t>\r\n\t\t<div class={`shrink-0 ${($settings?.chatDirection ?? 'LTR') === 'LTR' ? 'mr-3' : 'ml-3'}`}>\r\n\t\t\t<ProfileImage\r\n\t\t\t\tsrc={model?.info?.meta?.profile_image_url ??\r\n\t\t\t\t\t($i18n.language === 'dg-DG' ? `/doge.png` : `${WEBUI_BASE_URL}/static/favicon.png`)}\r\n\t\t\t\tclassName={'size-8'}\r\n\t\t\t/>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex-auto w-0 pl-1\">\r\n\t\t\t<Name>\r\n\t\t\t\t<Tooltip content={model?.name ?? message.model} placement=\"top-start\">\r\n\t\t\t\t\t<span class=\"line-clamp-1\">\r\n\t\t\t\t\t\t{model?.name ?? message.model}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t{#if message.timestamp}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip content={dayjs(message.timestamp * 1000).format('LLLL')}>\r\n\t\t\t\t\t\t\t<span class=\"line-clamp-1\">{formatDate(message.timestamp * 1000)}</span>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</Name>\r\n\r\n\t\t\t<div>\r\n\t\t\t\t{#if message?.files && message.files?.filter((f) => f.type === 'image').length > 0}\r\n\t\t\t\t\t<div class=\"my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap\">\r\n\t\t\t\t\t\t{#each message.files as file}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t\t<Image src={file.url} alt={message.content} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"chat-{message.role} w-full min-w-full markdown-prose\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{#if (message?.statusHistory ?? [...(message?.status ? [message?.status] : [])]).length > 0}\r\n\t\t\t\t\t\t\t{@const status = (\r\n\t\t\t\t\t\t\t\tmessage?.statusHistory ?? [...(message?.status ? [message?.status] : [])]\r\n\t\t\t\t\t\t\t).at(-1)}\r\n\t\t\t\t\t\t\t{#if !status?.hidden}\r\n\t\t\t\t\t\t\t\t<div class=\"status-description flex items-center gap-2 py-0.5\">\r\n\t\t\t\t\t\t\t\t\t{#if status?.done === false}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t{#if status?.action === 'web_search' && status?.urls}\r\n\t\t\t\t\t\t\t\t\t\t<WebSearchResults {status}>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{status?.done === false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'shimmer'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} text-base line-clamp-1 text-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t(\"Generating search query\") -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t(\"No search query generated\") -->\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t('Searched {{count}} sites') -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#if status?.description.includes('{{count}}')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(status?.description, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcount: status?.urls.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'No search query generated'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('No search query generated')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'Generating search query'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Generating search query')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{status?.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</WebSearchResults>\r\n\t\t\t\t\t\t\t\t\t{:else if status?.action === 'knowledge_search'}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{status?.done === false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'shimmer'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(`Searching Knowledge for \"{{searchQuery}}\"`, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery: status.query\r\n\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{status?.done === false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'shimmer'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- $i18n.t(`Searching \"{{searchQuery}}\"`) -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t{#if status?.description.includes('{{searchQuery}}')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t(status?.description, {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsearchQuery: status?.query\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'No search query generated'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('No search query generated')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{:else if status?.description === 'Generating search query'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Generating search query')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{status?.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t{#if edit === true}\r\n\t\t\t\t\t\t\t<div class=\"w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2\">\r\n\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\tid=\"message-edit-{message.id}\"\r\n\t\t\t\t\t\t\t\t\tbind:this={editTextAreaElement}\r\n\t\t\t\t\t\t\t\t\tclass=\" bg-transparent outline-hidden w-full resize-none\"\r\n\t\t\t\t\t\t\t\t\tbind:value={editedContent}\r\n\t\t\t\t\t\t\t\t\ton:input={(e) => {\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = `${e.target.scrollHeight}px`;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ton:keydown={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('close-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst isCmdOrCtrlPressed = e.metaKey || e.ctrlKey;\r\n\t\t\t\t\t\t\t\t\t\tconst isEnterPressed = e.key === 'Enter';\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (isCmdOrCtrlPressed && isEnterPressed) {\r\n\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('confirm-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" mt-2 mb-1 flex justify-between text-sm font-medium\">\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"save-new-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsaveAsCopyHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Save As Copy')}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div class=\"flex space-x-1.5\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"close-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tcancelEditMessage();\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Cancel')}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"confirm-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\teditMessageConfirmHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Save')}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<div class=\"w-full flex flex-col relative\" id=\"response-content-container\">\r\n\t\t\t\t\t\t\t\t{#if message.content === '' && !message.error}\r\n\t\t\t\t\t\t\t\t\t<Skeleton />\r\n\t\t\t\t\t\t\t\t{:else if message.content && message.error !== true}\r\n\t\t\t\t\t\t\t\t\t<!-- always show message contents even if there's an error -->\r\n\t\t\t\t\t\t\t\t\t<!-- unless message.error === true which is legacy error handling, where the error message is stored in message.content -->\r\n\t\t\t\t\t\t\t\t\t<ContentRenderer\r\n\t\t\t\t\t\t\t\t\t\tid={message.id}\r\n\t\t\t\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\t\t\t\tcontent={message.content}\r\n\t\t\t\t\t\t\t\t\t\tsources={message.sources}\r\n\t\t\t\t\t\t\t\t\t\tfloatingButtons={message?.done}\r\n\t\t\t\t\t\t\t\t\t\tsave={!readOnly}\r\n\t\t\t\t\t\t\t\t\t\t{model}\r\n\t\t\t\t\t\t\t\t\t\tonTaskClick={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonSourceClick={async (id, idx) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(id, idx);\r\n\t\t\t\t\t\t\t\t\t\t\tlet sourceButton = document.getElementById(`source-${message.id}-${idx}`);\r\n\t\t\t\t\t\t\t\t\t\t\tconst sourcesCollapsible = document.getElementById(`collapsible-sources`);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (sourceButton) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourceButton.click();\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (sourcesCollapsible) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Open sources collapsible so we can click the source button\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourcesCollapsible\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.querySelector('div:first-child')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.dispatchEvent(new PointerEvent('pointerup', {}));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Wait for next frame to ensure DOM updates\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait new Promise((resolve) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trequestAnimationFrame(resolve);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Try clicking the source button again\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourceButton = document.getElementById(`source-${message.id}-${idx}`);\r\n\t\t\t\t\t\t\t\t\t\t\t\tsourceButton && sourceButton.click();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonAddMessages={({ modelId, parentId, messages }) => {\r\n\t\t\t\t\t\t\t\t\t\t\taddMessages({ modelId, parentId, messages });\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ton:update={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst { raw, oldContent, newContent } = e.detail;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\thistory.messages[message.id].content = history.messages[\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage.id\r\n\t\t\t\t\t\t\t\t\t\t\t].content.replace(raw, raw.replace(oldContent, newContent));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tupdateChat();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\ton:select={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst { type, content } = e.detail;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (type === 'explain') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmitMessage(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`Explain this section to me in more detail\\n\\n\\`\\`\\`\\n${content}\\n\\`\\`\\``\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (type === 'ask') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst input = e.detail?.input ?? '';\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmitMessage(message.id, `\\`\\`\\`\\n${content}\\n\\`\\`\\`\\n${input}`);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if message?.error}\r\n\t\t\t\t\t\t\t\t\t<Error content={message?.error?.content ?? message.content} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if (message?.sources || message?.citations) && (model?.info?.meta?.capabilities?.citations ?? true)}\r\n\t\t\t\t\t\t\t\t\t<Citations id={message?.id} sources={message?.sources ?? message?.citations} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if message.code_executions}\r\n\t\t\t\t\t\t\t\t\t<CodeExecutions codeExecutions={message.code_executions} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{#if !edit}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tbind:this={buttonsContainerElement}\r\n\t\t\t\t\t\tclass=\"flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if message.done || siblings.length > 1}\r\n\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t<div class=\"flex self-center min-w-fit\" dir=\"ltr\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowPreviousMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclass=\"text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{siblings.indexOf(message.id) + 1}/{siblings.length}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowNextMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"m8.25 4.5 7.5 7.5-7.5 7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t{#if message.done}\r\n\t\t\t\t\t\t\t\t{#if !readOnly}\r\n\t\t\t\t\t\t\t\t\t{#if $user.role === 'user' ? ($user?.permissions?.chat?.edit ?? true) : true}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Edit')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\teditMessageHandler();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Copy')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tcopyToClipboard(message.content);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Read Aloud')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tid=\"speak-button-{message.id}\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (!loadingSpeech) {\r\n\t\t\t\t\t\t\t\t\t\t\t\ttoggleSpeakMessage();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{#if loadingSpeech}\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_S1WN {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation: spinner_MGfb 0.8s linear infinite;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.8s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_Km9P {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.65s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_JApP {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.5s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t@keyframes spinner_MGfb {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t93.75%,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topacity: 0.2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN\" cx=\"4\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_Km9P\" cx=\"12\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_JApP\" cx=\"20\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t{:else if speaking}\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t{#if $config?.features.enable_image_generation && ($user.role === 'admin' || $user?.permissions?.features?.image_generation) && !readOnly}\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Generate Image')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'}  p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!generatingImage) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tgenerateImage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{#if generatingImage}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_S1WN {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation: spinner_MGfb 0.8s linear infinite;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.8s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_Km9P {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.65s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.spinner_JApP {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tanimation-delay: -0.5s;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t@keyframes spinner_MGfb {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t93.75%,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\topacity: 0.2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</style>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN\" cx=\"4\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_Km9P\" cx=\"12\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<circle class=\"spinner_S1WN spinner_JApP\" cx=\"20\" cy=\"12\" r=\"3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if message.usage}\r\n\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\tcontent={message.usage\r\n\t\t\t\t\t\t\t\t\t\t\t? `<pre>${sanitizeResponseContent(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tJSON.stringify(message.usage, null, 2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.replace(/\"([^(\")\"]+)\":/g, '$1:')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.slice(1, -1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.split('\\n')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((line) => line.slice(2))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((line) => (line.endsWith(',') ? line.slice(0, -1) : line))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.join('\\n')\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}</pre>`\r\n\t\t\t\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t\t\t\t\tplacement=\"bottom\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" {isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"info-{message.id}\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t{#if !readOnly}\r\n\t\t\t\t\t\t\t\t\t{#if !$temporaryChatEnabled && ($config?.features.enable_message_rating ?? true)}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Good Response')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg {(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage?.annotation?.rating ?? ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t).toString() === '1'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={feedbackLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tawait feedbackHandler(1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getElementById(`message-feedback-${message.id}`)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?.scrollIntoView();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Bad Response')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg {(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmessage?.annotation?.rating ?? ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t).toString() === '-1'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-800'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: ''} dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={feedbackLoading}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tawait feedbackHandler(-1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getElementById(`message-feedback-${message.id}`)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?.scrollIntoView();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t{#if isLastMessage}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Continue Response')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"continue-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontinueResponse();\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Regenerate')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowRateComment = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\tregenerateResponse(message);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t(model?.actions ?? []).forEach((action) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdispatch('action', {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: action.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: 'regenerate-response',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessageId: message.id\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"continue-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t\t\t{#if isLastMessage}\r\n\t\t\t\t\t\t\t\t\t\t{#each model?.actions ?? [] as action}\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={action.name} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{isLastMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tactionMessage(action.id, message);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#if action.icon_url}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"size-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={action.icon_url}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4 {action.icon_url.includes('svg')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'dark:invert-[80%]'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: ''}\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle=\"fill: currentColor;\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={action.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Sparkles strokeWidth=\"2.1\" className=\"size-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if message.done && showRateComment}\r\n\t\t\t\t\t\t<RateComment\r\n\t\t\t\t\t\t\tbind:message\r\n\t\t\t\t\t\t\tbind:show={showRateComment}\r\n\t\t\t\t\t\t\ton:save={async (e) => {\r\n\t\t\t\t\t\t\t\tawait feedbackHandler(null, {\r\n\t\t\t\t\t\t\t\t\t...e.detail\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/key}\r\n\r\n<style>\r\n\t.buttons::-webkit-scrollbar {\r\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\r\n\t}\r\n\r\n\t.buttons {\r\n\t\t-ms-overflow-style: none; /* IE and Edge */\r\n\t\tscrollbar-width: none; /* Firefox */\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport dayjs from 'dayjs';\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\timport { createEventDispatcher } from 'svelte';\r\n\r\n\timport { mobile, settings } from '$lib/stores';\r\n\r\n\timport { generateMoACompletion } from '$lib/apis';\r\n\timport { updateChatById } from '$lib/apis/chats';\r\n\timport { createOpenAITextStream } from '$lib/apis/streaming';\r\n\r\n\timport ResponseMessage from './ResponseMessage.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport Merge from '$lib/components/icons/Merge.svelte';\r\n\r\n\timport Markdown from './Markdown.svelte';\r\n\timport Name from './Name.svelte';\r\n\timport Skeleton from './Skeleton.svelte';\r\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\r\n\tconst i18n = getContext('i18n');\r\n\tdayjs.extend(localizedFormat);\r\n\r\n\texport let chatId;\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\texport let isLastMessage;\r\n\texport let readOnly = false;\r\n\r\n\texport let updateChat: Function;\r\n\texport let editMessage: Function;\r\n\texport let saveMessage: Function;\r\n\texport let rateMessage: Function;\r\n\texport let actionMessage: Function;\r\n\r\n\texport let submitMessage: Function;\r\n\texport let deleteMessage: Function;\r\n\r\n\texport let continueResponse: Function;\r\n\texport let regenerateResponse: Function;\r\n\texport let mergeResponses: Function;\r\n\r\n\texport let addMessages: Function;\r\n\r\n\texport let triggerScroll: Function;\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tlet currentMessageId;\r\n\tlet parentMessage;\r\n\tlet groupedMessageIds = {};\r\n\tlet groupedMessageIdsIdx = {};\r\n\r\n\tlet message = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t$: if (history.messages) {\r\n\t\tif (JSON.stringify(message) !== JSON.stringify(history.messages[messageId])) {\r\n\t\t\tmessage = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t\t}\r\n\t}\r\n\r\n\tconst showPreviousMessage = async (modelIdx) => {\r\n\t\tgroupedMessageIdsIdx[modelIdx] = Math.max(0, groupedMessageIdsIdx[modelIdx] - 1);\r\n\r\n\t\tlet messageId = groupedMessageIds[modelIdx].messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\t\tconsole.log(messageId);\r\n\r\n\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t}\r\n\r\n\t\thistory.currentId = messageId;\r\n\r\n\t\tawait tick();\r\n\t\tawait updateChat();\r\n\t\ttriggerScroll();\r\n\t};\r\n\r\n\tconst showNextMessage = async (modelIdx) => {\r\n\t\tgroupedMessageIdsIdx[modelIdx] = Math.min(\r\n\t\t\tgroupedMessageIds[modelIdx].messageIds.length - 1,\r\n\t\t\tgroupedMessageIdsIdx[modelIdx] + 1\r\n\t\t);\r\n\r\n\t\tlet messageId = groupedMessageIds[modelIdx].messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\t\tconsole.log(messageId);\r\n\r\n\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t}\r\n\r\n\t\thistory.currentId = messageId;\r\n\r\n\t\tawait tick();\r\n\t\tawait updateChat();\r\n\t\ttriggerScroll();\r\n\t};\r\n\r\n\tconst initHandler = async () => {\r\n\t\tconsole.log('multiresponse:initHandler');\r\n\t\tawait tick();\r\n\r\n\t\tcurrentMessageId = messageId;\r\n\t\tparentMessage = history.messages[messageId].parentId\r\n\t\t\t? history.messages[history.messages[messageId].parentId]\r\n\t\t\t: null;\r\n\r\n\t\tgroupedMessageIds = parentMessage?.models.reduce((a, model, modelIdx) => {\r\n\t\t\t// Find all messages that are children of the parent message and have the same model\r\n\t\t\tlet modelMessageIds = parentMessage?.childrenIds\r\n\t\t\t\t.map((id) => history.messages[id])\r\n\t\t\t\t.filter((m) => m?.modelIdx === modelIdx)\r\n\t\t\t\t.map((m) => m.id);\r\n\r\n\t\t\t// Legacy support for messages that don't have a modelIdx\r\n\t\t\t// Find all messages that are children of the parent message and have the same model\r\n\t\t\tif (modelMessageIds.length === 0) {\r\n\t\t\t\tlet modelMessages = parentMessage?.childrenIds\r\n\t\t\t\t\t.map((id) => history.messages[id])\r\n\t\t\t\t\t.filter((m) => m?.model === model);\r\n\r\n\t\t\t\tmodelMessages.forEach((m) => {\r\n\t\t\t\t\tm.modelIdx = modelIdx;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tmodelMessageIds = modelMessages.map((m) => m.id);\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...a,\r\n\t\t\t\t[modelIdx]: { messageIds: modelMessageIds }\r\n\t\t\t};\r\n\t\t}, {});\r\n\r\n\t\tgroupedMessageIdsIdx = parentMessage?.models.reduce((a, model, modelIdx) => {\r\n\t\t\tconst idx = groupedMessageIds[modelIdx].messageIds.findIndex((id) => id === messageId);\r\n\t\t\tif (idx !== -1) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...a,\r\n\t\t\t\t\t[modelIdx]: idx\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...a,\r\n\t\t\t\t\t[modelIdx]: groupedMessageIds[modelIdx].messageIds.length - 1\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}, {});\r\n\r\n\t\tconsole.log(groupedMessageIds, groupedMessageIdsIdx);\r\n\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst mergeResponsesHandler = async () => {\r\n\t\tconst responses = Object.keys(groupedMessageIds).map((modelIdx) => {\r\n\t\t\tconst { messageIds } = groupedMessageIds[modelIdx];\r\n\t\t\tconst messageId = messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\r\n\t\t\treturn history.messages[messageId].content;\r\n\t\t});\r\n\t\tmergeResponses(messageId, responses, chatId);\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tawait initHandler();\r\n\t\tawait tick();\r\n\r\n\t\tconst messageElement = document.getElementById(`message-${messageId}`);\r\n\t\tif (messageElement) {\r\n\t\t\tmessageElement.scrollIntoView({ block: 'start' });\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n{#if parentMessage}\r\n\t<div>\r\n\t\t<div\r\n\t\t\tclass=\"flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden\"\r\n\t\t\tid=\"responses-container-{chatId}-{parentMessage.id}\"\r\n\t\t>\r\n\t\t\t{#each Object.keys(groupedMessageIds) as modelIdx}\r\n\t\t\t\t{#if groupedMessageIdsIdx[modelIdx] !== undefined && groupedMessageIds[modelIdx].messageIds.length > 0}\r\n\t\t\t\t\t<!-- svelte-ignore a11y-no-static-element-interactions -->\r\n\t\t\t\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\r\n\t\t\t\t\t{@const _messageId =\r\n\t\t\t\t\t\tgroupedMessageIds[modelIdx].messageIds[groupedMessageIdsIdx[modelIdx]]}\r\n\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" snap-center w-full max-w-full m-1 border {history.messages[messageId]\r\n\t\t\t\t\t\t\t?.modelIdx == modelIdx\r\n\t\t\t\t\t\t\t? `border-gray-100 dark:border-gray-850 border-[1.5px] ${\r\n\t\t\t\t\t\t\t\t\t$mobile ? 'min-w-full' : 'min-w-80'\r\n\t\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t\t: `border-gray-100 dark:border-gray-850 border-dashed ${\r\n\t\t\t\t\t\t\t\t\t$mobile ? 'min-w-full' : 'min-w-80'\r\n\t\t\t\t\t\t\t\t}`} transition-all p-5 rounded-2xl\"\r\n\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\tif (messageId != _messageId) {\r\n\t\t\t\t\t\t\t\tlet currentMessageId = _messageId;\r\n\t\t\t\t\t\t\t\tlet messageChildrenIds = history.messages[currentMessageId].childrenIds;\r\n\t\t\t\t\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\t\t\t\t\tcurrentMessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\t\t\t\t\tmessageChildrenIds = history.messages[currentMessageId].childrenIds;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\thistory.currentId = currentMessageId;\r\n\r\n\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\tawait updateChat();\r\n\t\t\t\t\t\t\t\ttriggerScroll();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#key history.currentId}\r\n\t\t\t\t\t\t\t{#if message}\r\n\t\t\t\t\t\t\t\t<ResponseMessage\r\n\t\t\t\t\t\t\t\t\t{chatId}\r\n\t\t\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\t\t\tmessageId={_messageId}\r\n\t\t\t\t\t\t\t\t\tisLastMessage={true}\r\n\t\t\t\t\t\t\t\t\tsiblings={groupedMessageIds[modelIdx].messageIds}\r\n\t\t\t\t\t\t\t\t\tshowPreviousMessage={() => showPreviousMessage(modelIdx)}\r\n\t\t\t\t\t\t\t\t\tshowNextMessage={() => showNextMessage(modelIdx)}\r\n\t\t\t\t\t\t\t\t\t{updateChat}\r\n\t\t\t\t\t\t\t\t\t{editMessage}\r\n\t\t\t\t\t\t\t\t\t{saveMessage}\r\n\t\t\t\t\t\t\t\t\t{rateMessage}\r\n\t\t\t\t\t\t\t\t\t{deleteMessage}\r\n\t\t\t\t\t\t\t\t\t{actionMessage}\r\n\t\t\t\t\t\t\t\t\t{submitMessage}\r\n\t\t\t\t\t\t\t\t\t{continueResponse}\r\n\t\t\t\t\t\t\t\t\tregenerateResponse={async (message) => {\r\n\t\t\t\t\t\t\t\t\t\tregenerateResponse(message);\r\n\t\t\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\t\t\tgroupedMessageIdsIdx[modelIdx] =\r\n\t\t\t\t\t\t\t\t\t\t\tgroupedMessageIds[modelIdx].messageIds.length - 1;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t{addMessages}\r\n\t\t\t\t\t\t\t\t\t{readOnly}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t{/key}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\r\n\t\t{#if !readOnly}\r\n\t\t\t{#if !Object.keys(groupedMessageIds).find((modelIdx) => {\r\n\t\t\t\tconst { messageIds } = groupedMessageIds[modelIdx];\r\n\t\t\t\tconst _messageId = messageIds[groupedMessageIdsIdx[modelIdx]];\r\n\t\t\t\treturn !history.messages[_messageId]?.done ?? false;\r\n\t\t\t})}\r\n\t\t\t\t<div class=\"flex justify-end\">\r\n\t\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t\t{#if history.messages[messageId]?.merged?.status}\r\n\t\t\t\t\t\t\t{@const message = history.messages[messageId]?.merged}\r\n\r\n\t\t\t\t\t\t\t<div class=\"w-full rounded-xl pl-5 pr-2 py-2\">\r\n\t\t\t\t\t\t\t\t<Name>\r\n\t\t\t\t\t\t\t\t\tMerged Response\r\n\r\n\t\t\t\t\t\t\t\t\t{#if message.timestamp}\r\n\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\" self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{dayjs(message.timestamp * 1000).format('LT')}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</Name>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"mt-1 markdown-prose w-full min-w-full\">\r\n\t\t\t\t\t\t\t\t\t{#if (message?.content ?? '') === ''}\r\n\t\t\t\t\t\t\t\t\t\t<Skeleton />\r\n\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t<Markdown id={`merged`} content={message.content ?? ''} />\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if isLastMessage}\r\n\t\t\t\t\t\t<div class=\" shrink-0 text-gray-600 dark:text-gray-500 mt-1\">\r\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Merge Responses')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tid=\"merge-response-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\"{true\r\n\t\t\t\t\t\t\t\t\t\t? 'visible'\r\n\t\t\t\t\t\t\t\t\t\t: 'invisible group-hover:visible'} p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tmergeResponsesHandler();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Merge className=\" size-5 \" />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport dayjs from 'dayjs';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { tick, getContext, onMount } from 'svelte';\r\n\r\n\timport { models, settings } from '$lib/stores';\r\n\timport { user as _user } from '$lib/stores';\r\n\timport { copyToClipboard as _copyToClipboard, formatDate } from '$lib/utils';\r\n\r\n\timport Name from './Name.svelte';\r\n\timport ProfileImage from './ProfileImage.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport FileItem from '$lib/components/common/FileItem.svelte';\r\n\timport Markdown from './Markdown.svelte';\r\n\timport Image from '$lib/components/common/Image.svelte';\r\n\timport DeleteConfirmDialog from '$lib/components/common/ConfirmDialog.svelte';\r\n\r\n\timport localizedFormat from 'dayjs/plugin/localizedFormat';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\tdayjs.extend(localizedFormat);\r\n\r\n\texport let user;\r\n\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\texport let siblings;\r\n\r\n\texport let showPreviousMessage: Function;\r\n\texport let showNextMessage: Function;\r\n\r\n\texport let editMessage: Function;\r\n\texport let deleteMessage: Function;\r\n\r\n\texport let isFirstMessage: boolean;\r\n\texport let readOnly: boolean;\r\n\r\n\tlet showDeleteConfirm = false;\r\n\r\n\tlet edit = false;\r\n\tlet editedContent = '';\r\n\tlet messageEditTextAreaElement: HTMLTextAreaElement;\r\n\r\n\tlet message = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t$: if (history.messages) {\r\n\t\tif (JSON.stringify(message) !== JSON.stringify(history.messages[messageId])) {\r\n\t\t\tmessage = JSON.parse(JSON.stringify(history.messages[messageId]));\r\n\t\t}\r\n\t}\r\n\r\n\tconst copyToClipboard = async (text) => {\r\n\t\tconst res = await _copyToClipboard(text);\r\n\t\tif (res) {\r\n\t\t\ttoast.success($i18n.t('Copying to clipboard was successful!'));\r\n\t\t}\r\n\t};\r\n\r\n\tconst editMessageHandler = async () => {\r\n\t\tedit = true;\r\n\t\teditedContent = message.content;\r\n\r\n\t\tawait tick();\r\n\r\n\t\tmessageEditTextAreaElement.style.height = '';\r\n\t\tmessageEditTextAreaElement.style.height = `${messageEditTextAreaElement.scrollHeight}px`;\r\n\r\n\t\tmessageEditTextAreaElement?.focus();\r\n\t};\r\n\r\n\tconst editMessageConfirmHandler = async (submit = true) => {\r\n\t\teditMessage(message.id, editedContent, submit);\r\n\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\t};\r\n\r\n\tconst cancelEditMessage = () => {\r\n\t\tedit = false;\r\n\t\teditedContent = '';\r\n\t};\r\n\r\n\tconst deleteMessageHandler = async () => {\r\n\t\tdeleteMessage(message.id);\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\t// console.log('UserMessage mounted');\r\n\t});\r\n</script>\r\n\r\n<DeleteConfirmDialog\r\n\tbind:show={showDeleteConfirm}\r\n\ttitle={$i18n.t('Delete message?')}\r\n\ton:confirm={() => {\r\n\t\tdeleteMessageHandler();\r\n\t}}\r\n/>\r\n\r\n<div class=\" flex w-full user-message\" dir={$settings.chatDirection} id=\"message-{message.id}\">\r\n\t{#if !($settings?.chatBubble ?? true)}\r\n\t\t<div class={`shrink-0 ${($settings?.chatDirection ?? 'LTR') === 'LTR' ? 'mr-3' : 'ml-3'}`}>\r\n\t\t\t<ProfileImage\r\n\t\t\t\tsrc={message.user\r\n\t\t\t\t\t? ($models.find((m) => m.id === message.user)?.info?.meta?.profile_image_url ??\r\n\t\t\t\t\t\t'/user.png')\r\n\t\t\t\t\t: (user?.profile_image_url ?? '/user.png')}\r\n\t\t\t\tclassName={'size-8'}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t{/if}\r\n\t<div class=\"flex-auto w-0 max-w-full pl-1\">\r\n\t\t{#if !($settings?.chatBubble ?? true)}\r\n\t\t\t<div>\r\n\t\t\t\t<Name>\r\n\t\t\t\t\t{#if message.user}\r\n\t\t\t\t\t\t{$i18n.t('You')}\r\n\t\t\t\t\t\t<span class=\" text-gray-500 text-sm font-medium\">{message?.user ?? ''}</span>\r\n\t\t\t\t\t{:else if $settings.showUsername || $_user.name !== user.name}\r\n\t\t\t\t\t\t{user.name}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t{$i18n.t('You')}\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#if message.timestamp}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Tooltip content={dayjs(message.timestamp * 1000).format('LLLL')}>\r\n\t\t\t\t\t\t\t\t<span class=\"line-clamp-1\">{formatDate(message.timestamp * 1000)}</span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</Name>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\r\n\t\t<div class=\"chat-{message.role} w-full min-w-full markdown-prose\">\r\n\t\t\t{#if message.files}\r\n\t\t\t\t<div class=\"mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap\">\r\n\t\t\t\t\t{#each message.files as file}\r\n\t\t\t\t\t\t<div class={($settings?.chatBubble ?? true) ? 'self-end' : ''}>\r\n\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t<Image src={file.url} imageClassName=\" max-h-96 rounded-lg\" />\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<FileItem\r\n\t\t\t\t\t\t\t\t\titem={file}\r\n\t\t\t\t\t\t\t\t\turl={file.url}\r\n\t\t\t\t\t\t\t\t\tname={file.name}\r\n\t\t\t\t\t\t\t\t\ttype={file.type}\r\n\t\t\t\t\t\t\t\t\tsize={file?.size}\r\n\t\t\t\t\t\t\t\t\tcolorClassName=\"bg-white dark:bg-gray-850 \"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#if message.content !== ''}\r\n\t\t\t\t{#if edit === true}\r\n\t\t\t\t\t<div class=\" w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2\">\r\n\t\t\t\t\t\t<div class=\"max-h-96 overflow-auto\">\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tid=\"message-edit-{message.id}\"\r\n\t\t\t\t\t\t\t\tbind:this={messageEditTextAreaElement}\r\n\t\t\t\t\t\t\t\tclass=\" bg-transparent outline-hidden w-full resize-none\"\r\n\t\t\t\t\t\t\t\tbind:value={editedContent}\r\n\t\t\t\t\t\t\t\ton:input={(e) => {\r\n\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\te.target.style.height = `${e.target.scrollHeight}px`;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\ton:keydown={(e) => {\r\n\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById('close-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tconst isCmdOrCtrlPressed = e.metaKey || e.ctrlKey;\r\n\t\t\t\t\t\t\t\t\tconst isEnterPressed = e.key === 'Enter';\r\n\r\n\t\t\t\t\t\t\t\t\tif (isCmdOrCtrlPressed && isEnterPressed) {\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById('confirm-edit-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\" mt-2 mb-1 flex justify-between text-sm font-medium\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"save-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\teditMessageConfirmHandler(false);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Save')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\"flex space-x-1.5\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"close-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\"px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tcancelEditMessage();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Cancel')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tid=\"confirm-edit-message-button\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\teditMessageConfirmHandler();\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Send')}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t\t<div class=\"flex {($settings?.chatBubble ?? true) ? 'justify-end pb-1' : 'w-full'}\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\"rounded-3xl {($settings?.chatBubble ?? true)\r\n\t\t\t\t\t\t\t\t\t? `max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${\r\n\t\t\t\t\t\t\t\t\t\t\tmessage.files ? 'rounded-tr-lg' : ''\r\n\t\t\t\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t\t\t\t: ' w-full'}\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{#if message.content}\r\n\t\t\t\t\t\t\t\t\t<Markdown id={message.id} content={message.content} />\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" flex {($settings?.chatBubble ?? true)\r\n\t\t\t\t\t\t\t\t? 'justify-end'\r\n\t\t\t\t\t\t\t\t: ''}  text-gray-600 dark:text-gray-500\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{#if !($settings?.chatBubble ?? true)}\r\n\t\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t\t<div class=\"flex self-center\" dir=\"ltr\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowPreviousMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-sm tracking-widest font-semibold self-center dark:text-gray-100\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{siblings.indexOf(message.id) + 1}/{siblings.length}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowNextMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m8.25 4.5 7.5 7.5-7.5 7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{#if !readOnly}\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Edit')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\teditMessageHandler();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Copy')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclass=\"invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\tcopyToClipboard(message.content);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.3\"\r\n\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\td=\"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t\t\t\t{#if !isFirstMessage && !readOnly}\r\n\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Delete')} placement=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tshowDeleteConfirm = true;\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t{#if $settings?.chatBubble ?? true}\r\n\t\t\t\t\t\t\t\t{#if siblings.length > 1}\r\n\t\t\t\t\t\t\t\t\t<div class=\"flex self-center\" dir=\"ltr\">\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowPreviousMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"text-sm tracking-widest font-semibold self-center dark:text-gray-100\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{siblings.indexOf(message.id) + 1}/{siblings.length}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition\"\r\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowNextMessage(message);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"m8.25 4.5 7.5 7.5-7.5 7.5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { tick, getContext, onMount, createEventDispatcher } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { settings } from '$lib/stores';\r\n\timport { copyToClipboard } from '$lib/utils';\r\n\r\n\timport MultiResponseMessages from './MultiResponseMessages.svelte';\r\n\timport ResponseMessage from './ResponseMessage.svelte';\r\n\timport UserMessage from './UserMessage.svelte';\r\n\r\n\texport let chatId;\r\n\texport let idx = 0;\r\n\r\n\texport let history;\r\n\texport let messageId;\r\n\r\n\texport let user;\r\n\r\n\texport let showPreviousMessage;\r\n\texport let showNextMessage;\r\n\texport let updateChat;\r\n\r\n\texport let editMessage;\r\n\texport let saveMessage;\r\n\texport let deleteMessage;\r\n\texport let rateMessage;\r\n\texport let actionMessage;\r\n\texport let submitMessage;\r\n\r\n\texport let regenerateResponse;\r\n\texport let continueResponse;\r\n\texport let mergeResponses;\r\n\r\n\texport let addMessages;\r\n\texport let triggerScroll;\r\n\texport let readOnly = false;\r\n</script>\r\n\r\n<div\r\n\tclass=\"flex flex-col justify-between px-5 mb-3 w-full {($settings?.widescreenMode ?? null)\r\n\t\t? 'max-w-full'\r\n\t\t: 'max-w-5xl'} mx-auto rounded-lg group\"\r\n>\r\n\t{#if history.messages[messageId]}\r\n\t\t{#if history.messages[messageId].role === 'user'}\r\n\t\t\t<UserMessage\r\n\t\t\t\t{user}\r\n\t\t\t\t{history}\r\n\t\t\t\t{messageId}\r\n\t\t\t\tisFirstMessage={idx === 0}\r\n\t\t\t\tsiblings={history.messages[messageId].parentId !== null\r\n\t\t\t\t\t? (history.messages[history.messages[messageId].parentId]?.childrenIds ?? [])\r\n\t\t\t\t\t: (Object.values(history.messages)\r\n\t\t\t\t\t\t\t.filter((message) => message.parentId === null)\r\n\t\t\t\t\t\t\t.map((message) => message.id) ?? [])}\r\n\t\t\t\t{showPreviousMessage}\r\n\t\t\t\t{showNextMessage}\r\n\t\t\t\t{editMessage}\r\n\t\t\t\t{deleteMessage}\r\n\t\t\t\t{readOnly}\r\n\t\t\t/>\r\n\t\t{:else if (history.messages[history.messages[messageId].parentId]?.models?.length ?? 1) === 1}\r\n\t\t\t<ResponseMessage\r\n\t\t\t\t{chatId}\r\n\t\t\t\t{history}\r\n\t\t\t\t{messageId}\r\n\t\t\t\tisLastMessage={messageId === history.currentId}\r\n\t\t\t\tsiblings={history.messages[history.messages[messageId].parentId]?.childrenIds ?? []}\r\n\t\t\t\t{showPreviousMessage}\r\n\t\t\t\t{showNextMessage}\r\n\t\t\t\t{updateChat}\r\n\t\t\t\t{editMessage}\r\n\t\t\t\t{saveMessage}\r\n\t\t\t\t{rateMessage}\r\n\t\t\t\t{actionMessage}\r\n\t\t\t\t{submitMessage}\r\n\t\t\t\t{deleteMessage}\r\n\t\t\t\t{continueResponse}\r\n\t\t\t\t{regenerateResponse}\r\n\t\t\t\t{addMessages}\r\n\t\t\t\t{readOnly}\r\n\t\t\t/>\r\n\t\t{:else}\r\n\t\t\t<MultiResponseMessages\r\n\t\t\t\tbind:history\r\n\t\t\t\t{chatId}\r\n\t\t\t\t{messageId}\r\n\t\t\t\tisLastMessage={messageId === history?.currentId}\r\n\t\t\t\t{updateChat}\r\n\t\t\t\t{editMessage}\r\n\t\t\t\t{saveMessage}\r\n\t\t\t\t{rateMessage}\r\n\t\t\t\t{actionMessage}\r\n\t\t\t\t{submitMessage}\r\n\t\t\t\t{deleteMessage}\r\n\t\t\t\t{continueResponse}\r\n\t\t\t\t{regenerateResponse}\r\n\t\t\t\t{mergeResponses}\r\n\t\t\t\t{triggerScroll}\r\n\t\t\t\t{addMessages}\r\n\t\t\t\t{readOnly}\r\n\t\t\t/>\r\n\t\t{/if}\r\n\t{/if}\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\timport { marked } from 'marked';\r\n\r\n\timport { config, user, models as _models, temporaryChatEnabled } from '$lib/stores';\r\n\timport { onMount, getContext } from 'svelte';\r\n\r\n\timport { blur, fade } from 'svelte/transition';\r\n\r\n\timport Suggestions from './Suggestions.svelte';\r\n\timport { sanitizeResponseContent } from '$lib/utils';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport EyeSlash from '$lib/components/icons/EyeSlash.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let modelIds = [];\r\n\texport let models = [];\r\n\texport let atSelectedModel;\r\n\r\n\texport let submitPrompt;\r\n\r\n\tlet mounted = false;\r\n\tlet selectedModelIdx = 0;\r\n\r\n\t$: if (modelIds.length > 0) {\r\n\t\tselectedModelIdx = models.length - 1;\r\n\t}\r\n\r\n\t$: models = modelIds.map((id) => $_models.find((m) => m.id === id));\r\n\r\n\tonMount(() => {\r\n\t\tmounted = true;\r\n\t});\r\n</script>\r\n\r\n{#key mounted}\r\n\t<div class=\"m-auto w-full max-w-6xl px-8 lg:px-20\">\r\n\t\t<div class=\"flex justify-start\">\r\n\t\t\t<div class=\"flex -space-x-4 mb-0.5\" in:fade={{ duration: 200 }}>\r\n\t\t\t\t{#each models as model, modelIdx}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tselectedModelIdx = modelIdx;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tcontent={marked.parse(\r\n\t\t\t\t\t\t\t\tsanitizeResponseContent(models[selectedModelIdx]?.info?.meta?.description ?? '')\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\tplacement=\"right\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\t\tsrc={model?.info?.meta?.profile_image_url ??\r\n\t\t\t\t\t\t\t\t\t($i18n.language === 'dg-DG'\r\n\t\t\t\t\t\t\t\t\t\t? `/doge.png`\r\n\t\t\t\t\t\t\t\t\t\t: `${WEBUI_BASE_URL}/static/favicon.png`)}\r\n\t\t\t\t\t\t\t\tclass=\" size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none\"\r\n\t\t\t\t\t\t\t\talt=\"logo\"\r\n\t\t\t\t\t\t\t\tdraggable=\"false\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/each}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if $temporaryChatEnabled}\r\n\t\t\t<Tooltip\r\n\t\t\t\tcontent=\"This chat won't appear in history and your messages will not be saved.\"\r\n\t\t\t\tclassName=\"w-fit\"\r\n\t\t\t\tplacement=\"top-start\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit\">\r\n\t\t\t\t\t<EyeSlash strokeWidth=\"2.5\" className=\"size-5\" /> Temporary Chat\r\n\t\t\t\t</div>\r\n\t\t\t</Tooltip>\r\n\t\t{/if}\r\n\r\n\t\t<div\r\n\t\t\tclass=\" mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary\"\r\n\t\t>\r\n\t\t\t<div>\r\n\t\t\t\t<div class=\" capitalize line-clamp-1\" in:fade={{ duration: 200 }}>\r\n\t\t\t\t\t{#if models[selectedModelIdx]?.name}\r\n\t\t\t\t\t\t{models[selectedModelIdx]?.name}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t{$i18n.t('Hello, {{name}}', { name: $user.name })}\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div in:fade={{ duration: 200, delay: 200 }}>\r\n\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.description ?? null}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{@html marked.parse(\r\n\t\t\t\t\t\t\t\tsanitizeResponseContent(models[selectedModelIdx]?.info?.meta?.description)\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.user}\r\n\t\t\t\t\t\t\t<div class=\"mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500\">\r\n\t\t\t\t\t\t\t\tBy\r\n\t\t\t\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.user.community}\r\n\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\thref=\"https://openwebui.com/m/{models[selectedModelIdx]?.info?.meta?.user\r\n\t\t\t\t\t\t\t\t\t\t\t.username}\"\r\n\t\t\t\t\t\t\t\t\t\t>{models[selectedModelIdx]?.info?.meta?.user.name\r\n\t\t\t\t\t\t\t\t\t\t\t? models[selectedModelIdx]?.info?.meta?.user.name\r\n\t\t\t\t\t\t\t\t\t\t\t: `@${models[selectedModelIdx]?.info?.meta?.user.username}`}</a\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t{models[selectedModelIdx]?.info?.meta?.user.name}\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div class=\" font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p\">\r\n\t\t\t\t\t\t\t{$i18n.t('How can I help you today?')}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\" w-full font-primary\" in:fade={{ duration: 200, delay: 300 }}>\r\n\t\t\t<Suggestions\r\n\t\t\t\tclassName=\"grid grid-cols-2\"\r\n\t\t\t\tsuggestionPrompts={atSelectedModel?.info?.meta?.suggestion_prompts ??\r\n\t\t\t\t\tmodels[selectedModelIdx]?.info?.meta?.suggestion_prompts ??\r\n\t\t\t\t\t$config?.default_prompt_suggestions ??\r\n\t\t\t\t\t[]}\r\n\t\t\t\ton:select={(e) => {\r\n\t\t\t\t\tsubmitPrompt(e.detail);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t</div>\r\n{/key}\r\n","<script lang=\"ts\">\r\n\timport { v4 as uuidv4 } from 'uuid';\r\n\timport {\r\n\t\tchats,\r\n\t\tconfig,\r\n\t\tsettings,\r\n\t\tuser as _user,\r\n\t\tmobile,\r\n\t\tcurrentChatPage,\r\n\t\ttemporaryChatEnabled,\r\n\t\tisConfidentialEnabled\r\n\t} from '$lib/stores';\r\n\timport { tick, getContext, onMount, createEventDispatcher } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { getChatList, updateChatById } from '$lib/apis/chats';\r\n\timport { copyToClipboard, findWordIndices } from '$lib/utils';\r\n\r\n\timport Message from './Messages/Message.svelte';\r\n\timport Loader from '../common/Loader.svelte';\r\n\timport Spinner from '../common/Spinner.svelte';\r\n\r\n\timport ChatPlaceholder from './ChatPlaceholder.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let className = 'h-full flex pt-8';\r\n\r\n\texport let chatId = '';\r\n\texport let user = $_user;\r\n\r\n\texport let prompt;\r\n\texport let history = {};\r\n\texport let selectedModels;\r\n\texport let atSelectedModel;\r\n\r\n\tlet messages = [];\r\n\r\n\texport let sendPrompt: Function;\r\n\texport let continueResponse: Function;\r\n\texport let regenerateResponse: Function;\r\n\texport let mergeResponses: Function;\r\n\r\n\texport let chatActionHandler: Function;\r\n\texport let showMessage: Function = () => {};\r\n\texport let submitMessage: Function = () => {};\r\n\texport let addMessages: Function = () => {};\r\n\r\n\texport let readOnly = false;\r\n\r\n\texport let bottomPadding = false;\r\n\texport let autoScroll;\r\n\r\n\tlet messagesCount = 20;\r\n\tlet messagesLoading = false;\r\n\r\n\tconst loadMoreMessages = async () => {\r\n\t\t// scroll slightly down to disable continuous loading\r\n\t\tconst element = document.getElementById('messages-container');\r\n\t\telement.scrollTop = element.scrollTop + 100;\r\n\r\n\t\tmessagesLoading = true;\r\n\t\tmessagesCount += 20;\r\n\r\n\t\tawait tick();\r\n\r\n\t\tmessagesLoading = false;\r\n\t};\r\n\r\n\t$: if (history.currentId) {\r\n\t\tlet _messages = [];\r\n\r\n\t\tlet message = history.messages[history.currentId];\r\n\t\twhile (message && _messages.length <= messagesCount) {\r\n\t\t\t_messages.unshift({ ...message });\r\n\t\t\tmessage = message.parentId !== null ? history.messages[message.parentId] : null;\r\n\t\t}\r\n\r\n\t\tmessages = _messages;\r\n\t} else {\r\n\t\tmessages = [];\r\n\t}\r\n\r\n\t$: if (autoScroll && bottomPadding) {\r\n\t\t(async () => {\r\n\t\t\tawait tick();\r\n\t\t\tscrollToBottom();\r\n\t\t})();\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tconst element = document.getElementById('messages-container');\r\n\t\telement.scrollTop = element.scrollHeight;\r\n\t};\r\n\r\n\tconst updateChat = async () => {\r\n\t\tif (!$temporaryChatEnabled) {\r\n\t\t\thistory = history;\r\n\t\t\tawait tick();\r\n\t\t\thistory.is_confidential = $isConfidentialEnabled;\r\n\t\t\tawait updateChatById(localStorage.token, chatId, {\r\n\t\t\t\thistory: history,\r\n\t\t\t\tmessages: messages\r\n\t\t\t});\r\n\r\n\t\t\tcurrentChatPage.set(1);\r\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t}\r\n\t};\r\n\r\n\tconst showPreviousMessage = async (message) => {\r\n\t\tif (message.parentId !== null) {\r\n\t\t\tlet messageId =\r\n\t\t\t\thistory.messages[message.parentId].childrenIds[\r\n\t\t\t\t\tMath.max(history.messages[message.parentId].childrenIds.indexOf(message.id) - 1, 0)\r\n\t\t\t\t];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet childrenIds = Object.values(history.messages)\r\n\t\t\t\t.filter((message) => message.parentId === null)\r\n\t\t\t\t.map((message) => message.id);\r\n\t\t\tlet messageId = childrenIds[Math.max(childrenIds.indexOf(message.id) - 1, 0)];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif ($settings?.scrollOnBranchChange ?? true) {\r\n\t\t\tconst element = document.getElementById('messages-container');\r\n\t\t\tautoScroll = element.scrollHeight - element.scrollTop <= element.clientHeight + 50;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t};\r\n\r\n\tconst showNextMessage = async (message) => {\r\n\t\tif (message.parentId !== null) {\r\n\t\t\tlet messageId =\r\n\t\t\t\thistory.messages[message.parentId].childrenIds[\r\n\t\t\t\t\tMath.min(\r\n\t\t\t\t\t\thistory.messages[message.parentId].childrenIds.indexOf(message.id) + 1,\r\n\t\t\t\t\t\thistory.messages[message.parentId].childrenIds.length - 1\r\n\t\t\t\t\t)\r\n\t\t\t\t];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet childrenIds = Object.values(history.messages)\r\n\t\t\t\t.filter((message) => message.parentId === null)\r\n\t\t\t\t.map((message) => message.id);\r\n\t\t\tlet messageId =\r\n\t\t\t\tchildrenIds[Math.min(childrenIds.indexOf(message.id) + 1, childrenIds.length - 1)];\r\n\r\n\t\t\tif (message.id !== messageId) {\r\n\t\t\t\tlet messageChildrenIds = history.messages[messageId].childrenIds;\r\n\r\n\t\t\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t\t\tmessageId = messageChildrenIds.at(-1);\r\n\t\t\t\t\tmessageChildrenIds = history.messages[messageId].childrenIds;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.currentId = messageId;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif ($settings?.scrollOnBranchChange ?? true) {\r\n\t\t\tconst element = document.getElementById('messages-container');\r\n\t\t\tautoScroll = element.scrollHeight - element.scrollTop <= element.clientHeight + 50;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t};\r\n\r\n\tconst rateMessage = async (messageId, rating) => {\r\n\t\thistory.messages[messageId].annotation = {\r\n\t\t\t...history.messages[messageId].annotation,\r\n\t\t\trating: rating\r\n\t\t};\r\n\r\n\t\tawait updateChat();\r\n\t};\r\n\r\n\tconst editMessage = async (messageId, content, submit = true) => {\r\n\t\tif (history.messages[messageId].role === 'user') {\r\n\t\t\tif (submit) {\r\n\t\t\t\t// New user message\r\n\t\t\t\tlet userPrompt = content;\r\n\t\t\t\tlet userMessageId = uuidv4();\r\n\r\n\t\t\t\tlet userMessage = {\r\n\t\t\t\t\tid: userMessageId,\r\n\t\t\t\t\tparentId: history.messages[messageId].parentId,\r\n\t\t\t\t\tchildrenIds: [],\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: userPrompt,\r\n\t\t\t\t\t...(history.messages[messageId].files && { files: history.messages[messageId].files }),\r\n\t\t\t\t\tmodels: selectedModels,\r\n\t\t\t\t\ttimestamp: Math.floor(Date.now() / 1000) // Unix epoch\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet messageParentId = history.messages[messageId].parentId;\r\n\r\n\t\t\t\tif (messageParentId !== null) {\r\n\t\t\t\t\thistory.messages[messageParentId].childrenIds = [\r\n\t\t\t\t\t\t...history.messages[messageParentId].childrenIds,\r\n\t\t\t\t\t\tuserMessageId\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\r\n\t\t\t\thistory.messages[userMessageId] = userMessage;\r\n\t\t\t\thistory.currentId = userMessageId;\r\n\r\n\t\t\t\tawait tick();\r\n\t\t\t\tawait sendPrompt(history, userPrompt, userMessageId);\r\n\t\t\t} else {\r\n\t\t\t\t// Edit user message\r\n\t\t\t\thistory.messages[messageId].content = content;\r\n\t\t\t\tawait updateChat();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (submit) {\r\n\t\t\t\t// New response message\r\n\t\t\t\tconst responseMessageId = uuidv4();\r\n\t\t\t\tconst message = history.messages[messageId];\r\n\t\t\t\tconst parentId = message.parentId;\r\n\r\n\t\t\t\tconst responseMessage = {\r\n\t\t\t\t\t...message,\r\n\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\tparentId: parentId,\r\n\t\t\t\t\tchildrenIds: [],\r\n\t\t\t\t\tfiles: undefined,\r\n\t\t\t\t\tcontent: content,\r\n\t\t\t\t\ttimestamp: Math.floor(Date.now() / 1000) // Unix epoch\r\n\t\t\t\t};\r\n\r\n\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t\t\thistory.currentId = responseMessageId;\r\n\r\n\t\t\t\t// Append messageId to childrenIds of parent message\r\n\t\t\t\tif (parentId !== null) {\r\n\t\t\t\t\thistory.messages[parentId].childrenIds = [\r\n\t\t\t\t\t\t...history.messages[parentId].childrenIds,\r\n\t\t\t\t\t\tresponseMessageId\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait updateChat();\r\n\t\t\t} else {\r\n\t\t\t\t// Edit response message\r\n\t\t\t\thistory.messages[messageId].originalContent = history.messages[messageId].content;\r\n\t\t\t\thistory.messages[messageId].content = content;\r\n\t\t\t\tawait updateChat();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst actionMessage = async (actionId, message, event = null) => {\r\n\t\tawait chatActionHandler(chatId, actionId, message.model, message.id, event);\r\n\t};\r\n\r\n\tconst saveMessage = async (messageId, message) => {\r\n\t\thistory.messages[messageId] = message;\r\n\t\tawait updateChat();\r\n\t};\r\n\r\n\tconst deleteMessage = async (messageId) => {\r\n\t\tconst messageToDelete = history.messages[messageId];\r\n\t\tconst parentMessageId = messageToDelete.parentId;\r\n\t\tconst childMessageIds = messageToDelete.childrenIds ?? [];\r\n\r\n\t\t// Collect all grandchildren\r\n\t\tconst grandchildrenIds = childMessageIds.flatMap(\r\n\t\t\t(childId) => history.messages[childId]?.childrenIds ?? []\r\n\t\t);\r\n\r\n\t\t// Update parent's children\r\n\t\tif (parentMessageId && history.messages[parentMessageId]) {\r\n\t\t\thistory.messages[parentMessageId].childrenIds = [\r\n\t\t\t\t...history.messages[parentMessageId].childrenIds.filter((id) => id !== messageId),\r\n\t\t\t\t...grandchildrenIds\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\t// Update grandchildren's parent\r\n\t\tgrandchildrenIds.forEach((grandchildId) => {\r\n\t\t\tif (history.messages[grandchildId]) {\r\n\t\t\t\thistory.messages[grandchildId].parentId = parentMessageId;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Delete the message and its children\r\n\t\t[messageId, ...childMessageIds].forEach((id) => {\r\n\t\t\tdelete history.messages[id];\r\n\t\t});\r\n\r\n\t\tawait tick();\r\n\r\n\t\tshowMessage({ id: parentMessageId });\r\n\r\n\t\t// Update the chat\r\n\t\tawait updateChat();\r\n\t};\r\n\r\n\tconst triggerScroll = () => {\r\n\t\tif (autoScroll) {\r\n\t\t\tconst element = document.getElementById('messages-container');\r\n\t\t\tautoScroll = element.scrollHeight - element.scrollTop <= element.clientHeight + 50;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<div class={className}>\r\n\t{#if Object.keys(history?.messages ?? {}).length == 0}\r\n\t\t<ChatPlaceholder\r\n\t\t\tmodelIds={selectedModels}\r\n\t\t\t{atSelectedModel}\r\n\t\t\tsubmitPrompt={async (p) => {\r\n\t\t\t\tlet text = p;\r\n\r\n\t\t\t\tif (p.includes('{{CLIPBOARD}}')) {\r\n\t\t\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\r\n\t\t\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\r\n\t\t\t\t\t\treturn '{{CLIPBOARD}}';\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\ttext = p.replaceAll('{{CLIPBOARD}}', clipboardText);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprompt = text;\r\n\r\n\t\t\t\tawait tick();\r\n\r\n\t\t\t\tconst chatInputContainerElement = document.getElementById('chat-input-container');\r\n\t\t\t\tif (chatInputContainerElement) {\r\n\t\t\t\t\tprompt = p;\r\n\r\n\t\t\t\t\tchatInputContainerElement.style.height = '';\r\n\t\t\t\t\tchatInputContainerElement.style.height =\r\n\t\t\t\t\t\tMath.min(chatInputContainerElement.scrollHeight, 200) + 'px';\r\n\t\t\t\t\tchatInputContainerElement.focus();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait tick();\r\n\t\t\t}}\r\n\t\t/>\r\n\t{:else}\r\n\t\t<div class=\"w-full pt-2\">\r\n\t\t\t{#key chatId}\r\n\t\t\t\t<div class=\"w-full\">\r\n\t\t\t\t\t{#if messages.at(0)?.parentId !== null}\r\n\t\t\t\t\t\t<Loader\r\n\t\t\t\t\t\t\ton:visible={(e) => {\r\n\t\t\t\t\t\t\t\tconsole.log('visible');\r\n\t\t\t\t\t\t\t\tif (!messagesLoading) {\r\n\t\t\t\t\t\t\t\t\tloadMoreMessages();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\"w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<Spinner className=\" size-4\" />\r\n\t\t\t\t\t\t\t\t<div class=\" \">Loading...</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Loader>\r\n\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t{#each messages as message, messageIdx (message.id)}\r\n\t\t\t\t\t\t<Message\r\n\t\t\t\t\t\t\t{chatId}\r\n\t\t\t\t\t\t\tbind:history\r\n\t\t\t\t\t\t\tmessageId={message.id}\r\n\t\t\t\t\t\t\tidx={messageIdx}\r\n\t\t\t\t\t\t\t{user}\r\n\t\t\t\t\t\t\t{showPreviousMessage}\r\n\t\t\t\t\t\t\t{showNextMessage}\r\n\t\t\t\t\t\t\t{updateChat}\r\n\t\t\t\t\t\t\t{editMessage}\r\n\t\t\t\t\t\t\t{deleteMessage}\r\n\t\t\t\t\t\t\t{rateMessage}\r\n\t\t\t\t\t\t\t{actionMessage}\r\n\t\t\t\t\t\t\t{saveMessage}\r\n\t\t\t\t\t\t\t{submitMessage}\r\n\t\t\t\t\t\t\t{regenerateResponse}\r\n\t\t\t\t\t\t\t{continueResponse}\r\n\t\t\t\t\t\t\t{mergeResponses}\r\n\t\t\t\t\t\t\t{addMessages}\r\n\t\t\t\t\t\t\t{triggerScroll}\r\n\t\t\t\t\t\t\t{readOnly}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pb-12\" />\r\n\t\t\t\t{#if bottomPadding}\r\n\t\t\t\t\t<div class=\"  pb-6\" />\r\n\t\t\t\t{/if}\r\n\t\t\t{/key}\r\n\t\t</div>\r\n\t{/if}\r\n</div>\r\n"],"names":["KokoroWorker","dtype","__publicField","WorkerInstance","event","status","error","audioUrl","request","resolve","reject","handleMessage","text","voice","ctx","insert_hydration","target","svg","anchor","append_hydration","path","className","$$props","strokeWidth","WEBUI_VERSION","div","set_data","t1","t1_value","get_key","t0_value","div0","div1","dirty","t0","t2","t2_value","create_if_block_1","set_style","button","create_if_block","arraysEqual","a","b","i","i18n","getContext","dispatch","createEventDispatcher","suggestionPrompts","inputValue","sortedPrompts","fuseOptions","fuse","filteredPrompts","getFilteredPrompts","$$invalidate","newFilteredPrompts","result","click_handler","prompt","Fuse","attr","div0_class_value","div1_class_value","div2","div2_class_value","div4","div4_class_value","div5","div5_class_value","div6","div6_class_value","div8","div8_class_value","div9","div9_class_value","div11","div10","div3","div7","size","_a","button_class_value","button_disabled_value","_b","t_value","create_if_block_2","create_if_block_3","create_if_block_4","create_if_block_5","create_if_block_6","create_if_block_7","create_if_block_8","create_if_block_9","create_if_block_10","create_if_block_11","create_if_block_12","create_if_block_13","create_if_block_14","if_block0","create_if_block_15","each_value_1","ensure_array_like","func","div12","div12_id_value","button0","textarea","button1","t6","t6_value","t9","t9_value","t14","t14_value","current","_","message","show","LIKE_REASONS","DISLIKE_REASONS","tags","reasons","selectedReason","comment","detailedRating","selectedModel","init","_c","tag","_e","_d","onMount","$models","m","toast","$i18n","saveHandler","rating","reason","e","a_href_value","a_class_value","if_block","each_value","state","value","content","calculatePercentage","child_ctx","t","t3_value","span","t3","WEBUI_API_BASE_URL","_f","_h","_g","_j","_i","_l","_k","t4_value","span0","span0_class_value","getRelevanceColor","span1","t4","pre","iframe","iframe_srcdoc_value","hr","if_block2","each_blocks","distance","percentage","citation","showPercentage","showRelevance","mergedDocuments","c","doc","show_if","each_value_2","span2","t5","t5_value","t7","t7_value","button_id_value","calculateShowRelevance","sources","distances","inRange","d","outOfRange","shouldShowPercentage","id","citations","showCitationModal","selectedCitation","isCollapsibleOpen","func_1","func_2","acc","source","document","index","metadata","_source","existingSource","item","ul","li","if_block1","if_block3","_m","_o","_n","if_block4","_q","_p","_s","_r","codeblock_changes","codeExecution","codeExecutions","selectedCodeExecution","showCodeExecutionModal","updateSelectedCodeExecution","execution","input","model","messages","onAdd","floatingInput","selectedText","floatingInputValue","responseContent","responseDone","autoScroll","responseContainer","askHandler","res","controller","chatCompletion","reader","decoder","done","lines","line","tick","data","explainHandler","explainText","addHandler","closeHandler","createMessagesList","floatingbuttons_changes","markdown_changes","history","save","floatingButtons","onSourceClick","onTaskClick","onAddMessages","contentContainerElement","floatingButtonsElement","updateButtonPosition","buttonsContainerElement","closeFloatingButtons","selection","rect","parentRect","top","left","spaceOnRight","halfScreenWidth","$mobile","right","keydownHandler","onDestroy","s","ids","lang","code","$chatId","showArtifacts","showControls","$$value","modelId","parentId","constants_0","dayjs","formatDate","create_if_block_37","tooltip_changes","image_changes","create_if_block_36","create_if_block_25","create_if_block_34","create_if_block_32","create_if_block_33","create_if_block_28","create_if_block_29","create_if_block_21","create_if_block_20","create_if_block_19","textarea_id_value","button2","contentrenderer_changes","error_changes","citations_changes","codeexecutions_changes","create_if_block_17","create_if_block_16","style","circle0","circle1","circle2","sanitizeResponseContent","func_4","func_5","path0","path1","src_url_equal","img","img_src_value","img_class_value","img_alt_value","WEBUI_BASE_URL","create_if_block_24","get_if_ctx","null_to_empty","div5_id_value","div5_dir_value","previous_key","safe_not_equal","f","chatId","messageId","siblings","showPreviousMessage","showNextMessage","updateChat","editMessage","saveMessage","rateMessage","actionMessage","deleteMessage","submitMessage","continueResponse","regenerateResponse","addMessages","isLastMessage","readOnly","showDeleteConfirm","edit","editedContent","editTextAreaElement","audioParts","speaking","speakingIdx","loadingSpeech","generatingImage","showRateComment","copyToClipboard","_copyToClipboard","playAudio","idx","audio","r","toggleSpeakMessage","$config","voices","getVoicesLoop","v","$settings","speak","messageContentParts","getMessageContentParts","_sentence","lastPlayedAudioPromise","$TTSWorker","TTSWorker","sentence","blob","synthesizeOpenAISpeech","_u","_t","blobUrl","_w","_v","editMessageHandler","editMessageConfirmHandler","saveAsCopyHandler","cancelEditMessage","generateImage","imageGenerations","files","image","feedbackLoading","feedbackHandler","details","updatedMessage","chat","getChatById","feedbackItem","baseModels","feedback","updateFeedbackById","createNewFeedback","generateTags","deleteMessageHandler","isCmdOrCtrlPressed","isEnterPressed","sourceButton","sourcesCollapsible","raw","oldContent","newContent","type","action","div_class_value","get_if_ctx_1","localizedFormat","mergeResponses","triggerScroll","currentMessageId","parentMessage","groupedMessageIds","groupedMessageIdsIdx","modelIdx","messageChildrenIds","initHandler","modelMessageIds","modelMessages","mergeResponsesHandler","responses","messageIds","messageElement","_messageId","profileimage_changes","fileitem_changes","div2_dir_value","div2_id_value","user","isFirstMessage","messageEditTextAreaElement","submit","usermessage_changes","marked","raw_value","html_tag","suggestions_changes","div0_intro","create_in_transition","fade","div2_intro","div3_intro","div6_intro","modelIds","models","atSelectedModel","submitPrompt","mounted","selectedModelIdx","$_models","message_1_changes","$_user","selectedModels","sendPrompt","chatActionHandler","showMessage","bottomPadding","messagesCount","messagesLoading","loadMoreMessages","element","scrollToBottom","$temporaryChatEnabled","$isConfidentialEnabled","updateChatById","currentChatPage","chats","getChatList","$currentChatPage","childrenIds","userPrompt","userMessageId","uuidv4","userMessage","messageParentId","responseMessageId","responseMessage","actionId","messageToDelete","parentMessageId","childMessageIds","grandchildrenIds","childId","grandchildId","p","clipboardText","err","chatInputContainerElement","_messages"],"mappings":"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"}