var Yr=Object.defineProperty;var Xr=(r,e,t)=>e in r?Yr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var vt=(r,e,t)=>Xr(r,typeof e!="symbol"?e+"":e,t);import{s as Ve,D as pe,E as be,a as w,d as h,f as d,i as V,g as v,n as ve,e as E,k as H,c as N,o as z,j as Me,p as Ue,F as gt,l as ae,S as Rt,u as me,t as U,b as q,h as Z,N as He,B as nt,Q as qe,H as et,q as bt,y as Ae,A as Ze,r as $r,v as xr,w as en,x as tn,C as De,M as ln,an as ul,V as Ot,P as Tt,T as sn,U as rn}from"./scheduler.COi8bgmk.js";import{S as Be,i as Se,g as se,a as D,c as re,t as b,b as X,d as $,m as x,e as ee,f as Ke,j as Bt}from"./index.Bs8QJi7D.js";import{e as Ee,u as Gt,d as nn,o as yr}from"./each.BJyh__76.js";import{W as on,b as cl,m as jt,d as dl,i as Ir,h as an,J as fn,K as un,a as Ht,c as Mr,T as hl,u as zt,l as Zt,e as Lt,z as ml,L as cn,B as dn}from"./index.CEg_AGoW.js";import{t as Pe}from"./Toaster.svelte_svelte_type_style_lang.DWJS6NQk.js";import{f as hn,u as mn,i as gn}from"./index.B4m0Tvqa.js";import{b as Jt,m as Er,w as _n,f as pt,r as Pt,l as Nr,v as gl}from"./index.CAqpCFNN.js";import{d as it}from"./relativeTime.BDz4fsXT.js";import{b as _l,c as vn}from"./index.BQ9JfV7U.js";import{o as pn}from"./index.wYMsEk5_.js";import{s as bn}from"./index.WVUePvoN.js";import{i as kn}from"./index.CyxR1fAf.js";import{ai as wn,ag as yt,af as Dr,ae as Kt,ah as Vr}from"./Markdown.DB9plO3Y.js";import{T as Re}from"./Tooltip.B-3Et9rk.js";import{T as yn}from"./Tags.xKOLJD-o.js";import{S as Wt}from"./Spinner.CDQGqs0P.js";import{C as Cr}from"./ChevronDown.C_Siw547.js";import{C as Tr}from"./ChevronUp.DVo8vQ-K.js";import{M as In}from"./MagnifyingGlass.DH0mtRLU.js";import{C as Br}from"./Collapsible.CgOPK37m.js";import{C as Sr}from"./ConfirmDialog.CkQZuRwU.js";import{I as Mn,F as En}from"./FileItem.BJjA9Yfq.js";import{M as Rr}from"./Modal.DiiA2I-w.js";import{B as Qt}from"./Badge.Dzp381-S.js";import{C as Nn}from"./Check.CyD3fXtR.js";import{X as Dn}from"./XMark.DYluEBXi.js";import{E as Vn}from"./EllipsisHorizontal.BpDNqRnL.js";import{m as At}from"./marked.esm._0_gBwjO.js";import{c as vl}from"./index.Cg0OPtX4.js";import{L as Cn}from"./Loader.CalupqBL.js";import{f as St}from"./index.DcmDifxE.js";import{F as Tn}from"./fuse.CU2r43ac.js";function Bn(r){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:r==null?void 0:r.name})}class Sn{constructor(e="fp32"){vt(this,"worker",null);vt(this,"initialized",!1);vt(this,"dtype");vt(this,"requestQueue",[]);vt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new Bn,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const n=this.requestQueue.shift();n&&(n.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const n=this.requestQueue.shift();n&&(n.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Rn(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",r[1]),d(e,"stroke","currentColor"),d(e,"class",r[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&h(e)}}}function On(r,e,t){let{className:l="size-3"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Ln extends Be{constructor(e){super(),Se(this,e,On,Rn,Ve,{className:0,strokeWidth:1})}}function pl(r,e,t){const l=r.slice();return l[13]=e[t],l[15]=t,l}function Pn(r){let e,t,l,s;return{c(){e=E("div"),t=U(r[3]),l=U(" ‧ v"),s=U(cl),this.h()},l(n){e=N(n,"DIV",{class:!0});var i=w(e);t=q(i,r[3]),l=q(i," ‧ v"),s=q(i,cl),i.forEach(h),this.h()},h(){d(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(n,i){V(n,e,i),v(e,t),v(e,l),v(e,s)},p(n,i){i&8&&Z(t,n[3])},i:ve,o:ve,d(n){n&&h(e)}}}function An(r){let e,t,l=r[2].t("Suggested")+"",s,n;return e=new Ln({}),{c(){X(e.$$.fragment),t=H(),s=U(l)},l(i){$(e.$$.fragment,i),t=z(i),s=q(i,l)},m(i,o){x(e,i,o),V(i,t,o),V(i,s,o),n=!0},p(i,o){(!n||o&4)&&l!==(l=i[2].t("Suggested")+"")&&Z(s,l)},i(i){n||(b(e.$$.fragment,i),n=!0)},o(i){D(e.$$.fragment,i),n=!1},d(i){i&&(h(t),h(s)),ee(e,i)}}}function bl(r){let e=[],t=new Map,l,s=Ee(r[1]);const n=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let o=pl(r,s,i),a=n(o);t.set(a,e[i]=kl(a,o))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=ae()},l(i){for(let o=0;o<e.length;o+=1)e[o].l(i);l=ae()},m(i,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,o);V(i,l,o)},p(i,o){o&38&&(s=Ee(i[1]),e=Gt(e,o,n,1,i,s,t,l.parentNode,nn,kl,l,pl))},d(i){i&&h(l);for(let o=0;o<e.length;o+=1)e[o].d(i)}}}function jn(r){let e,t=r[13].content+"",l,s,n,i=r[2].t("Prompt")+"",o;return{c(){e=E("div"),l=U(t),s=H(),n=E("div"),o=U(i),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(h),s=z(a),n=N(a,"DIV",{class:!0});var u=w(n);o=q(u,i),u.forEach(h),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(n,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),v(e,l),V(a,s,f),V(a,n,f),v(n,o)},p(a,f){f&2&&t!==(t=a[13].content+"")&&Z(l,t),f&4&&i!==(i=a[2].t("Prompt")+"")&&Z(o,i)},d(a){a&&(h(e),h(s),h(n))}}}function Hn(r){let e,t=r[13].title[0]+"",l,s,n,i=r[13].title[1]+"",o;return{c(){e=E("div"),l=U(t),s=H(),n=E("div"),o=U(i),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(h),s=z(a),n=N(a,"DIV",{class:!0});var u=w(n);o=q(u,i),u.forEach(h),this.h()},h(){d(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),d(n,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),v(e,l),V(a,s,f),V(a,n,f),v(n,o)},p(a,f){f&2&&t!==(t=a[13].title[0]+"")&&Z(l,t),f&2&&i!==(i=a[13].title[1]+"")&&Z(o,i)},d(a){a&&(h(e),h(s),h(n))}}}function kl(r,e){let t,l,s,n,i;function o(c,m){return c[13].title&&c[13].title[0]!==""?Hn:jn}let a=o(e),f=a(e);function u(){return e[9](e[13])}return{key:r,first:null,c(){t=E("button"),l=E("div"),f.c(),s=H(),this.h()},l(c){t=N(c,"BUTTON",{class:!0,style:!0});var m=w(t);l=N(m,"DIV",{class:!0});var g=w(l);f.l(g),g.forEach(h),s=z(m),m.forEach(h),this.h()},h(){d(l,"class","flex flex-col text-left"),d(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),Rt(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(c,m){V(c,t,m),v(t,l),f.m(l,null),v(t,s),n||(i=me(t,"click",u),n=!0)},p(c,m){e=c,a===(a=o(e))&&f?f.p(e,m):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),m&2&&Rt(t,"animation-delay",e[15]*60+"ms")},d(c){c&&h(t),f.d(),n=!1,i()}}}function zn(r){let e,t,l,s,n,i,o;const a=[An,Pn],f=[];function u(m,g){return m[1].length>0?0:1}t=u(r),l=f[t]=a[t](r);let c=r[1].length>0&&bl(r);return{c(){e=E("div"),l.c(),s=H(),n=E("div"),c&&c.c(),this.h()},l(m){e=N(m,"DIV",{class:!0});var g=w(e);l.l(g),g.forEach(h),s=z(m),n=N(m,"DIV",{class:!0});var _=w(n);c&&c.l(_),_.forEach(h),this.h()},h(){d(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),d(n,"class",i="h-40 overflow-auto scrollbar-none "+r[0]+" items-start svelte-1co34if")},m(m,g){V(m,e,g),f[t].m(e,null),V(m,s,g),V(m,n,g),c&&c.m(n,null),o=!0},p(m,[g]){let _=t;t=u(m),t===_?f[t].p(m,g):(se(),D(f[_],1,1,()=>{f[_]=null}),re(),l=f[t],l?l.p(m,g):(l=f[t]=a[t](m),l.c()),b(l,1),l.m(e,null)),m[1].length>0?c?c.p(m,g):(c=bl(m),c.c(),c.m(n,null)):c&&(c.d(1),c=null),(!o||g&1&&i!==(i="h-40 overflow-auto scrollbar-none "+m[0]+" items-start svelte-1co34if"))&&d(n,"class",i)},i(m){o||(b(l),o=!0)},o(m){D(l),o=!1},d(m){m&&(h(e),h(s),h(n)),f[t].d(),c&&c.d()}}}function Wn(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if((r[t].id??r[t].content)!==(e[t].id??e[t].content))return!1;return!0}function Un(r,e,t){let l,s;Me(r,on,p=>t(3,s=p));const n=Ue("i18n");Me(r,n,p=>t(2,l=p));const i=gt();let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let m,g=[];const _=p=>{if(p.length>500)t(1,g=[]);else{const I=p.trim()?m.search(p.trim()).map(k=>k.item):u;Wn(g,I)||t(1,g=I)}},y=p=>i("select",p.content);return r.$$set=p=>{"suggestionPrompts"in p&&t(6,o=p.suggestionPrompts),"className"in p&&t(0,a=p.className),"inputValue"in p&&t(7,f=p.inputValue)},r.$$.update=()=>{r.$$.dirty&192&&o&&(t(8,u=[...o??[]].sort(()=>Math.random()-.5)),_(f)),r.$$.dirty&256&&(m=new Tn(u,c)),r.$$.dirty&128&&_(f)},[a,g,l,s,n,i,o,f,u,y]}class qn extends Be{constructor(e){super(),Se(this,e,Un,zn,Ve,{suggestionPrompts:6,className:0,inputValue:7})}}function Fn(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",r[1]),d(e,"stroke","currentColor"),d(e,"class",r[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&h(e)}}}function Jn(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Gn extends Be{constructor(e){super(),Se(this,e,Jn,Fn,Ve,{className:0,strokeWidth:1})}}function Zn(r){let e,t,l,s,n,i,o,a,f,u,c,m,g,_,y,p,I,k,T,L,B,M,S,O,C,P;return{c(){e=E("div"),t=E("div"),l=E("div"),s=E("div"),i=H(),o=E("div"),a=E("div"),u=H(),c=E("div"),g=H(),_=E("div"),y=E("div"),I=H(),k=E("div"),L=H(),B=E("div"),S=H(),O=E("div"),this.h()},l(R){e=N(R,"DIV",{class:!0});var W=w(e);t=N(W,"DIV",{class:!0});var le=w(t);l=N(le,"DIV",{class:!0});var de=w(l);s=N(de,"DIV",{class:!0}),w(s).forEach(h),i=z(de),o=N(de,"DIV",{class:!0});var te=w(o);a=N(te,"DIV",{class:!0}),w(a).forEach(h),u=z(te),c=N(te,"DIV",{class:!0}),w(c).forEach(h),te.forEach(h),g=z(de),_=N(de,"DIV",{class:!0});var ne=w(_);y=N(ne,"DIV",{class:!0}),w(y).forEach(h),I=z(ne),k=N(ne,"DIV",{class:!0}),w(k).forEach(h),L=z(ne),B=N(ne,"DIV",{class:!0}),w(B).forEach(h),ne.forEach(h),S=z(de),O=N(de,"DIV",{class:!0}),w(O).forEach(h),de.forEach(h),le.forEach(h),W.forEach(h),this.h()},h(){d(s,"class",n=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),d(a,"class",f=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),d(c,"class",m=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),d(o,"class","grid grid-cols-3 gap-4"),d(y,"class",p=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),d(k,"class",T=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),d(B,"class",M=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),d(_,"class","grid grid-cols-4 gap-4"),d(O,"class",C=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),d(l,"class",P=(r[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),d(t,"class","animate-pulse flex w-full"),d(e,"class","w-full mt-2 mb-2")},m(R,W){V(R,e,W),v(e,t),v(t,l),v(l,s),v(l,i),v(l,o),v(o,a),v(o,u),v(o,c),v(l,g),v(l,_),v(_,y),v(_,I),v(_,k),v(_,L),v(_,B),v(l,S),v(l,O)},p(R,[W]){W&1&&n!==(n=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&d(s,"class",n),W&1&&f!==(f=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&d(a,"class",f),W&1&&m!==(m=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&d(c,"class",m),W&1&&p!==(p=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&d(y,"class",p),W&1&&T!==(T=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&d(k,"class",T),W&1&&M!==(M=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&d(B,"class",M),W&1&&C!==(C=(R[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&d(O,"class",C),W&1&&P!==(P=(R[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&d(l,"class",P)},i:ve,o:ve,d(R){R&&h(e)}}}function Kn(r,e,t){let{size:l="md"}=e;return r.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Yt extends Be{constructor(e){super(),Se(this,e,Kn,Zn,Ve,{size:0})}}function wl(r,e,t){const l=r.slice();return l[23]=e[t],l}function yl(r,e,t){const l=r.slice();return l[26]=e[t],l}function Il(r){var s;let e,t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((s=r[7])==null?void 0:s.name)??r[7].id:r[1].selectedModelId})+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(n){e=N(n,"DIV",{class:!0});var i=w(e);l=q(i,t),i.forEach(h),this.h()},h(){d(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(n,i){V(n,e,i),v(e,l)},p(n,i){var o;i&386&&t!==(t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((o=n[7])==null?void 0:o.name)??n[7].id:n[1].selectedModelId})+"")&&Z(l,t)},d(n){n&&h(e)}}}function Ml(r){let e,t=r[26]+"",l,s,n,i,o,a;function f(){return r[12](r[26])}return{c(){e=E("button"),l=U(t),s=H(),this.h()},l(u){e=N(u,"BUTTON",{class:!0});var c=w(e);l=q(c,t),s=z(c),c.forEach(h),this.h()},h(){var u,c;d(e,"class",n="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=r[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?r[26]>5:r[26]<6},m(u,c){V(u,e,c),v(e,l),v(e,s),o||(a=me(e,"click",f),o=!0)},p(u,c){var m,g;r=u,c&64&&n!==(n="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&d(e,"class",n),c&2&&i!==(i=((g=(m=r[1])==null?void 0:m.annotation)==null?void 0:g.rating)===-1?r[26]>5:r[26]<6)&&(e.disabled=i)},d(u){u&&h(e),o=!1,a()}}}function El(r){let e,t=r[8].t("Why?")+"",l,s,n,i=Ee(r[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Nl(wl(r,i,a));return{c(){e=E("div"),l=U(t),s=H(),n=E("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=N(a,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(h),s=z(a),n=N(a,"DIV",{class:!0});var u=w(n);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(h),this.h()},h(){d(e,"class","text-sm mt-1.5 font-medium"),d(n,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){V(a,e,f),v(e,l),V(a,s,f),V(a,n,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(n,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&Z(l,t),f&280){i=Ee(a[3]);let u;for(u=0;u<i.length;u+=1){const c=wl(a,i,u);o[u]?o[u].p(c,f):(o[u]=Nl(c),o[u].c(),o[u].m(n,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(h(e),h(s),h(n)),qe(o,a)}}}function Qn(r){let e=r[23]+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&Z(t,e)},d(l){l&&h(t)}}}function Yn(r){let e=r[8].t("Other")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Xn(r){let e=r[8].t("Being lazy")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&Z(t,e)},d(l){l&&h(t)}}}function $n(r){let e=r[8].t("Refused when it shouldn't have")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&Z(t,e)},d(l){l&&h(t)}}}function xn(r){let e=r[8].t("Didn't fully follow instructions")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ei(r){let e=r[8].t("Not factually correct")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ti(r){let e=r[8].t("Not helpful")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&Z(t,e)},d(l){l&&h(t)}}}function li(r){let e=r[8].t("Too verbose")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&Z(t,e)},d(l){l&&h(t)}}}function si(r){let e=r[8].t("Don't like the style")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ri(r){let e=r[8].t("Thorough explanation")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ni(r){let e=r[8].t("Attention to detail")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ii(r){let e=r[8].t("Positive attitude")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&Z(t,e)},d(l){l&&h(t)}}}function oi(r){let e=r[8].t("Showcased creativity")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&Z(t,e)},d(l){l&&h(t)}}}function ai(r){let e=r[8].t("Followed instructions perfectly")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&Z(t,e)},d(l){l&&h(t)}}}function fi(r){let e=r[8].t("Accurate information")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Nl(r){let e,t,l,s,n;function i(u,c){return u[23]==="accurate_information"?fi:u[23]==="followed_instructions_perfectly"?ai:u[23]==="showcased_creativity"?oi:u[23]==="positive_attitude"?ii:u[23]==="attention_to_detail"?ni:u[23]==="thorough_explanation"?ri:u[23]==="dont_like_the_style"?si:u[23]==="too_verbose"?li:u[23]==="not_helpful"?ti:u[23]==="not_factually_correct"?ei:u[23]==="didnt_fully_follow_instructions"?xn:u[23]==="refused_when_it_shouldnt_have"?$n:u[23]==="being_lazy"?Xn:u[23]==="other"?Yn:Qn}let o=i(r),a=o(r);function f(){return r[13](r[23])}return{c(){e=E("button"),a.c(),t=H(),this.h()},l(u){e=N(u,"BUTTON",{class:!0});var c=w(e);a.l(c),t=z(c),c.forEach(h),this.h()},h(){d(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){V(u,e,c),a.m(e,null),v(e,t),s||(n=me(e,"click",f),s=!0)},p(u,c){r=u,o===(o=i(r))&&a?a.p(r,c):(a.d(1),a=o(r),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&d(e,"class",l)},d(u){u&&h(e),a.d(),s=!1,n()}}}function ui(r){var Y;let e,t,l,s,n=r[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,m,g,_,y,p,I,k=r[8].t("Awful")+"",T,L,B,M,S=r[8].t("Amazing")+"",O,C,P,R,W,le,de,te,ne,ue,he,ke,Q,F=r[8].t("Save")+"",A,fe,ie,ge,ye,_e=((Y=r[1])==null?void 0:Y.arena)&&Il(r),oe=Ee(Array.from({length:10}).map(Dl)),j=[];for(let G=0;G<oe.length;G+=1)j[G]=Ml(yl(r,oe,G));let K=r[3].length>0&&El(r);return he=new yn({props:{tags:r[2]}}),he.$on("delete",r[15]),he.$on("add",r[16]),{c(){_e&&_e.c(),e=H(),t=E("div"),l=E("div"),s=E("div"),i=U(n),o=H(),a=E("button"),a.innerHTML=f,u=H(),c=E("div"),m=E("div"),g=E("div");for(let G=0;G<j.length;G+=1)j[G].c();_=H(),y=E("div"),p=E("div"),I=U("1 - "),T=U(k),L=H(),B=E("div"),M=U("10 - "),O=U(S),C=H(),P=E("div"),K&&K.c(),R=H(),W=E("div"),le=E("textarea"),te=H(),ne=E("div"),ue=E("div"),X(he.$$.fragment),ke=H(),Q=E("button"),A=U(F),this.h()},l(G){_e&&_e.l(G),e=z(G),t=N(G,"DIV",{class:!0,id:!0});var ce=w(t);l=N(ce,"DIV",{class:!0});var we=w(l);s=N(we,"DIV",{class:!0});var Ce=w(s);i=q(Ce,n),Ce.forEach(h),o=z(we),a=N(we,"BUTTON",{"data-svelte-h":!0}),He(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),we.forEach(h),u=z(ce),c=N(ce,"DIV",{class:!0});var Te=w(c);m=N(Te,"DIV",{class:!0});var je=w(m);g=N(je,"DIV",{class:!0});var ze=w(g);for(let st=0;st<j.length;st+=1)j[st].l(ze);ze.forEach(h),_=z(je),y=N(je,"DIV",{class:!0});var Fe=w(y);p=N(Fe,"DIV",{});var tt=w(p);I=q(tt,"1 - "),T=q(tt,k),tt.forEach(h),L=z(Fe),B=N(Fe,"DIV",{});var lt=w(B);M=q(lt,"10 - "),O=q(lt,S),lt.forEach(h),Fe.forEach(h),je.forEach(h),Te.forEach(h),C=z(ce),P=N(ce,"DIV",{});var ot=w(P);K&&K.l(ot),ot.forEach(h),R=z(ce),W=N(ce,"DIV",{class:!0});var at=w(W);le=N(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),w(le).forEach(h),at.forEach(h),te=z(ce),ne=N(ce,"DIV",{class:!0});var xe=w(ne);ue=N(xe,"DIV",{class:!0});var ft=w(ue);$(he.$$.fragment,ft),ft.forEach(h),ke=z(xe),Q=N(xe,"BUTTON",{class:!0});var ut=w(Q);A=q(ut,F),ut.forEach(h),xe.forEach(h),ce.forEach(h),this.h()},h(){d(s,"class","text-sm font-medium"),d(l,"class","flex justify-between items-center"),d(g,"class","mt-1.5 w-fit flex gap-1 pb-5"),d(y,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),d(m,"class","relative w-fit"),d(c,"class","w-full flex justify-center"),d(le,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),d(le,"placeholder",de=r[8].t("Feel free to add specific details")),d(le,"rows","3"),d(W,"class","mt-2"),d(ue,"class","flex items-end group"),d(Q,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(ne,"class","mt-2 gap-1.5 flex justify-between"),d(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),d(t,"id",fe="message-feedback-"+r[1].id)},m(G,ce){_e&&_e.m(G,ce),V(G,e,ce),V(G,t,ce),v(t,l),v(l,s),v(s,i),v(l,o),v(l,a),v(t,u),v(t,c),v(c,m),v(m,g);for(let we=0;we<j.length;we+=1)j[we]&&j[we].m(g,null);v(m,_),v(m,y),v(y,p),v(p,I),v(p,T),v(y,L),v(y,B),v(B,M),v(B,O),v(t,C),v(t,P),K&&K.m(P,null),v(t,R),v(t,W),v(W,le),nt(le,r[5]),v(t,te),v(t,ne),v(ne,ue),x(he,ue,null),v(ne,ke),v(ne,Q),v(Q,A),ie=!0,ge||(ye=[me(a,"click",r[11]),me(le,"input",r[14]),me(Q,"click",r[17])],ge=!0)},p(G,[ce]){var Ce;if((Ce=G[1])!=null&&Ce.arena?_e?_e.p(G,ce):(_e=Il(G),_e.c(),_e.m(e.parentNode,e)):_e&&(_e.d(1),_e=null),(!ie||ce&256)&&n!==(n=G[8].t("How would you rate this response?")+"")&&Z(i,n),ce&66){oe=Ee(Array.from({length:10}).map(Dl));let Te;for(Te=0;Te<oe.length;Te+=1){const je=yl(G,oe,Te);j[Te]?j[Te].p(je,ce):(j[Te]=Ml(je),j[Te].c(),j[Te].m(g,null))}for(;Te<j.length;Te+=1)j[Te].d(1);j.length=oe.length}(!ie||ce&256)&&k!==(k=G[8].t("Awful")+"")&&Z(T,k),(!ie||ce&256)&&S!==(S=G[8].t("Amazing")+"")&&Z(O,S),G[3].length>0?K?K.p(G,ce):(K=El(G),K.c(),K.m(P,null)):K&&(K.d(1),K=null),(!ie||ce&256&&de!==(de=G[8].t("Feel free to add specific details")))&&d(le,"placeholder",de),ce&32&&nt(le,G[5]);const we={};ce&4&&(we.tags=G[2]),he.$set(we),(!ie||ce&256)&&F!==(F=G[8].t("Save")+"")&&Z(A,F),(!ie||ce&2&&fe!==(fe="message-feedback-"+G[1].id))&&d(t,"id",fe)},i(G){ie||(b(he.$$.fragment,G),ie=!0)},o(G){D(he.$$.fragment,G),ie=!1},d(G){G&&(h(e),h(t)),_e&&_e.d(G),qe(j,G),K&&K.d(),ee(he),ge=!1,et(ye)}}}const Dl=(r,e)=>e+1;function ci(r,e,t){let l,s;Me(r,jt,P=>t(18,s=P));const n=Ue("i18n");Me(r,n,P=>t(8,l=P));const i=gt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],m=[],g=null,_="",y=null,p=null;const I=()=>{var P,R,W,le,de;g||t(4,g=((P=o==null?void 0:o.annotation)==null?void 0:P.reason)??""),_||t(5,_=((R=o==null?void 0:o.annotation)==null?void 0:R.comment)??""),t(2,c=(((W=o==null?void 0:o.annotation)==null?void 0:W.tags)??[]).map(te=>({name:te}))),y||t(6,y=((de=(le=o==null?void 0:o.annotation)==null?void 0:le.details)==null?void 0:de.rating)??null)};bt(()=>{o!=null&&o.arena&&(t(7,p=s.find(P=>P.id===o.selectedModelId)),Pe.success(l.t('This response was generated by "{{model}}"',{model:p?(p==null?void 0:p.name)??p.id:o.selectedModelId})))});const k=()=>{console.log("saveHandler"),i("save",{reason:g,comment:_,tags:c.map(P=>P.name),details:{rating:y}}),Pe.success(l.t("Thanks for your feedback!")),t(0,a=!1)},T=()=>{t(0,a=!1)},L=P=>{t(6,y=P)},B=P=>{t(4,g=P)};function M(){_=this.value,t(5,_)}const S=P=>{t(2,c=c.filter(R=>R.name.replaceAll(" ","_").toLowerCase()!==P.detail.replaceAll(" ","_").toLowerCase()))},O=P=>{t(2,c=[...c,{name:P.detail}])},C=()=>{k()};return r.$$set=P=>{"message"in P&&t(1,o=P.message),"show"in P&&t(0,a=P.show)},r.$$.update=()=>{var P,R;r.$$.dirty&2&&(((P=o==null?void 0:o.annotation)==null?void 0:P.rating)===1?t(3,m=f):((R=o==null?void 0:o.annotation)==null?void 0:R.rating)===-1&&t(3,m=u)),r.$$.dirty&2&&o&&I()},[a,o,c,m,g,_,y,p,l,n,k,T,L,B,M,S,O,C]}class di extends Be{constructor(e){super(),Se(this,e,ci,ui,Ve,{message:1,show:0})}}function Vl(r,e,t){const l=r.slice();return l[5]=e[t],l[7]=t,l}function hi(r){let e,t;return e=new Cr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function mi(r){let e,t;return e=new Tr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function gi(r){let e,t,l,s,n;const i=r[2].default,o=$r(i,r,r[4],null),a=[mi,hi],f=[];function u(c,m){return c[1]?0:1}return l=u(r),s=f[l]=a[l](r),{c(){e=E("div"),o&&o.c(),t=H(),s.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var m=w(e);o&&o.l(m),t=z(m),s.l(m),m.forEach(h),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,m){V(c,e,m),o&&o.m(e,null),v(e,t),f[l].m(e,null),n=!0},p(c,m){o&&o.p&&(!n||m&16)&&xr(o,i,c,c[4],n?tn(i,c[4],m,null):en(c[4]),null);let g=l;l=u(c),l!==g&&(se(),D(f[g],1,1,()=>{f[g]=null}),re(),s=f[l],s||(s=f[l]=a[l](c),s.c()),b(s,1),s.m(e,null))},i(c){n||(b(o,c),b(s),n=!0)},o(c){D(o,c),D(s),n=!1},d(c){c&&h(e),o&&o.d(c),f[l].d()}}}function Cl(r){let e,t,l,s,n,i=r[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,m;return l=new In({}),{c(){e=E("a"),t=E("div"),X(l.$$.fragment),s=H(),n=E("div"),o=U(i),a=H(),f=E("div"),f.innerHTML=u,this.h()},l(g){e=N(g,"A",{href:!0,target:!0,class:!0});var _=w(e);t=N(_,"DIV",{class:!0});var y=w(t);$(l.$$.fragment,y),s=z(y),n=N(y,"DIV",{class:!0});var p=w(n);o=q(p,i),p.forEach(h),y.forEach(h),a=z(_),f=N(_,"DIV",{class:!0,"data-svelte-h":!0}),He(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(h),this.h()},h(){d(n,"class","line-clamp-1"),d(t,"class","flex gap-2 items-center"),d(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",c="https://www.google.com/search?q="+r[0].query),d(e,"target","_blank"),d(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(g,_){V(g,e,_),v(e,t),x(l,t,null),v(t,s),v(t,n),v(n,o),v(e,a),v(e,f),m=!0},p(g,_){(!m||_&1)&&i!==(i=g[0].query+"")&&Z(o,i),(!m||_&1&&c!==(c="https://www.google.com/search?q="+g[0].query))&&d(e,"href",c)},i(g){m||(b(l.$$.fragment,g),m=!0)},o(g){D(l.$$.fragment,g),m=!1},d(g){g&&h(e),ee(l)}}}function Tl(r){let e,t,l=r[5]+"",s,n,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=E("a"),t=E("div"),s=U(l),n=H(),i=E("div"),i.innerHTML=o,a=H(),this.h()},l(c){e=N(c,"A",{href:!0,target:!0,class:!0});var m=w(e);t=N(m,"DIV",{class:!0});var g=w(t);s=q(g,l),g.forEach(h),n=z(m),i=N(m,"DIV",{class:!0,"data-svelte-h":!0}),He(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=z(m),m.forEach(h),this.h()},h(){d(t,"class","line-clamp-1"),d(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),d(e,"href",f=r[5]),d(e,"target","_blank"),d(e,"class",u="flex w-full items-center p-3 px-4 "+(r[7]===r[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,m){V(c,e,m),v(e,t),v(t,s),v(e,n),v(e,i),v(e,a)},p(c,m){m&1&&l!==(l=c[5]+"")&&Z(s,l),m&1&&f!==(f=c[5])&&d(e,"href",f),m&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&d(e,"class",u)},d(c){c&&h(e)}}}function _i(r){var o;let e,t,l,s=((o=r[0])==null?void 0:o.query)&&Cl(r),n=Ee(r[0].urls),i=[];for(let a=0;a<n.length;a+=1)i[a]=Tl(Vl(r,n,a));return{c(){e=E("div"),s&&s.c(),t=H();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=N(a,"DIV",{class:!0,slot:!0});var f=w(e);s&&s.l(f),t=z(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(h),this.h()},h(){d(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),d(e,"slot","content")},m(a,f){V(a,e,f),s&&s.m(e,null),v(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&b(s,1)):(s=Cl(a),s.c(),b(s,1),s.m(e,t)):s&&(se(),D(s,1,1,()=>{s=null}),re()),f&1){n=Ee(a[0].urls);let c;for(c=0;c<n.length;c+=1){const m=Vl(a,n,c);i[c]?i[c].p(m,f):(i[c]=Tl(m),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=n.length}},i(a){l||(b(s),l=!0)},o(a){D(s),l=!1},d(a){a&&h(e),s&&s.d(),qe(i,a)}}}function vi(r){let e,t,l;function s(i){r[3](i)}let n={className:"w-full space-y-1",$$slots:{content:[_i],default:[gi]},$$scope:{ctx:r}};return r[1]!==void 0&&(n.open=r[1]),e=new Br({props:n}),Ae.push(()=>Ke(e,"open",s)),{c(){X(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function pi(r,e,t){let{$$slots:l={},$$scope:s}=e,{status:n={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return r.$$set=a=>{"status"in a&&t(0,n=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[n,i,l,o,s]}class bi extends Be{constructor(e){super(),Se(this,e,pi,vi,Ve,{status:0})}}function ki(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",r[1]),d(e,"stroke","currentColor"),d(e,"class",r[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&h(e)}}}function wi(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class yi extends Be{constructor(e){super(),Se(this,e,wi,ki,Ve,{className:0,strokeWidth:1})}}function Ii(r){let e,t,l,s,n,i=(typeof r[0]=="string"?r[0]:JSON.stringify(r[0]))+"",o,a;return l=new Mn({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=E("div"),t=E("div"),X(l.$$.fragment),s=H(),n=E("div"),o=U(i),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=w(e);t=N(u,"DIV",{class:!0});var c=w(t);$(l.$$.fragment,c),c.forEach(h),s=z(u),n=N(u,"DIV",{class:!0});var m=w(n);o=q(m,i),m.forEach(h),u.forEach(h),this.h()},h(){d(t,"class","self-start mt-0.5"),d(n,"class","self-center text-sm"),d(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),v(e,t),x(l,t,null),v(e,s),v(e,n),v(n,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&Z(o,i)},i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){D(l.$$.fragment,f),a=!1},d(f){f&&h(e),ee(l)}}}function Mi(r,e,t){let{content:l=""}=e;return r.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let Ei=class extends Be{constructor(e){super(),Se(this,e,Mi,Ii,Ve,{content:0})}};function Bl(r,e,t){const l=r.slice();return l[9]=e[t],l[11]=t,l}function Ni(r){const e=r.slice(),t=ji(e[9].distance);return e[12]=t,e}function Di(r){let e,t=r[4].t("No source available")+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No source available")+"")&&Z(l,t)},i:ve,o:ve,d(s){s&&h(e)}}}function Vi(r){let e,t,l,s;e=new Re({props:{className:"w-fit",content:r[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ci]},$$scope:{ctx:r}}});let n=r[2]&&Rl(r);return{c(){X(e.$$.fragment),t=H(),n&&n.c(),l=ae()},l(i){$(e.$$.fragment,i),t=z(i),n&&n.l(i),l=ae()},m(i,o){x(e,i,o),V(i,t,o),n&&n.m(i,o),V(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&8216&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?n?(n.p(i,o),o&4&&b(n,1)):(n=Rl(i),n.c(),b(n,1),n.m(l.parentNode,l)):n&&(se(),D(n,1,1,()=>{n=null}),re())},i(i){s||(b(e.$$.fragment,i),b(n),s=!0)},o(i){D(e.$$.fragment,i),D(n),s=!1},d(i){i&&(h(t),h(l)),ee(e,i),n&&n.d(i)}}}function Sl(r){let e,t,l=r[4].t("page")+"",s,n,i=r[9].metadata.page+1+"",o,a;return{c(){e=E("span"),t=U("("),s=U(l),n=H(),o=U(i),a=U(")"),this.h()},l(f){e=N(f,"SPAN",{class:!0});var u=w(e);t=q(u,"("),s=q(u,l),n=z(u),o=q(u,i),a=q(u,")"),u.forEach(h),this.h()},h(){d(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),v(e,t),v(e,s),v(e,n),v(e,o),v(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&Z(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&Z(o,i)},d(f){f&&h(e)}}}function Ci(r){var a,f,u,c;let e,t,l=(((f=(a=r[9])==null?void 0:a.metadata)==null?void 0:f.name)??r[9].source.name)+"",s,n,i,o=((c=(u=r[9])==null?void 0:u.metadata)==null?void 0:c.page)&&Sl(r);return{c(){e=E("div"),t=E("a"),s=U(l),i=H(),o&&o.c(),this.h()},l(m){e=N(m,"DIV",{class:!0});var g=w(e);t=N(g,"A",{class:!0,href:!0,target:!0});var _=w(t);s=q(_,l),_.forEach(h),i=z(g),o&&o.l(g),g.forEach(h),this.h()},h(){var m,g,_,y,p,I,k,T;d(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),d(t,"href",n=(g=(m=r[9])==null?void 0:m.metadata)!=null&&g.file_id?`${dl}/files/${(y=(_=r[9])==null?void 0:_.metadata)==null?void 0:y.file_id}/content${((I=(p=r[9])==null?void 0:p.metadata)==null?void 0:I.page)!==void 0?`#page=${r[9].metadata.page+1}`:""}`:(T=(k=r[9].source)==null?void 0:k.url)!=null&&T.includes("http")?r[9].source.url:"#"),d(t,"target","_blank"),d(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(m,g){V(m,e,g),v(e,t),v(t,s),v(e,i),o&&o.m(e,null)},p(m,g){var _,y,p,I,k,T,L,B,M,S,O,C;g&8&&l!==(l=(((y=(_=m[9])==null?void 0:_.metadata)==null?void 0:y.name)??m[9].source.name)+"")&&Z(s,l),g&8&&n!==(n=(I=(p=m[9])==null?void 0:p.metadata)!=null&&I.file_id?`${dl}/files/${(T=(k=m[9])==null?void 0:k.metadata)==null?void 0:T.file_id}/content${((B=(L=m[9])==null?void 0:L.metadata)==null?void 0:B.page)!==void 0?`#page=${m[9].metadata.page+1}`:""}`:(S=(M=m[9].source)==null?void 0:M.url)!=null&&S.includes("http")?m[9].source.url:"#")&&d(t,"href",n),(C=(O=m[9])==null?void 0:O.metadata)!=null&&C.page?o?o.p(m,g):(o=Sl(m),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(m){m&&h(e),o&&o.d()}}}function Rl(r){let e,t=r[4].t("Relevance")+"",l,s,n,i,o,a;const f=[Bi,Ti],u=[];function c(m,g){return m[9].distance!==void 0?0:1}return n=c(r),i=u[n]=f[n](r),{c(){e=E("div"),l=U(t),s=H(),i.c(),o=ae(),this.h()},l(m){e=N(m,"DIV",{class:!0});var g=w(e);l=q(g,t),g.forEach(h),s=z(m),i.l(m),o=ae(),this.h()},h(){d(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(m,g){V(m,e,g),v(e,l),V(m,s,g),u[n].m(m,g),V(m,o,g),a=!0},p(m,g){(!a||g&16)&&t!==(t=m[4].t("Relevance")+"")&&Z(l,t);let _=n;n=c(m),n===_?u[n].p(m,g):(se(),D(u[_],1,1,()=>{u[_]=null}),re(),i=u[n],i?i.p(m,g):(i=u[n]=f[n](m),i.c()),b(i,1),i.m(o.parentNode,o))},i(m){a||(b(i),a=!0)},o(m){D(i),a=!1},d(m){m&&(h(e),h(s),h(o)),u[n].d(m)}}}function Ti(r){let e,t=r[4].t("No distance available")+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","text-sm dark:text-gray-400")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No distance available")+"")&&Z(l,t)},i:ve,o:ve,d(s){s&&h(e)}}}function Bi(r){let e,t;return e=new Re({props:{className:"w-fit",content:r[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ri]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s&16&&(n.content=l[4].t("Semantic distance to query")),s&8202&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Si(r){let e,t=r[9].distance.toFixed(4)+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","text-gray-500 dark:text-gray-500")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n&8&&t!==(t=s[9].distance.toFixed(4)+"")&&Z(l,t)},d(s){s&&h(e)}}}function Ol(r){let e,t=r[12].toFixed(2)+"",l,s,n,i,o,a,f=r[9].distance.toFixed(4)+"",u,c;return{c(){e=E("span"),l=U(t),s=U("%"),i=H(),o=E("span"),a=U("("),u=U(f),c=U(")"),this.h()},l(m){e=N(m,"SPAN",{class:!0});var g=w(e);l=q(g,t),s=q(g,"%"),g.forEach(h),i=z(m),o=N(m,"SPAN",{class:!0});var _=w(o);a=q(_,"("),u=q(_,f),c=q(_,")"),_.forEach(h),this.h()},h(){d(e,"class",n=`px-1 rounded-sm font-medium ${Al(r[12])}`),d(o,"class","text-gray-500 dark:text-gray-500")},m(m,g){V(m,e,g),v(e,l),v(e,s),V(m,i,g),V(m,o,g),v(o,a),v(o,u),v(o,c)},p(m,g){g&8&&t!==(t=m[12].toFixed(2)+"")&&Z(l,t),g&8&&n!==(n=`px-1 rounded-sm font-medium ${Al(m[12])}`)&&d(e,"class",n),g&8&&f!==(f=m[9].distance.toFixed(4)+"")&&Z(u,f)},d(m){m&&(h(e),h(i),h(o))}}}function Ri(r){let e;function t(i,o){return i[1]?Ol:Si}function l(i,o){return o===Ol?Ni(i):i}let s=t(r),n=s(l(r,s));return{c(){e=E("div"),n.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=w(e);n.l(o),o.forEach(h),this.h()},h(){d(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){V(i,e,o),n.m(e,null)},p(i,o){s===(s=t(i))&&n?n.p(l(i,s),o):(n.d(1),n=s(l(i,s)),n&&(n.c(),n.m(e,null)))},d(i){i&&h(e),n.d()}}}function Oi(r){let e,t,l=r[9].document+"",s,n;return{c(){e=E("pre"),t=U("                "),s=U(l),n=U(`\r
              `),this.h()},l(i){e=N(i,"PRE",{class:!0});var o=w(e);t=q(o,"                "),s=q(o,l),n=q(o,`\r
              `),o.forEach(h),this.h()},h(){d(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){V(i,e,o),v(e,t),v(e,s),v(e,n)},p(i,o){o&8&&l!==(l=i[9].document+"")&&Z(s,l)},d(i){i&&h(e)}}}function Li(r){let e,t,l;return{c(){e=E("iframe"),this.h()},l(s){e=N(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),w(e).forEach(h),this.h()},h(){d(e,"class","w-full border-0 h-auto rounded-none"),d(e,"sandbox","allow-scripts allow-forms allow-same-origin"),d(e,"srcdoc",t=r[9].document),d(e,"title",l=r[4].t("Content"))},m(s,n){V(s,e,n)},p(s,n){n&8&&t!==(t=s[9].document)&&d(e,"srcdoc",t),n&16&&l!==(l=s[4].t("Content"))&&d(e,"title",l)},d(s){s&&h(e)}}}function Ll(r){let e;return{c(){e=E("hr"),this.h()},l(t){e=N(t,"HR",{class:!0}),this.h()},h(){d(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&h(e)}}}function Pl(r){let e,t,l=r[4].t("Source")+"",s,n,i,o,a,f,u,c=r[4].t("Content")+"",m,g,_,y,p;const I=[Vi,Di],k=[];function T(O,C){var P;return(P=O[9].source)!=null&&P.name?0:1}i=T(r),o=k[i]=I[i](r);function L(O,C){var P;return(P=O[9].metadata)!=null&&P.html?Li:Oi}let B=L(r),M=B(r),S=r[11]!==r[3].length-1&&Ll();return{c(){e=E("div"),t=E("div"),s=U(l),n=H(),o.c(),a=H(),f=E("div"),u=E("div"),m=U(c),g=H(),M.c(),_=H(),S&&S.c(),y=ae(),this.h()},l(O){e=N(O,"DIV",{class:!0});var C=w(e);t=N(C,"DIV",{class:!0});var P=w(t);s=q(P,l),P.forEach(h),n=z(C),o.l(C),C.forEach(h),a=z(O),f=N(O,"DIV",{class:!0});var R=w(f);u=N(R,"DIV",{class:!0});var W=w(u);m=q(W,c),W.forEach(h),g=z(R),M.l(R),R.forEach(h),_=z(O),S&&S.l(O),y=ae(),this.h()},h(){d(t,"class","text-sm font-medium dark:text-gray-300"),d(e,"class","flex flex-col w-full"),d(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),d(f,"class","flex flex-col w-full")},m(O,C){V(O,e,C),v(e,t),v(t,s),v(e,n),k[i].m(e,null),V(O,a,C),V(O,f,C),v(f,u),v(u,m),v(f,g),M.m(f,null),V(O,_,C),S&&S.m(O,C),V(O,y,C),p=!0},p(O,C){(!p||C&16)&&l!==(l=O[4].t("Source")+"")&&Z(s,l);let P=i;i=T(O),i===P?k[i].p(O,C):(se(),D(k[P],1,1,()=>{k[P]=null}),re(),o=k[i],o?o.p(O,C):(o=k[i]=I[i](O),o.c()),b(o,1),o.m(e,null)),(!p||C&16)&&c!==(c=O[4].t("Content")+"")&&Z(m,c),B===(B=L(O))&&M?M.p(O,C):(M.d(1),M=B(O),M&&(M.c(),M.m(f,null))),O[11]!==O[3].length-1?S||(S=Ll(),S.c(),S.m(y.parentNode,y)):S&&(S.d(1),S=null)},i(O){p||(b(o),p=!0)},o(O){D(o),p=!1},d(O){O&&(h(e),h(a),h(f),h(_),h(y)),k[i].d(),M.d(),S&&S.d(O)}}}function Pi(r){let e,t,l,s=r[4].t("Citation")+"",n,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,m,g,_,y=Ee(r[3]),p=[];for(let k=0;k<y.length;k+=1)p[k]=Pl(Bl(r,y,k));const I=k=>D(p[k],1,1,()=>{p[k]=null});return{c(){e=E("div"),t=E("div"),l=E("div"),n=U(s),i=H(),o=E("button"),o.innerHTML=a,f=H(),u=E("div"),c=E("div");for(let k=0;k<p.length;k+=1)p[k].c();this.h()},l(k){e=N(k,"DIV",{});var T=w(e);t=N(T,"DIV",{class:!0});var L=w(t);l=N(L,"DIV",{class:!0});var B=w(l);n=q(B,s),B.forEach(h),i=z(L),o=N(L,"BUTTON",{class:!0,"data-svelte-h":!0}),He(o)!=="svelte-745w2y"&&(o.innerHTML=a),L.forEach(h),f=z(T),u=N(T,"DIV",{class:!0});var M=w(u);c=N(M,"DIV",{class:!0});var S=w(c);for(let O=0;O<p.length;O+=1)p[O].l(S);S.forEach(h),M.forEach(h),T.forEach(h),this.h()},h(){d(l,"class","text-lg font-medium self-center capitalize"),d(o,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(k,T){V(k,e,T),v(e,t),v(t,l),v(l,n),v(t,i),v(t,o),v(e,f),v(e,u),v(u,c);for(let L=0;L<p.length;L+=1)p[L]&&p[L].m(c,null);m=!0,g||(_=me(o,"click",r[7]),g=!0)},p(k,T){if((!m||T&16)&&s!==(s=k[4].t("Citation")+"")&&Z(n,s),T&30){y=Ee(k[3]);let L;for(L=0;L<y.length;L+=1){const B=Bl(k,y,L);p[L]?(p[L].p(B,T),b(p[L],1)):(p[L]=Pl(B),p[L].c(),b(p[L],1),p[L].m(c,null))}for(se(),L=y.length;L<p.length;L+=1)I(L);re()}},i(k){if(!m){for(let T=0;T<y.length;T+=1)b(p[T]);m=!0}},o(k){p=p.filter(Boolean);for(let T=0;T<p.length;T+=1)D(p[T]);m=!1},d(k){k&&h(e),qe(p,k),g=!1,_()}}}function Ai(r){let e,t,l;function s(i){r[8](i)}let n={size:"lg",$$slots:{default:[Pi]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new Rr({props:n}),Ae.push(()=>Ke(e,"show",s)),{c(){X(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,[o]){const a={};o&8223&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function ji(r){return r<0?0:r>1?100:Math.round(r*1e4)/100}function Al(r){return r>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":r>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":r>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Hi(r,e,t){let l;const s=Ue("i18n");Me(r,s,m=>t(4,l=m));let{show:n=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=()=>{t(0,n=!1)};function c(m){n=m,t(0,n)}return r.$$set=m=>{"show"in m&&t(0,n=m.show),"citation"in m&&t(6,i=m.citation),"showPercentage"in m&&t(1,o=m.showPercentage),"showRelevance"in m&&t(2,a=m.showRelevance)},r.$$.update=()=>{var m;r.$$.dirty&72&&i&&(t(3,f=(m=i.document)==null?void 0:m.map((g,_)=>{var y,p;return{source:i.source,document:g,metadata:(y=i.metadata)==null?void 0:y[_],distance:(p=i.distances)==null?void 0:p[_]}})),f.every(g=>g.distance!==void 0)&&t(3,f=f.sort((g,_)=>(_.distance??1/0)-(g.distance??1/0))))},[n,o,a,f,l,s,i,u,c]}class zi extends Be{constructor(e){super(),Se(this,e,Hi,Ai,Ve,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function jl(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function Hl(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function zl(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function Wl(r){let e,t,l,s;const n=[Ui,Wi],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(r),l=i[t]=n[t](r),{c(){e=E("div"),l.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=w(e);l.l(f),f.forEach(h),this.h()},h(){d(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),re(),l=i[t],l?l.p(a,f):(l=i[t]=n[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&h(e),i[t].d()}}}function Wi(r){let e,t,l;function s(i){r[17](i)}let n={id:"collapsible-sources",className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Gi],default:[Ji]},$$scope:{ctx:r}};return r[6]!==void 0&&(n.open=r[6]),e=new Br({props:n}),Ae.push(()=>Ke(e,"open",s)),{c(){X(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,o){const a={};o&8388851&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function Ui(r){let e,t=Ee(r[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Zl(zl(r,t,s));return{c(){e=E("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);for(let i=0;i<l.length;i+=1)l[i].l(n);n.forEach(h),this.h()},h(){d(e,"class","flex text-xs font-medium flex-wrap")},m(s,n){V(s,e,n);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,n){if(n&51){t=Ee(s[1]);let i;for(i=0;i<t.length;i+=1){const o=zl(s,t,i);l[i]?l[i].p(o,n):(l[i]=Zl(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&h(e),qe(l,s)}}}function Ul(r){let e,t=r[20]+1+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){V(s,e,n),v(e,l)},d(s){s&&h(e)}}}function ql(r){let e,t=r[1].every(r[12]),l,s,n=r[18].source.name+"",i,o,a,f,u=t&&Ul(r);function c(){return r[16](r[18])}return{c(){e=E("button"),u&&u.c(),l=H(),s=E("div"),i=U(n),o=H(),this.h()},l(m){e=N(m,"BUTTON",{class:!0});var g=w(e);u&&u.l(g),l=z(g),s=N(g,"DIV",{class:!0});var _=w(s);i=q(_,n),_.forEach(h),o=z(g),g.forEach(h),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(m,g){V(m,e,g),u&&u.m(e,null),v(e,l),v(e,s),v(s,i),v(e,o),a||(f=[me(e,"click",c),me(e,"pointerup",Yi)],a=!0)},p(m,g){r=m,g&2&&(t=r[1].every(r[12])),t?u||(u=Ul(r),u.c(),u.m(e,l)):u&&(u.d(1),u=null),g&2&&n!==(n=r[18].source.name+"")&&Z(i,n)},d(m){m&&h(e),u&&u.d(),a=!1,et(f)}}}function qi(r){let e,t;return e=new Cr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Fi(r){let e,t;return e=new Tr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ji(r){let e,t,l,s=r[7].t("References from")+"",n,i,o,a,f,u,c,m=r[7].t("and")+"",g,_,y=r[1].length-2+"",p,I,k,T=r[7].t("more")+"",L,B,M,S,O,C,P=Ee(r[1].slice(0,2)),R=[];for(let te=0;te<P.length;te+=1)R[te]=ql(jl(r,P,te));const W=[Fi,qi],le=[];function de(te,ne){return te[6]?0:1}return S=de(r),O=le[S]=W[S](r),{c(){e=E("div"),t=E("div"),l=E("span"),n=U(s),i=H(),o=E("div"),a=E("div");for(let te=0;te<R.length;te+=1)R[te].c();f=H(),u=E("div"),c=E("span"),g=U(m),_=H(),p=U(y),I=H(),k=E("span"),L=U(T),B=H(),M=E("div"),O.c(),this.h()},l(te){e=N(te,"DIV",{class:!0});var ne=w(e);t=N(ne,"DIV",{class:!0});var ue=w(t);l=N(ue,"SPAN",{class:!0});var he=w(l);n=q(he,s),he.forEach(h),i=z(ue),o=N(ue,"DIV",{class:!0});var ke=w(o);a=N(ke,"DIV",{class:!0});var Q=w(a);for(let ge=0;ge<R.length;ge+=1)R[ge].l(Q);Q.forEach(h),ke.forEach(h),f=z(ue),u=N(ue,"DIV",{class:!0});var F=w(u);c=N(F,"SPAN",{class:!0});var A=w(c);g=q(A,m),A.forEach(h),_=z(F),p=q(F,y),I=z(F),k=N(F,"SPAN",{});var fe=w(k);L=q(fe,T),fe.forEach(h),F.forEach(h),ue.forEach(h),B=z(ne),M=N(ne,"DIV",{class:!0});var ie=w(M);O.l(ie),ie.forEach(h),ne.forEach(h),this.h()},h(){d(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),d(a,"class","flex text-xs font-medium items-center"),d(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),d(c,"class","hidden sm:inline"),d(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),d(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),d(M,"class","shrink-0"),d(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(te,ne){V(te,e,ne),v(e,t),v(t,l),v(l,n),v(t,i),v(t,o),v(o,a);for(let ue=0;ue<R.length;ue+=1)R[ue]&&R[ue].m(a,null);v(t,f),v(t,u),v(u,c),v(c,g),v(u,_),v(u,p),v(u,I),v(u,k),v(k,L),v(e,B),v(e,M),le[S].m(M,null),C=!0},p(te,ne){if((!C||ne&128)&&s!==(s=te[7].t("References from")+"")&&Z(n,s),ne&50){P=Ee(te[1].slice(0,2));let he;for(he=0;he<P.length;he+=1){const ke=jl(te,P,he);R[he]?R[he].p(ke,ne):(R[he]=ql(ke),R[he].c(),R[he].m(a,null))}for(;he<R.length;he+=1)R[he].d(1);R.length=P.length}(!C||ne&128)&&m!==(m=te[7].t("and")+"")&&Z(g,m),(!C||ne&2)&&y!==(y=te[1].length-2+"")&&Z(p,y),(!C||ne&128)&&T!==(T=te[7].t("more")+"")&&Z(L,T);let ue=S;S=de(te),S!==ue&&(se(),D(le[ue],1,1,()=>{le[ue]=null}),re(),O=le[S],O||(O=le[S]=W[S](te),O.c()),b(O,1),O.m(M,null))},i(te){C||(b(O),C=!0)},o(te){D(O),C=!1},d(te){te&&h(e),qe(R,te),le[S].d()}}}function Fl(r){let e,t=r[20]+1+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){V(s,e,n),v(e,l)},d(s){s&&h(e)}}}function Jl(r){let e,t=r[1].every(r[11]),l,s,n=r[18].source.name+"",i,o,a,f,u,c=t&&Fl(r);function m(){return r[15](r[18])}return{c(){e=E("button"),c&&c.c(),l=H(),s=E("div"),i=U(n),o=H(),this.h()},l(g){e=N(g,"BUTTON",{id:!0,class:!0});var _=w(e);c&&c.l(_),l=z(_),s=N(_,"DIV",{class:!0});var y=w(s);i=q(y,n),y.forEach(h),o=z(_),_.forEach(h),this.h()},h(){d(s,"class","flex-1 mx-1 truncate"),d(e,"id",a=`source-${r[0]}-${r[20]}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,_){V(g,e,_),c&&c.m(e,null),v(e,l),v(e,s),v(s,i),v(e,o),f||(u=me(e,"click",m),f=!0)},p(g,_){r=g,_&2&&(t=r[1].every(r[11])),t?c||(c=Fl(r),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&n!==(n=r[18].source.name+"")&&Z(i,n),_&1&&a!==(a=`source-${r[0]}-${r[20]}`)&&d(e,"id",a)},d(g){g&&h(e),c&&c.d(),f=!1,u()}}}function Gi(r){let e,t,l=Ee(r[1]),s=[];for(let n=0;n<l.length;n+=1)s[n]=Jl(Hl(r,l,n));return{c(){e=E("div"),t=E("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=N(n,"DIV",{slot:!0});var i=w(e);t=N(i,"DIV",{class:!0});var o=w(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),i.forEach(h),this.h()},h(){d(t,"class","flex text-xs font-medium flex-wrap"),d(e,"slot","content")},m(n,i){V(n,e,i),v(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(n,i){if(i&51){l=Ee(n[1]);let o;for(o=0;o<l.length;o+=1){const a=Hl(n,l,o);s[o]?s[o].p(a,i):(s[o]=Jl(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(n){n&&h(e),qe(s,n)}}}function Gl(r){let e,t=r[20]+1+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){V(s,e,n),v(e,l)},d(s){s&&h(e)}}}function Zl(r){let e,t=r[1].every(r[10]),l,s,n=r[18].source.name+"",i,o,a,f,u,c=t&&Gl(r);function m(){return r[14](r[18])}return{c(){e=E("button"),c&&c.c(),l=H(),s=E("div"),i=U(n),o=H(),this.h()},l(g){e=N(g,"BUTTON",{id:!0,class:!0});var _=w(e);c&&c.l(_),l=z(_),s=N(_,"DIV",{class:!0});var y=w(s);i=q(y,n),y.forEach(h),o=z(_),_.forEach(h),this.h()},h(){d(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),d(e,"id",a=`source-${r[0]}-${r[20]}`),d(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(g,_){V(g,e,_),c&&c.m(e,null),v(e,l),v(e,s),v(s,i),v(e,o),f||(u=me(e,"click",m),f=!0)},p(g,_){r=g,_&2&&(t=r[1].every(r[10])),t?c||(c=Gl(r),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&n!==(n=r[18].source.name+"")&&Z(i,n),_&1&&a!==(a=`source-${r[0]}-${r[20]}`)&&d(e,"id",a)},d(g){g&&h(e),c&&c.d(),f=!1,u()}}}function Zi(r){let e,t,l,s,n;function i(f){r[13](f)}let o={citation:r[5],showPercentage:r[2],showRelevance:r[3]};r[4]!==void 0&&(o.show=r[4]),e=new zi({props:o}),Ae.push(()=>Ke(e,"show",i));let a=r[1].length>0&&Wl(r);return{c(){X(e.$$.fragment),l=H(),a&&a.c(),s=ae()},l(f){$(e.$$.fragment,f),l=z(f),a&&a.l(f),s=ae()},m(f,u){x(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),n=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Ze(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&b(a,1)):(a=Wl(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(se(),D(a,1,1,()=>{a=null}),re())},i(f){n||(b(e.$$.fragment,f),b(a),n=!0)},o(f){D(e.$$.fragment,f),D(a),n=!1},d(f){f&&(h(l),h(s)),ee(e,f),a&&a.d(f)}}}function Ki(r){const e=r.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Qi(r){return r.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Yi=r=>{r.stopPropagation()};function Xi(r,e,t){let l;const s=Ue("i18n");Me(r,s,B=>t(7,l=B));let{id:n=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,m=!1;const g=B=>B.distances!==void 0,_=B=>B.distances!==void 0,y=B=>B.distances!==void 0;function p(B){u=B,t(4,u)}const I=B=>{t(4,u=!0),t(5,c=B)},k=B=>{t(4,u=!0),t(5,c=B)},T=B=>{t(4,u=!0),t(5,c=B)};function L(B){m=B,t(6,m)}return r.$$set=B=>{"id"in B&&t(0,n=B.id),"sources"in B&&t(9,i=B.sources)},r.$$.update=()=>{r.$$.dirty&514&&(console.log("sources",i),t(1,o=i.reduce((B,M)=>(Object.keys(M).length===0||M.document.forEach((S,O)=>{var de,te,ne;const C=(de=M.metadata)==null?void 0:de[O],P=(te=M.distances)==null?void 0:te[O],R=(C==null?void 0:C.source)??((ne=M==null?void 0:M.source)==null?void 0:ne.id)??"N/A";let W=M==null?void 0:M.source;C!=null&&C.name&&(W={...W,name:C.name}),(R.startsWith("http://")||R.startsWith("https://"))&&(W={...W,name:R,url:R});const le=B.find(ue=>ue.id===R);le?(le.document.push(S),le.metadata.push(C),P!==void 0&&le.distances.push(P)):B.push({id:R,source:W,document:[S],metadata:C?[C]:[],distances:P!==void 0?[P]:void 0})}),B),[])),t(3,f=Ki(o)),t(2,a=Qi(o)))},[n,o,a,f,u,c,m,l,s,i,g,_,y,p,I,k,T,L]}class $i extends Be{constructor(e){super(),Se(this,e,Xi,Zi,Ve,{id:0,sources:9})}}function Kl(r,e,t){const l=r.slice();return l[6]=e[t],l}function Ql(r){let e,t,l,s;const n=[to,eo,xi],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(r),l=i[t]=n[t](r),{c(){e=E("div"),l.c()},l(a){e=N(a,"DIV",{});var f=w(e);l.l(f),f.forEach(h)},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),re(),l=i[t],l||(l=i[t]=n[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&h(e),i[t].d()}}}function xi(r){let e,t;return e=new Qt({props:{type:"warning",content:"incomplete"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function eo(r){let e,t;return e=new Qt({props:{type:"success",content:"success"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function to(r){let e,t;return e=new Qt({props:{type:"error",content:"error"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Yl(r){let e,t,l;return t=new Wt({props:{className:"size-4"}}),{c(){e=E("div"),X(t.$$.fragment)},l(s){e=N(s,"DIV",{});var n=w(e);$(t.$$.fragment,n),n.forEach(h)},m(s,n){V(s,e,n),x(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&h(e),ee(t)}}}function lo(r){let e=r[2].t("Code execution")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&Z(t,e)},d(l){l&&h(t)}}}function so(r){var i;let e=r[2].t("Code execution")+"",t,l,s=((i=r[1])==null?void 0:i.name)+"",n;return{c(){t=U(e),l=U(": "),n=U(s)},l(o){t=q(o,e),l=q(o,": "),n=q(o,s)},m(o,a){V(o,t,a),V(o,l,a),V(o,n,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&Z(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&Z(n,s)},d(o){o&&(h(t),h(l),h(n))}}}function Xl(r){var n,i,o,a;let e,t,l=((i=(n=r[1])==null?void 0:n.result)==null?void 0:i.error)&&$l(r),s=((a=(o=r[1])==null?void 0:o.result)==null?void 0:a.output)&&xl(r);return{c(){e=E("div"),l&&l.c(),t=H(),s&&s.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=w(e);l&&l.l(u),t=z(u),s&&s.l(u),u.forEach(h),this.h()},h(){d(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),v(e,t),s&&s.m(e,null)},p(f,u){var c,m,g,_;(m=(c=f[1])==null?void 0:c.result)!=null&&m.error?l?l.p(f,u):(l=$l(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(g=f[1])==null?void 0:g.result)!=null&&_.output?s?s.p(f,u):(s=xl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&h(e),l&&l.d(),s&&s.d()}}}function $l(r){var f,u;let e,t,l=r[2].t("ERROR")+"",s,n,i,o=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=E("div"),t=E("div"),s=U(l),n=H(),i=E("div"),a=U(o),this.h()},l(c){e=N(c,"DIV",{});var m=w(e);t=N(m,"DIV",{class:!0});var g=w(t);s=q(g,l),g.forEach(h),n=z(m),i=N(m,"DIV",{class:!0});var _=w(i);a=q(_,o),_.forEach(h),m.forEach(h),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,m){V(c,e,m),v(e,t),v(t,s),v(e,n),v(e,i),v(i,a)},p(c,m){var g,_;m&4&&l!==(l=c[2].t("ERROR")+"")&&Z(s,l),m&2&&o!==(o=((_=(g=c[1])==null?void 0:g.result)==null?void 0:_.error)+"")&&Z(a,o)},d(c){c&&h(e)}}}function xl(r){var f,u;let e,t,l=r[2].t("OUTPUT")+"",s,n,i,o=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=E("div"),t=E("div"),s=U(l),n=H(),i=E("div"),a=U(o),this.h()},l(c){e=N(c,"DIV",{});var m=w(e);t=N(m,"DIV",{class:!0});var g=w(t);s=q(g,l),g.forEach(h),n=z(m),i=N(m,"DIV",{class:!0});var _=w(i);a=q(_,o),_.forEach(h),m.forEach(h),this.h()},h(){d(t,"class","text-gray-500 text-xs mb-1"),d(i,"class","text-sm")},m(c,m){V(c,e,m),v(e,t),v(t,s),v(e,n),v(e,i),v(i,a)},p(c,m){var g,_;m&4&&l!==(l=c[2].t("OUTPUT")+"")&&Z(s,l),m&2&&o!==(o=((_=(g=c[1])==null?void 0:g.result)==null?void 0:_.output)+"")&&Z(a,o)},d(c){c&&h(e)}}}function es(r){var c,m;let e,t,l,s,n=r[2].t("Files")+"",i,o,a,f=Ee((m=(c=r[1])==null?void 0:c.result)==null?void 0:m.files),u=[];for(let g=0;g<f.length;g+=1)u[g]=ts(Kl(r,f,g));return{c(){e=E("div"),t=E("hr"),l=H(),s=E("div"),i=U(n),o=H(),a=E("ul");for(let g=0;g<u.length;g+=1)u[g].c();this.h()},l(g){e=N(g,"DIV",{class:!0});var _=w(e);t=N(_,"HR",{class:!0}),l=z(_),s=N(_,"DIV",{class:!0});var y=w(s);i=q(y,n),y.forEach(h),o=z(_),a=N(_,"UL",{class:!0});var p=w(a);for(let I=0;I<u.length;I+=1)u[I].l(p);p.forEach(h),_.forEach(h),this.h()},h(){d(t,"class","border-gray-100 dark:border-gray-850 my-2"),d(s,"class","text-sm font-medium dark:text-gray-300"),d(a,"class","mt-1 list-disc pl-4 text-xs"),d(e,"class","flex flex-col w-full")},m(g,_){V(g,e,_),v(e,t),v(e,l),v(e,s),v(s,i),v(e,o),v(e,a);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(a,null)},p(g,_){var y,p;if(_&4&&n!==(n=g[2].t("Files")+"")&&Z(i,n),_&2){f=Ee((p=(y=g[1])==null?void 0:y.result)==null?void 0:p.files);let I;for(I=0;I<f.length;I+=1){const k=Kl(g,f,I);u[I]?u[I].p(k,_):(u[I]=ts(k),u[I].c(),u[I].m(a,null))}for(;I<u.length;I+=1)u[I].d(1);u.length=f.length}},d(g){g&&h(e),qe(u,g)}}}function ts(r){let e,t,l=r[6].name+"",s,n,i;return{c(){e=E("li"),t=E("a"),s=U(l),i=H(),this.h()},l(o){e=N(o,"LI",{});var a=w(e);t=N(a,"A",{href:!0,target:!0});var f=w(t);s=q(f,l),f.forEach(h),i=z(a),a.forEach(h),this.h()},h(){d(t,"href",n=r[6].url),d(t,"target","_blank")},m(o,a){V(o,e,a),v(e,t),v(t,s),v(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&Z(s,l),a&2&&n!==(n=o[6].url)&&d(t,"href",n)},d(o){o&&h(e)}}}function ro(r){var W,le,de,te,ne,ue,he,ke,Q,F,A,fe,ie,ge,ye,_e,oe,j,K;let e,t,l,s,n,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,m,g,_,y,p,I,k,T,L,B=((W=r[1])==null?void 0:W.result)&&Ql(r),M=!((le=r[1])!=null&&le.result)&&Yl();function S(Y,G){var ce;return(ce=Y[1])!=null&&ce.name?so:lo}let O=S(r),C=O(r);y=new wn({props:{id:"code-exec-"+((de=r[1])==null?void 0:de.id)+"-code",lang:((te=r[1])==null?void 0:te.language)??"",code:((ne=r[1])==null?void 0:ne.code)??"",className:"",editorClassName:(ue=r[1])!=null&&ue.result&&((ke=(he=r[1])==null?void 0:he.result)!=null&&ke.error||(F=(Q=r[1])==null?void 0:Q.result)!=null&&F.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let P=((A=r[1])==null?void 0:A.result)&&(((ie=(fe=r[1])==null?void 0:fe.result)==null?void 0:ie.error)||((ye=(ge=r[1])==null?void 0:ge.result)==null?void 0:ye.output))&&Xl(r),R=((oe=(_e=r[1])==null?void 0:_e.result)==null?void 0:oe.files)&&((K=(j=r[1])==null?void 0:j.result)==null?void 0:K.files.length)>0&&es(r);return{c(){e=E("div"),t=E("div"),l=E("div"),B&&B.c(),s=H(),n=E("div"),M&&M.c(),i=H(),o=E("div"),C.c(),a=H(),f=E("button"),f.innerHTML=u,c=H(),m=E("div"),g=E("div"),_=E("div"),X(y.$$.fragment),p=H(),P&&P.c(),I=H(),R&&R.c(),this.h()},l(Y){e=N(Y,"DIV",{});var G=w(e);t=N(G,"DIV",{class:!0});var ce=w(t);l=N(ce,"DIV",{class:!0});var we=w(l);B&&B.l(we),s=z(we),n=N(we,"DIV",{class:!0});var Ce=w(n);M&&M.l(Ce),i=z(Ce),o=N(Ce,"DIV",{});var Te=w(o);C.l(Te),Te.forEach(h),Ce.forEach(h),we.forEach(h),a=z(ce),f=N(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),He(f)!=="svelte-vnrwun"&&(f.innerHTML=u),ce.forEach(h),c=z(G),m=N(G,"DIV",{class:!0});var je=w(m);g=N(je,"DIV",{class:!0});var ze=w(g);_=N(ze,"DIV",{class:!0});var Fe=w(_);$(y.$$.fragment,Fe),Fe.forEach(h),p=z(ze),P&&P.l(ze),I=z(ze),R&&R.l(ze),ze.forEach(h),je.forEach(h),G.forEach(h),this.h()},h(){d(n,"class","flex gap-2 items-center"),d(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),d(f,"class","self-center"),d(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),d(_,"class","flex flex-col w-full"),d(g,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),d(m,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(Y,G){V(Y,e,G),v(e,t),v(t,l),B&&B.m(l,null),v(l,s),v(l,n),M&&M.m(n,null),v(n,i),v(n,o),C.m(o,null),v(t,a),v(t,f),v(e,c),v(e,m),v(m,g),v(g,_),x(y,_,null),v(g,p),P&&P.m(g,null),v(g,I),R&&R.m(g,null),k=!0,T||(L=me(f,"click",r[4]),T=!0)},p(Y,G){var we,Ce,Te,je,ze,Fe,tt,lt,ot,at,xe,ft,ut,st,It,Mt,Et,Nt,Dt;(we=Y[1])!=null&&we.result?B?(B.p(Y,G),G&2&&b(B,1)):(B=Ql(Y),B.c(),b(B,1),B.m(l,s)):B&&(se(),D(B,1,1,()=>{B=null}),re()),(Ce=Y[1])!=null&&Ce.result?M&&(se(),D(M,1,1,()=>{M=null}),re()):M?G&2&&b(M,1):(M=Yl(),M.c(),b(M,1),M.m(n,i)),O===(O=S(Y))&&C?C.p(Y,G):(C.d(1),C=O(Y),C&&(C.c(),C.m(o,null)));const ce={};G&2&&(ce.id="code-exec-"+((Te=Y[1])==null?void 0:Te.id)+"-code"),G&2&&(ce.lang=((je=Y[1])==null?void 0:je.language)??""),G&2&&(ce.code=((ze=Y[1])==null?void 0:ze.code)??""),G&2&&(ce.editorClassName=(Fe=Y[1])!=null&&Fe.result&&((lt=(tt=Y[1])==null?void 0:tt.result)!=null&&lt.error||(at=(ot=Y[1])==null?void 0:ot.result)!=null&&at.output)?"rounded-b-none":""),y.$set(ce),(xe=Y[1])!=null&&xe.result&&((ut=(ft=Y[1])==null?void 0:ft.result)!=null&&ut.error||(It=(st=Y[1])==null?void 0:st.result)!=null&&It.output)?P?P.p(Y,G):(P=Xl(Y),P.c(),P.m(g,I)):P&&(P.d(1),P=null),(Et=(Mt=Y[1])==null?void 0:Mt.result)!=null&&Et.files&&((Dt=(Nt=Y[1])==null?void 0:Nt.result)==null?void 0:Dt.files.length)>0?R?R.p(Y,G):(R=es(Y),R.c(),R.m(g,null)):R&&(R.d(1),R=null)},i(Y){k||(b(B),b(M),b(y.$$.fragment,Y),k=!0)},o(Y){D(B),D(M),D(y.$$.fragment,Y),k=!1},d(Y){Y&&h(e),B&&B.d(),M&&M.d(),C.d(),ee(y),P&&P.d(),R&&R.d(),T=!1,L()}}}function no(r){let e,t,l;function s(i){r[5](i)}let n={size:"lg",$$slots:{default:[ro]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new Rr({props:n}),Ae.push(()=>Ke(e,"show",s)),{c(){X(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){ee(e,i)}}}function io(r,e,t){let l;const s=Ue("i18n");Me(r,s,f=>t(2,l=f));let{show:n=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,n=!1),t(1,i=null)};function a(f){n=f,t(0,n)}return r.$$set=f=>{"show"in f&&t(0,n=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[n,i,l,s,o,a]}class oo extends Be{constructor(e){super(),Se(this,e,io,no,Ve,{show:0,codeExecution:1})}}function ls(r,e,t){const l=r.slice();return l[6]=e[t],l}function ss(r){let e,t=[],l=new Map,s,n=Ee(r[0]);const i=o=>o[6].id;for(let o=0;o<n.length;o+=1){let a=ls(r,n,o),f=i(a);l.set(f,t[o]=rs(f,a))}return{c(){e=E("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=N(o,"DIV",{class:!0});var a=w(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(h),this.h()},h(){d(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){V(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(n=Ee(o[0]),se(),t=Gt(t,a,i,1,o,n,l,e,yr,rs,null,ls),re())},i(o){if(!s){for(let a=0;a<n.length;a+=1)b(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)D(t[a]);s=!1},d(o){o&&h(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ao(r){let e,t;return e=new Wt({props:{className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function fo(r){let e,t,l,s;const n=[ho,co,uo],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(se(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t||(t=i[e]=n[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function uo(r){let e,t;return e=new Vn({}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function co(r){let e,t;return e=new Nn({props:{strokeWidth:"3",className:"size-3"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ho(r){let e,t;return e=new Dn({}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function rs(r,e){let t,l,s,n,i,o,a,f=e[6].name+"",u,c,m,g,_,y;const p=[fo,ao],I=[];function k(L,B){var M;return(M=L[6])!=null&&M.result?0:1}n=k(e),i=I[n]=p[n](e);function T(){return e[4](e[6])}return{key:r,first:null,c(){t=E("div"),l=E("button"),s=E("div"),i.c(),o=H(),a=E("div"),u=U(f),m=H(),this.h()},l(L){t=N(L,"DIV",{class:!0});var B=w(t);l=N(B,"BUTTON",{class:!0});var M=w(l);s=N(M,"DIV",{class:!0});var S=w(s);i.l(S),S.forEach(h),o=z(M),a=N(M,"DIV",{class:!0});var O=w(a);u=q(O,f),O.forEach(h),M.forEach(h),m=z(B),B.forEach(h),this.h()},h(){var L;d(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),d(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((L=e[6])!=null&&L.result?"":"pulse")+" svelte-1gvtig2"),d(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),d(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(L,B){V(L,t,B),v(t,l),v(l,s),I[n].m(s,null),v(l,o),v(l,a),v(a,u),v(t,m),g=!0,_||(y=me(l,"click",T),_=!0)},p(L,B){var S;e=L;let M=n;n=k(e),n===M?I[n].p(e,B):(se(),D(I[M],1,1,()=>{I[M]=null}),re(),i=I[n],i?i.p(e,B):(i=I[n]=p[n](e),i.c()),b(i,1),i.m(s,null)),(!g||B&1)&&f!==(f=e[6].name+"")&&Z(u,f),(!g||B&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((S=e[6])!=null&&S.result?"":"pulse")+" svelte-1gvtig2"))&&d(a,"class",c)},i(L){g||(b(i),g=!0)},o(L){D(i),g=!1},d(L){L&&h(t),I[n].d(),_=!1,y()}}}function mo(r){let e,t,l,s,n;function i(f){r[3](f)}let o={codeExecution:r[1]};r[2]!==void 0&&(o.show=r[2]),e=new oo({props:o}),Ae.push(()=>Ke(e,"show",i));let a=r[0].length>0&&ss(r);return{c(){X(e.$$.fragment),l=H(),a&&a.c(),s=ae()},l(f){$(e.$$.fragment,f),l=z(f),a&&a.l(f),s=ae()},m(f,u){x(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),n=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ze(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=ss(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(se(),D(a,1,1,()=>{a=null}),re())},i(f){n||(b(e.$$.fragment,f),b(a),n=!0)},o(f){D(e.$$.fragment,f),D(a),n=!1},d(f){f&&(h(l),h(s)),ee(e,f),a&&a.d(f)}}}function go(r,e,t){let{codeExecutions:l=[]}=e,s=null,n=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){n=f,t(2,n)}const a=f=>{t(1,s=f),t(2,n=!0)};return r.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},r.$$.update=()=>{r.$$.dirty&1&&l&&i()},[l,s,n,o,a]}class _o extends Be{constructor(e){super(),Se(this,e,go,mo,Ve,{codeExecutions:0})}}function vo(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",r[1]),d(e,"stroke","currentColor"),d(e,"class",r[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&h(e)}}}function po(r,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class bo extends Be{constructor(e){super(),Se(this,e,po,vo,Ve,{className:0,strokeWidth:1})}}function ko(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",r[1]),d(e,"stroke","currentColor"),d(e,"class",r[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&h(e)}}}function wo(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class yo extends Be{constructor(e){super(),Se(this,e,wo,ko,Ve,{className:0,strokeWidth:1})}}function Io(r){let e,t,l,s,n,i,o,a,f,u,c,m;s=new yt({props:{id:`${r[0]}-float-prompt`,content:r[4]}});const g=[No,Eo],_=[];function y(I,k){return k&32&&(a=null),a==null&&(a=I[5].trim()===""),a?0:1}f=y(r,-1),u=_[f]=g[f](r);let p=r[6]&&ns(r);return{c(){e=E("div"),t=E("div"),l=E("div"),X(s.$$.fragment),n=H(),i=E("div"),o=E("div"),u.c(),c=H(),p&&p.c(),this.h()},l(I){e=N(I,"DIV",{class:!0});var k=w(e);t=N(k,"DIV",{class:!0});var T=w(t);l=N(T,"DIV",{class:!0});var L=w(l);$(s.$$.fragment,L),L.forEach(h),T.forEach(h),n=z(k),i=N(k,"DIV",{class:!0});var B=w(i);o=N(B,"DIV",{class:!0,id:!0});var M=w(o);u.l(M),c=z(M),p&&p.l(M),M.forEach(h),B.forEach(h),k.forEach(h),this.h()},h(){d(l,"class","font-medium"),d(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),d(o,"id","response-container"),d(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),d(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(I,k){V(I,e,k),v(e,t),v(t,l),x(s,l,null),v(e,n),v(e,i),v(i,o),_[f].m(o,null),v(o,c),p&&p.m(o,null),m=!0},p(I,k){const T={};k&1&&(T.id=`${I[0]}-float-prompt`),k&16&&(T.content=I[4]),s.$set(T);let L=f;f=y(I,k),f===L?_[f].p(I,k):(se(),D(_[L],1,1,()=>{_[L]=null}),re(),u=_[f],u?u.p(I,k):(u=_[f]=g[f](I),u.c()),b(u,1),u.m(o,c)),I[6]?p?p.p(I,k):(p=ns(I),p.c(),p.m(o,null)):p&&(p.d(1),p=null)},i(I){m||(b(s.$$.fragment,I),b(u),m=!0)},o(I){D(s.$$.fragment,I),D(u),m=!1},d(I){I&&h(e),ee(s),_[f].d(),p&&p.d()}}}function Mo(r){let e,t,l,s;const n=[Vo,Do],i=[];function o(a,f){return a[1]?1:0}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function Eo(r){let e,t;return e=new yt({props:{id:`${r[0]}-float-response`,content:r[5]}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s&1&&(n.id=`${l[0]}-float-response`),s&32&&(n.content=l[5]),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function No(r){let e,t;return e=new Yt({props:{size:"sm"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ns(r){let e,t,l=r[7].t("Add")+"",s,n,i;return{c(){e=E("div"),t=E("button"),s=U(l),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=w(e);t=N(a,"BUTTON",{class:!0});var f=w(t);s=q(f,l),f.forEach(h),a.forEach(h),this.h()},h(){d(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),d(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){V(o,e,a),v(e,t),v(t,s),n||(i=me(t,"click",r[11]),n=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&Z(s,l)},d(o){o&&h(e),n=!1,i()}}}function Do(r){let e,t,l,s,n,i,o,a,f,u,c;return{c(){e=E("div"),t=E("input"),s=H(),n=E("div"),i=E("button"),o=pe("svg"),a=pe("path"),this.h()},l(m){e=N(m,"DIV",{class:!0});var g=w(e);t=N(g,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=z(g),n=N(g,"DIV",{class:!0});var _=w(n);i=N(_,"BUTTON",{class:!0});var y=w(i);o=be(y,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var p=w(o);a=be(p,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(a).forEach(h),p.forEach(h),y.forEach(h),_.forEach(h),g.forEach(h),this.h()},h(){d(t,"type","text"),d(t,"id","floating-message-input"),d(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),d(t,"placeholder",l=r[7].t("Ask a question")),d(a,"fill-rule","evenodd"),d(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),d(a,"clip-rule","evenodd"),d(o,"xmlns","http://www.w3.org/2000/svg"),d(o,"viewBox","0 0 16 16"),d(o,"fill","currentColor"),d(o,"class","size-4"),d(i,"class",f=(r[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),d(n,"class","ml-1 mr-2"),d(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-850 w-72 rounded-full shadow-xl")},m(m,g){V(m,e,g),v(e,t),nt(t,r[3]),v(e,s),v(e,n),v(n,i),v(i,o),v(o,a),u||(c=[me(t,"input",r[18]),me(t,"keydown",r[19]),me(i,"click",r[20])],u=!0)},p(m,g){g&128&&l!==(l=m[7].t("Ask a question"))&&d(t,"placeholder",l),g&8&&t.value!==m[3]&&nt(t,m[3]),g&8&&f!==(f=(m[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&d(i,"class",f)},i:ve,o:ve,d(m){m&&h(e),u=!1,et(c)}}}function Vo(r){let e,t,l,s,n,i=r[7].t("Ask")+"",o,a,f,u,c,m,g=r[7].t("Explain")+"",_,y,p,I;return l=new bo({props:{className:"size-3 shrink-0"}}),u=new yo({props:{className:"size-3 shrink-0"}}),{c(){e=E("div"),t=E("button"),X(l.$$.fragment),s=H(),n=E("div"),o=U(i),a=H(),f=E("button"),X(u.$$.fragment),c=H(),m=E("div"),_=U(g),this.h()},l(k){e=N(k,"DIV",{class:!0});var T=w(e);t=N(T,"BUTTON",{class:!0});var L=w(t);$(l.$$.fragment,L),s=z(L),n=N(L,"DIV",{class:!0});var B=w(n);o=q(B,i),B.forEach(h),L.forEach(h),a=z(T),f=N(T,"BUTTON",{class:!0});var M=w(f);$(u.$$.fragment,M),c=z(M),m=N(M,"DIV",{class:!0});var S=w(m);_=q(S,g),S.forEach(h),M.forEach(h),T.forEach(h),this.h()},h(){d(n,"class","shrink-0"),d(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(m,"class","shrink-0"),d(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),d(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(k,T){V(k,e,T),v(e,t),x(l,t,null),v(t,s),v(t,n),v(n,o),v(e,a),v(e,f),x(u,f,null),v(f,c),v(f,m),v(m,_),y=!0,p||(I=[me(t,"click",r[16]),me(f,"click",r[17])],p=!0)},p(k,T){(!y||T&128)&&i!==(i=k[7].t("Ask")+"")&&Z(o,i),(!y||T&128)&&g!==(g=k[7].t("Explain")+"")&&Z(_,g)},i(k){y||(b(l.$$.fragment,k),b(u.$$.fragment,k),y=!0)},o(k){D(l.$$.fragment,k),D(u.$$.fragment,k),y=!1},d(k){k&&h(e),ee(l),ee(u),p=!1,et(I)}}}function Co(r){let e,t,l,s,n;const i=[Mo,Io],o=[];function a(f,u){return f[5]===null?0:1}return t=a(r),l=o[t]=i[t](r),{c(){e=E("div"),l.c(),this.h()},l(f){e=N(f,"DIV",{id:!0,class:!0,style:!0});var u=w(e);l.l(u),u.forEach(h),this.h()},h(){d(e,"id",s=`floating-buttons-${r[0]}`),d(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),Rt(e,"display","none")},m(f,u){V(f,e,u),o[t].m(e,null),n=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(se(),D(o[c],1,1,()=>{o[c]=null}),re(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!n||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&d(e,"id",s)},i(f){n||(b(l),n=!0)},o(f){D(l),n=!1},d(f){f&&h(e),o[t].d()}}}function To(r,e,t){let l;const s=Ue("i18n");Me(r,s,C=>t(7,l=C));let{id:n=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",m="",g=null,_=!1;const y=async()=>{const C=document.getElementById("response-container");C.scrollHeight-C.clientHeight<=C.scrollTop+50&&(C.scrollTop=C.scrollHeight)},p=async()=>{if(!i){Pe.error("Model not selected");return}t(4,m=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,g="");const[C,P]=await vl(localStorage.token,{model:i,messages:[...o,{role:"user",content:m}].map(R=>({role:R.role,content:R.content})),stream:!0});if(C&&C.ok){const R=C.body.getReader(),W=new TextDecoder;await(async()=>{var de,te;for(;;){const{done:ne,value:ue}=await R.read();if(ne)break;const ke=W.decode(ue,{stream:!0}).split(`
`).filter(Q=>Q.trim()!=="");for(const Q of ke)if(Q.startsWith("data: "))if(Q.startsWith("data: [DONE]")){t(6,_=!0),await De(),y();continue}else try{const F=JSON.parse(Q.slice(6));F.choices&&((te=(de=F.choices[0])==null?void 0:de.delta)!=null&&te.content)&&(t(5,g+=F.choices[0].delta.content),y())}catch(F){console.error(F)}}})()}else Pe.error("An error occurred while fetching the explanation")},I=async()=>{if(!i){Pe.error("Model not selected");return}const C=l.t("Explain this section to me in more detail");t(4,m=`${C}

\`\`\`
${u}
\`\`\``),t(5,g="");const[P,R]=await vl(localStorage.token,{model:i,messages:[...o,{role:"user",content:m}].map(W=>({role:W.role,content:W.content})),stream:!0});if(P&&P.ok){const W=P.body.getReader(),le=new TextDecoder;await(async()=>{var te,ne;for(;;){const{done:ue,value:he}=await W.read();if(ue)break;const Q=le.decode(he,{stream:!0}).split(`
`).filter(F=>F.trim()!=="");for(const F of Q)if(F.startsWith("data: "))if(F.startsWith("data: [DONE]")){t(6,_=!0),await De(),y();continue}else try{const A=JSON.parse(F.slice(6));A.choices&&((ne=(te=A.choices[0])==null?void 0:te.delta)!=null&&ne.content)&&(t(5,g+=A.choices[0].delta.content),y())}catch(A){console.error(A)}}})()}else Pe.error("An error occurred while fetching the explanation")},k=async()=>{a({modelId:i,parentId:n,messages:[{role:"user",content:m},{role:"assistant",content:g}]})},T=()=>{t(5,g=null),t(6,_=!1),t(1,f=!1),t(3,c="")},L=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await De(),setTimeout(()=>{const C=document.getElementById("floating-message-input");C&&C.focus()},0)},B=()=>{t(2,u=window.getSelection().toString()),I()};function M(){c=this.value,t(3,c)}const S=C=>{C.key==="Enter"&&p()},O=()=>{p()};return r.$$set=C=>{"id"in C&&t(0,n=C.id),"model"in C&&t(12,i=C.model),"messages"in C&&t(13,o=C.messages),"onAdd"in C&&t(14,a=C.onAdd)},[n,f,u,c,m,g,_,l,s,p,I,k,i,o,a,T,L,B,M,S,O]}class Bo extends Be{constructor(e){super(),Se(this,e,To,Co,Ve,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function is(r){var s;let e,t,l={id:r[0],model:(s=r[3])==null?void 0:s.id,messages:Jt(r[2],r[0]),onAdd:r[20]};return e=new Bo({props:l}),r[21](e),{c(){X(e.$$.fragment)},l(n){$(e.$$.fragment,n)},m(n,i){x(e,n,i),t=!0},p(n,i){var a;const o={};i&1&&(o.id=n[0]),i&8&&(o.model=(a=n[3])==null?void 0:a.id),i&5&&(o.messages=Jt(n[2],n[0])),i&512&&(o.onAdd=n[20]),e.$set(o)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){r[21](null),ee(e,n)}}}function So(r){let e,t,l,s,n;t=new yt({props:{id:r[0],content:r[1],model:r[3],save:r[5],sourceIds:(r[4]??[]).reduce(r[16],[]),onSourceClick:r[7],onTaskClick:r[8]}}),t.$on("update",r[17]),t.$on("code",r[18]);let i=r[6]&&r[3]&&is(r);return{c(){e=E("div"),X(t.$$.fragment),l=H(),i&&i.c(),s=ae()},l(o){e=N(o,"DIV",{});var a=w(e);$(t.$$.fragment,a),a.forEach(h),l=z(o),i&&i.l(o),s=ae()},m(o,a){V(o,e,a),x(t,e,null),r[19](e),V(o,l,a),i&&i.m(o,a),V(o,s,a),n=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&24&&(f.sourceIds=(o[4]??[]).reduce(o[16],[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&b(i,1)):(i=is(o),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(se(),D(i,1,1,()=>{i=null}),re())},i(o){n||(b(t.$$.fragment,o),b(i),n=!0)},o(o){D(t.$$.fragment,o),D(i),n=!1},d(o){o&&(h(e),h(l),h(s)),ee(t),r[19](null),i&&i.d(o)}}}function Ro(r,e,t){let l,s;Me(r,Ir,R=>t(12,l=R)),Me(r,an,R=>t(13,s=R)),Ue("i18n");const n=gt();let{id:i}=e,{content:o}=e,{history:a}=e,{model:f=null}=e,{sources:u=null}=e,{save:c=!1}=e,{floatingButtons:m=!0}=e,{onSourceClick:g=()=>{}}=e,{onTaskClick:_=()=>{}}=e,{onAddMessages:y=()=>{}}=e,p,I;const k=R=>{const W=document.getElementById(`floating-buttons-${i}`);if(!(p!=null&&p.contains(R.target))&&!(W!=null&&W.contains(R.target))){T();return}setTimeout(async()=>{if(await De(),!(p!=null&&p.contains(R.target)))return;let le=window.getSelection();if(le.toString().trim().length>0){const te=le.getRangeAt(0).getBoundingClientRect(),ne=p.getBoundingClientRect(),ue=te.bottom-ne.top,he=te.left-ne.left;if(W){W.style.display="block";const ke=ne.width-he;let Q=l?window.innerWidth/2:window.innerWidth/3;if(ke<Q){const F=ne.right-te.right;W.style.right=`${F}px`,W.style.left="auto"}else W.style.left=`${he}px`,W.style.right="auto";W.style.top=`${ue+5}px`}}else T()},0)},T=()=>{const R=document.getElementById(`floating-buttons-${i}`);R&&(R.style.display="none"),I&&I.closeHandler()},L=R=>{R.key==="Escape"&&T()};bt(()=>{m&&(p==null||p.addEventListener("mouseup",k),document.addEventListener("mouseup",k),document.addEventListener("keydown",L))}),ln(()=>{m&&(p==null||p.removeEventListener("mouseup",k),document.removeEventListener("mouseup",k),document.removeEventListener("keydown",L))});const B=(R,W)=>{let le=[];return W.document.forEach((de,te)=>{var he,ke,Q,F,A;if(((Q=(ke=(he=f==null?void 0:f.info)==null?void 0:he.meta)==null?void 0:ke.capabilities)==null?void 0:Q.citations)==!1)return le.push("N/A"),le;const ne=(F=W.metadata)==null?void 0:F[te],ue=(ne==null?void 0:ne.source)??"N/A";return ne!=null&&ne.name?(le.push(ne.name),le):(ue.startsWith("http://")||ue.startsWith("https://")?le.push(ue):le.push(((A=W==null?void 0:W.source)==null?void 0:A.name)??ue),le)}),R=[...R,...le],R.filter((de,te)=>R.indexOf(de)===te)},M=R=>{n("update",R.detail)},S=R=>{const{lang:W,code:le}=R.detail;(["html","svg"].includes(W)||W==="xml"&&le.includes("svg"))&&!l&&s&&(fn.set(!0),un.set(!0))};function O(R){Ae[R?"unshift":"push"](()=>{p=R,t(10,p)})}const C=({modelId:R,parentId:W,messages:le})=>{console.log(R,W,le),y({modelId:R,parentId:W,messages:le}),T()};function P(R){Ae[R?"unshift":"push"](()=>{I=R,t(11,I)})}return r.$$set=R=>{"id"in R&&t(0,i=R.id),"content"in R&&t(1,o=R.content),"history"in R&&t(2,a=R.history),"model"in R&&t(3,f=R.model),"sources"in R&&t(4,u=R.sources),"save"in R&&t(5,c=R.save),"floatingButtons"in R&&t(6,m=R.floatingButtons),"onSourceClick"in R&&t(7,g=R.onSourceClick),"onTaskClick"in R&&t(8,_=R.onTaskClick),"onAddMessages"in R&&t(9,y=R.onAddMessages)},[i,o,a,f,u,c,m,g,_,y,p,I,l,s,n,T,B,M,S,O,C,P]}class Oo extends Be{constructor(e){super(),Se(this,e,Ro,So,Ve,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function os(r,e,t){const l=r.slice();return l[81]=e[t],l}function Ut(r){var l,s,n;const e=r.slice(),t=(((l=e[12])==null?void 0:l.statusHistory)??[...(s=e[12])!=null&&s.status?[(n=e[12])==null?void 0:n.status]:[]]).at(-1);return e[84]=t,e}function as(r,e,t){const l=r.slice();return l[85]=e[t],l}function Lo(r){var s;let e,t=(((s=r[16])==null?void 0:s.name)??r[12].model)+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(n){e=N(n,"SPAN",{class:!0});var i=w(e);l=q(i,t),i.forEach(h),this.h()},h(){d(e,"class","line-clamp-1")},m(n,i){V(n,e,i),v(e,l)},p(n,i){var o;i[0]&69632&&t!==(t=(((o=n[16])==null?void 0:o.name)??n[12].model)+"")&&Z(l,t)},d(n){n&&h(e)}}}function fs(r){let e,t,l;return t=new Re({props:{content:it(r[12].timestamp*1e3).format("LLLL"),$$slots:{default:[Po]},$$scope:{ctx:r}}}),{c(){e=E("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);$(t.$$.fragment,n),n.forEach(h),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){V(s,e,n),x(t,e,null),l=!0},p(s,n){const i={};n[0]&4096&&(i.content=it(s[12].timestamp*1e3).format("LLLL")),n[0]&4096|n[2]&67108864&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&h(e),ee(t)}}}function Po(r){let e,t=Pt(r[12].timestamp*1e3)+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","line-clamp-1")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n[0]&4096&&t!==(t=Pt(s[12].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&h(e)}}}function Ao(r){var i;let e,t,l,s;e=new Re({props:{content:((i=r[16])==null?void 0:i.name)??r[12].model,placement:"top-start",$$slots:{default:[Lo]},$$scope:{ctx:r}}});let n=r[12].timestamp&&fs(r);return{c(){X(e.$$.fragment),t=H(),n&&n.c(),l=ae()},l(o){$(e.$$.fragment,o),t=z(o),n&&n.l(o),l=ae()},m(o,a){x(e,o,a),V(o,t,a),n&&n.m(o,a),V(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&69632&&(f.content=((u=o[16])==null?void 0:u.name)??o[12].model),a[0]&69632|a[2]&67108864&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[12].timestamp?n?(n.p(o,a),a[0]&4096&&b(n,1)):(n=fs(o),n.c(),b(n,1),n.m(l.parentNode,l)):n&&(se(),D(n,1,1,()=>{n=null}),re())},i(o){s||(b(e.$$.fragment,o),b(n),s=!0)},o(o){D(e.$$.fragment,o),D(n),s=!1},d(o){o&&(h(t),h(l)),ee(e,o),n&&n.d(o)}}}function us(r){let e,t,l=Ee(r[12].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=ds(as(r,l,i));const n=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=w(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),this.h()},h(){d(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4096){l=Ee(i[12].files);let a;for(a=0;a<l.length;a+=1){const f=as(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=ds(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)n(a);re()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&h(e),qe(s,i)}}}function cs(r){let e,t;return e=new Vr({props:{src:r[85].url,alt:r[12].content}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.src=l[85].url),s[0]&4096&&(n.alt=l[12].content),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ds(r){let e,t,l,s=r[85].type==="image"&&cs(r);return{c(){e=E("div"),s&&s.c(),t=H()},l(n){e=N(n,"DIV",{});var i=w(e);s&&s.l(i),t=z(i),i.forEach(h)},m(n,i){V(n,e,i),s&&s.m(e,null),v(e,t),l=!0},p(n,i){n[85].type==="image"?s?(s.p(n,i),i[0]&4096&&b(s,1)):(s=cs(n),s.c(),b(s,1),s.m(e,t)):s&&(se(),D(s,1,1,()=>{s=null}),re())},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&h(e),s&&s.d()}}}function hs(r){var s;let e,t,l=!((s=r[84])!=null&&s.hidden)&&ms(r);return{c(){l&&l.c(),e=ae()},l(n){l&&l.l(n),e=ae()},m(n,i){l&&l.m(n,i),V(n,e,i),t=!0},p(n,i){var o;(o=n[84])!=null&&o.hidden?l&&(se(),D(l,1,1,()=>{l=null}),re()):l?(l.p(n,i),i[0]&4096&&b(l,1)):(l=ms(n),l.c(),b(l,1),l.m(e.parentNode,e))},i(n){t||(b(l),t=!0)},o(n){D(l),t=!1},d(n){n&&h(e),l&&l.d(n)}}}function ms(r){var u;let e,t,l,s,n,i=((u=r[84])==null?void 0:u.done)===!1&&gs();const o=[zo,Ho,jo],a=[];function f(c,m){var g,_,y;return((g=c[84])==null?void 0:g.action)==="web_search"&&((_=c[84])!=null&&_.urls)?0:((y=c[84])==null?void 0:y.action)==="knowledge_search"?1:2}return l=f(r),s=a[l]=o[l](r),{c(){e=E("div"),i&&i.c(),t=H(),s.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var m=w(e);i&&i.l(m),t=z(m),s.l(m),m.forEach(h),this.h()},h(){d(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,m){V(c,e,m),i&&i.m(e,null),v(e,t),a[l].m(e,null),n=!0},p(c,m){var _;((_=c[84])==null?void 0:_.done)===!1?i?m[0]&4096&&b(i,1):(i=gs(),i.c(),b(i,1),i.m(e,t)):i&&(se(),D(i,1,1,()=>{i=null}),re());let g=l;l=f(c),l===g?a[l].p(c,m):(se(),D(a[g],1,1,()=>{a[g]=null}),re(),s=a[l],s?s.p(c,m):(s=a[l]=o[l](c),s.c()),b(s,1),s.m(e,null))},i(c){n||(b(i),b(s),n=!0)},o(c){D(i),D(s),n=!1},d(c){c&&h(e),i&&i.d(),a[l].d()}}}function gs(r){let e,t,l;return t=new Wt({props:{className:"size-4"}}),{c(){e=E("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);$(t.$$.fragment,n),n.forEach(h),this.h()},h(){d(e,"class","")},m(s,n){V(s,e,n),x(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&h(e),ee(t)}}}function jo(r){let e,t,l,s;function n(a,f){var u,c,m;return f[0]&4096&&(l=null),l==null&&(l=!!((u=a[84])!=null&&u.description.includes("{{searchQuery}}"))),l?Fo:((c=a[84])==null?void 0:c.description)==="No search query generated"?qo:((m=a[84])==null?void 0:m.description)==="Generating search query"?Uo:Wo}let i=n(r,[-1,-1,-1]),o=i(r);return{c(){e=E("div"),t=E("div"),o.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=w(e);t=N(f,"DIV",{class:!0});var u=w(t);o.l(u),u.forEach(h),f.forEach(h),this.h()},h(){var a;d(t,"class",s=(((a=r[84])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),v(e,t),o.m(t,null)},p(a,f){var u;i===(i=n(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&4096&&s!==(s=(((u=a[84])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",s)},i:ve,o:ve,d(a){a&&h(e),o.d()}}}function Ho(r){let e,t,l=r[26].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:r[84].query})+"",s,n;return{c(){e=E("div"),t=E("div"),s=U(l),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=w(e);t=N(o,"DIV",{class:!0});var a=w(t);s=q(a,l),a.forEach(h),o.forEach(h),this.h()},h(){var i;d(t,"class",n=(((i=r[84])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){V(i,e,o),v(e,t),v(t,s)},p(i,o){var a;o[0]&67112960&&l!==(l=i[26].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[84].query})+"")&&Z(s,l),o[0]&4096&&n!==(n=(((a=i[84])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&d(t,"class",n)},i:ve,o:ve,d(i){i&&h(e)}}}function zo(r){let e,t;return e=new bi({props:{status:r[84],$$slots:{default:[Qo]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.status=l[84]),s[0]&67112960|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Wo(r){var l;let e=((l=r[84])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=q(s,e)},m(s,n){V(s,t,n)},p(s,n){var i;n[0]&4096&&e!==(e=((i=s[84])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&h(t)}}}function Uo(r){let e=r[26].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("Generating search query")+"")&&Z(t,e)},d(l){l&&h(t)}}}function qo(r){let e=r[26].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("No search query generated")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Fo(r){var l,s;let e=r[26].t((l=r[84])==null?void 0:l.description,{searchQuery:(s=r[84])==null?void 0:s.query})+"",t;return{c(){t=U(e)},l(n){t=q(n,e)},m(n,i){V(n,t,i)},p(n,i){var o,a;i[0]&67112960&&e!==(e=n[26].t((o=n[84])==null?void 0:o.description,{searchQuery:(a=n[84])==null?void 0:a.query})+"")&&Z(t,e)},d(n){n&&h(t)}}}function Jo(r){var l;let e=((l=r[84])==null?void 0:l.description)+"",t;return{c(){t=U(e)},l(s){t=q(s,e)},m(s,n){V(s,t,n)},p(s,n){var i;n[0]&4096&&e!==(e=((i=s[84])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&h(t)}}}function Go(r){let e=r[26].t("Generating search query")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("Generating search query")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Zo(r){let e=r[26].t("No search query generated")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&67108864&&e!==(e=l[26].t("No search query generated")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ko(r){var l,s;let e=r[26].t((l=r[84])==null?void 0:l.description,{count:(s=r[84])==null?void 0:s.urls.length})+"",t;return{c(){t=U(e)},l(n){t=q(n,e)},m(n,i){V(n,t,i)},p(n,i){var o,a;i[0]&67112960&&e!==(e=n[26].t((o=n[84])==null?void 0:o.description,{count:(a=n[84])==null?void 0:a.urls.length})+"")&&Z(t,e)},d(n){n&&h(t)}}}function Qo(r){let e,t,l,s;function n(a,f){var u,c,m;return f[0]&4096&&(l=null),l==null&&(l=!!((u=a[84])!=null&&u.description.includes("{{count}}"))),l?Ko:((c=a[84])==null?void 0:c.description)==="No search query generated"?Zo:((m=a[84])==null?void 0:m.description)==="Generating search query"?Go:Jo}let i=n(r,[-1,-1,-1]),o=i(r);return{c(){e=E("div"),t=E("div"),o.c(),this.h()},l(a){e=N(a,"DIV",{class:!0});var f=w(e);t=N(f,"DIV",{class:!0});var u=w(t);o.l(u),u.forEach(h),f.forEach(h),this.h()},h(){var a;d(t,"class",s=(((a=r[84])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),d(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),v(e,t),o.m(t,null)},p(a,f){var u;i===(i=n(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&4096&&s!==(s=(((u=a[84])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&d(t,"class",s)},d(a){a&&h(e),o.d()}}}function Yo(r){var _,y,p,I,k,T,L;let e,t,l,s,n,i,o;const a=[xo,$o],f=[];function u(B,M){return B[12].content===""&&!B[12].error?0:B[12].content&&B[12].error!==!0?1:-1}~(t=u(r))&&(l=f[t]=a[t](r));let c=((_=r[12])==null?void 0:_.error)&&_s(r),m=(((y=r[12])==null?void 0:y.sources)||((p=r[12])==null?void 0:p.citations))&&(((L=(T=(k=(I=r[16])==null?void 0:I.info)==null?void 0:k.meta)==null?void 0:T.capabilities)==null?void 0:L.citations)??!0)&&vs(r),g=r[12].code_executions&&ps(r);return{c(){e=E("div"),l&&l.c(),s=H(),c&&c.c(),n=H(),m&&m.c(),i=H(),g&&g.c(),this.h()},l(B){e=N(B,"DIV",{class:!0,id:!0});var M=w(e);l&&l.l(M),s=z(M),c&&c.l(M),n=z(M),m&&m.l(M),i=z(M),g&&g.l(M),M.forEach(h),this.h()},h(){d(e,"class","w-full flex flex-col relative"),d(e,"id","response-content-container")},m(B,M){V(B,e,M),~t&&f[t].m(e,null),v(e,s),c&&c.m(e,null),v(e,n),m&&m.m(e,null),v(e,i),g&&g.m(e,null),o=!0},p(B,M){var O,C,P,R,W,le,de;let S=t;t=u(B),t===S?~t&&f[t].p(B,M):(l&&(se(),D(f[S],1,1,()=>{f[S]=null}),re()),~t?(l=f[t],l?l.p(B,M):(l=f[t]=a[t](B),l.c()),b(l,1),l.m(e,s)):l=null),(O=B[12])!=null&&O.error?c?(c.p(B,M),M[0]&4096&&b(c,1)):(c=_s(B),c.c(),b(c,1),c.m(e,n)):c&&(se(),D(c,1,1,()=>{c=null}),re()),((C=B[12])!=null&&C.sources||(P=B[12])!=null&&P.citations)&&(((de=(le=(W=(R=B[16])==null?void 0:R.info)==null?void 0:W.meta)==null?void 0:le.capabilities)==null?void 0:de.citations)??!0)?m?(m.p(B,M),M[0]&69632&&b(m,1)):(m=vs(B),m.c(),b(m,1),m.m(e,i)):m&&(se(),D(m,1,1,()=>{m=null}),re()),B[12].code_executions?g?(g.p(B,M),M[0]&4096&&b(g,1)):(g=ps(B),g.c(),b(g,1),g.m(e,null)):g&&(se(),D(g,1,1,()=>{g=null}),re())},i(B){o||(b(l),b(c),b(m),b(g),o=!0)},o(B){D(l),D(c),D(m),D(g),o=!1},d(B){B&&h(e),~t&&f[t].d(),c&&c.d(),m&&m.d(),g&&g.d()}}}function Xo(r){let e,t,l,s,n,i,o,a=r[26].t("Save As Copy")+"",f,u,c,m,g=r[26].t("Cancel")+"",_,y,p,I=r[26].t("Save")+"",k,T,L;return{c(){e=E("div"),t=E("textarea"),s=H(),n=E("div"),i=E("div"),o=E("button"),f=U(a),u=H(),c=E("div"),m=E("button"),_=U(g),y=H(),p=E("button"),k=U(I),this.h()},l(B){e=N(B,"DIV",{class:!0});var M=w(e);t=N(M,"TEXTAREA",{id:!0,class:!0}),w(t).forEach(h),s=z(M),n=N(M,"DIV",{class:!0});var S=w(n);i=N(S,"DIV",{});var O=w(i);o=N(O,"BUTTON",{id:!0,class:!0});var C=w(o);f=q(C,a),C.forEach(h),O.forEach(h),u=z(S),c=N(S,"DIV",{class:!0});var P=w(c);m=N(P,"BUTTON",{id:!0,class:!0});var R=w(m);_=q(R,g),R.forEach(h),y=z(P),p=N(P,"BUTTON",{id:!0,class:!0});var W=w(p);k=q(W,I),W.forEach(h),P.forEach(h),S.forEach(h),M.forEach(h),this.h()},h(){d(t,"id",l="message-edit-"+r[12].id),d(t,"class","bg-transparent outline-hidden w-full resize-none"),d(o,"id","save-new-message-button"),d(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(m,"id","close-edit-message-button"),d(m,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(p,"id","confirm-edit-message-button"),d(p,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(c,"class","flex space-x-1.5"),d(n,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(B,M){V(B,e,M),v(e,t),r[49](t),nt(t,r[17]),v(e,s),v(e,n),v(n,i),v(i,o),v(o,f),v(n,u),v(n,c),v(c,m),v(m,_),v(c,y),v(c,p),v(p,k),T||(L=[me(t,"input",r[50]),me(t,"input",ba),me(t,"keydown",r[51]),me(o,"click",r[52]),me(m,"click",r[53]),me(p,"click",r[54])],T=!0)},p(B,M){M[0]&4096&&l!==(l="message-edit-"+B[12].id)&&d(t,"id",l),M[0]&131072&&nt(t,B[17]),M[0]&67108864&&a!==(a=B[26].t("Save As Copy")+"")&&Z(f,a),M[0]&67108864&&g!==(g=B[26].t("Cancel")+"")&&Z(_,g),M[0]&67108864&&I!==(I=B[26].t("Save")+"")&&Z(k,I)},i:ve,o:ve,d(B){B&&h(e),r[49](null),T=!1,et(L)}}}function $o(r){var l;let e,t;return e=new Oo({props:{id:r[12].id,history:r[0],content:r[12].content,sources:r[12].sources,floatingButtons:(l=r[12])==null?void 0:l.done,save:!r[11],model:r[16],onTaskClick:r[55],onSourceClick:r[56],onAddMessages:r[57]}}),e.$on("update",r[58]),e.$on("select",r[59]),{c(){X(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,n){x(e,s,n),t=!0},p(s,n){var o;const i={};n[0]&4096&&(i.id=s[12].id),n[0]&1&&(i.history=s[0]),n[0]&4096&&(i.content=s[12].content),n[0]&4096&&(i.sources=s[12].sources),n[0]&4096&&(i.floatingButtons=(o=s[12])==null?void 0:o.done),n[0]&2048&&(i.save=!s[11]),n[0]&65536&&(i.model=s[16]),n[0]&4096&&(i.onSourceClick=s[56]),n[0]&512&&(i.onAddMessages=s[57]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function xo(r){let e,t;return e=new Yt({}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function _s(r){var l,s;let e,t;return e=new Ei({props:{content:((s=(l=r[12])==null?void 0:l.error)==null?void 0:s.content)??r[12].content}}),{c(){X(e.$$.fragment)},l(n){$(e.$$.fragment,n)},m(n,i){x(e,n,i),t=!0},p(n,i){var a,f;const o={};i[0]&4096&&(o.content=((f=(a=n[12])==null?void 0:a.error)==null?void 0:f.content)??n[12].content),e.$set(o)},i(n){t||(b(e.$$.fragment,n),t=!0)},o(n){D(e.$$.fragment,n),t=!1},d(n){ee(e,n)}}}function vs(r){var l,s,n;let e,t;return e=new $i({props:{id:(l=r[12])==null?void 0:l.id,sources:((s=r[12])==null?void 0:s.sources)??((n=r[12])==null?void 0:n.citations)}}),{c(){X(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&4096&&(a.id=(f=i[12])==null?void 0:f.id),o[0]&4096&&(a.sources=((u=i[12])==null?void 0:u.sources)??((c=i[12])==null?void 0:c.citations)),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){ee(e,i)}}}function ps(r){let e,t;return e=new _o({props:{codeExecutions:r[12].code_executions}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.codeExecutions=l[12].code_executions),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function bs(r){let e,t,l,s,n=(r[12].done||r[1].length>1)&&ks(r),i=r[12].done&&r[22]&&Rs(r);return{c(){e=E("div"),n&&n.c(),t=H(),i&&i.c(),l=ae(),this.h()},l(o){e=N(o,"DIV",{class:!0});var a=w(e);n&&n.l(a),a.forEach(h),t=z(o),i&&i.l(o),l=ae(),this.h()},h(){d(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(o,a){V(o,e,a),n&&n.m(e,null),r[73](e),V(o,t,a),i&&i.m(o,a),V(o,l,a),s=!0},p(o,a){o[12].done||o[1].length>1?n?(n.p(o,a),a[0]&4098&&b(n,1)):(n=ks(o),n.c(),b(n,1),n.m(e,null)):n&&(se(),D(n,1,1,()=>{n=null}),re()),o[12].done&&o[22]?i?(i.p(o,a),a[0]&4198400&&b(i,1)):(i=Rs(o),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(se(),D(i,1,1,()=>{i=null}),re())},i(o){s||(b(n),b(i),s=!0)},o(o){D(n),D(i),s=!1},d(o){o&&(h(e),h(t),h(l)),n&&n.d(),r[73](null),i&&i.d(o)}}}function ks(r){let e,t,l,s=r[1].length>1&&ws(r),n=r[12].done&&ys(r);return{c(){s&&s.c(),e=H(),n&&n.c(),t=ae()},l(i){s&&s.l(i),e=z(i),n&&n.l(i),t=ae()},m(i,o){s&&s.m(i,o),V(i,e,o),n&&n.m(i,o),V(i,t,o),l=!0},p(i,o){i[1].length>1?s?s.p(i,o):(s=ws(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[12].done?n?(n.p(i,o),o[0]&4096&&b(n,1)):(n=ys(i),n.c(),b(n,1),n.m(t.parentNode,t)):n&&(se(),D(n,1,1,()=>{n=null}),re())},i(i){l||(b(n),l=!0)},o(i){D(n),l=!1},d(i){i&&(h(e),h(t)),s&&s.d(i),n&&n.d(i)}}}function ws(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[12].id)+1+"",o,a,f=r[1].length+"",u,c,m,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,y;return{c(){e=E("div"),t=E("button"),t.innerHTML=l,s=H(),n=E("div"),o=U(i),a=U("/"),u=U(f),c=H(),m=E("button"),m.innerHTML=g,this.h()},l(p){e=N(p,"DIV",{class:!0,dir:!0});var I=w(e);t=N(I,"BUTTON",{class:!0,"data-svelte-h":!0}),He(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=z(I),n=N(I,"DIV",{class:!0});var k=w(n);o=q(k,i),a=q(k,"/"),u=q(k,f),k.forEach(h),c=z(I),m=N(I,"BUTTON",{class:!0,"data-svelte-h":!0}),He(m)!=="svelte-107ksnk"&&(m.innerHTML=g),I.forEach(h),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),d(m,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center min-w-fit"),d(e,"dir","ltr")},m(p,I){V(p,e,I),v(e,t),v(e,s),v(e,n),v(n,o),v(n,a),v(n,u),v(e,c),v(e,m),_||(y=[me(t,"click",r[60]),me(m,"click",r[61])],_=!0)},p(p,I){I[0]&4098&&i!==(i=p[1].indexOf(p[12].id)+1+"")&&Z(o,i),I[0]&2&&f!==(f=p[1].length+"")&&Z(u,f)},d(p){p&&h(e),_=!1,et(y)}}}function ys(r){var _,y,p,I;let e,t,l,s,n,i,o,a,f,u=!r[11]&&Is(r);t=new Re({props:{content:r[26].t("Copy"),placement:"bottom",$$slots:{default:[ta]},$$scope:{ctx:r}}}),s=new Re({props:{content:r[26].t("Read Aloud"),placement:"bottom",$$slots:{default:[na]},$$scope:{ctx:r}}});let c=((_=r[25])==null?void 0:_.features.enable_image_generation)&&(r[27].role==="admin"||((I=(p=(y=r[27])==null?void 0:y.permissions)==null?void 0:p.features)==null?void 0:I.image_generation))&&!r[11]&&Es(r),m=r[12].usage&&Ns(r),g=!r[11]&&Ds(r);return{c(){u&&u.c(),e=H(),X(t.$$.fragment),l=H(),X(s.$$.fragment),n=H(),c&&c.c(),i=H(),m&&m.c(),o=H(),g&&g.c(),a=ae()},l(k){u&&u.l(k),e=z(k),$(t.$$.fragment,k),l=z(k),$(s.$$.fragment,k),n=z(k),c&&c.l(k),i=z(k),m&&m.l(k),o=z(k),g&&g.l(k),a=ae()},m(k,T){u&&u.m(k,T),V(k,e,T),x(t,k,T),V(k,l,T),x(s,k,T),V(k,n,T),c&&c.m(k,T),V(k,i,T),m&&m.m(k,T),V(k,o,T),g&&g.m(k,T),V(k,a,T),f=!0},p(k,T){var M,S,O,C;k[11]?u&&(se(),D(u,1,1,()=>{u=null}),re()):u?(u.p(k,T),T[0]&2048&&b(u,1)):(u=Is(k),u.c(),b(u,1),u.m(e.parentNode,e));const L={};T[0]&67108864&&(L.content=k[26].t("Copy")),T[0]&5120|T[2]&67108864&&(L.$$scope={dirty:T,ctx:k}),t.$set(L);const B={};T[0]&67108864&&(B.content=k[26].t("Read Aloud")),T[0]&1577984|T[2]&67108864&&(B.$$scope={dirty:T,ctx:k}),s.$set(B),(M=k[25])!=null&&M.features.enable_image_generation&&(k[27].role==="admin"||(C=(O=(S=k[27])==null?void 0:S.permissions)==null?void 0:O.features)!=null&&C.image_generation)&&!k[11]?c?(c.p(k,T),T[0]&167774208&&b(c,1)):(c=Es(k),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(se(),D(c,1,1,()=>{c=null}),re()),k[12].usage?m?(m.p(k,T),T[0]&4096&&b(m,1)):(m=Ns(k),m.c(),b(m,1),m.m(o.parentNode,o)):m&&(se(),D(m,1,1,()=>{m=null}),re()),k[11]?g&&(se(),D(g,1,1,()=>{g=null}),re()):g?(g.p(k,T),T[0]&2048&&b(g,1)):(g=Ds(k),g.c(),b(g,1),g.m(a.parentNode,a))},i(k){f||(b(u),b(t.$$.fragment,k),b(s.$$.fragment,k),b(c),b(m),b(g),f=!0)},o(k){D(u),D(t.$$.fragment,k),D(s.$$.fragment,k),D(c),D(m),D(g),f=!1},d(k){k&&(h(e),h(l),h(n),h(i),h(o),h(a)),u&&u.d(k),ee(t,k),ee(s,k),c&&c.d(k),m&&m.d(k),g&&g.d(k)}}}function Is(r){var s,n,i;let e,t,l=(r[27].role==="user"?((i=(n=(s=r[27])==null?void 0:s.permissions)==null?void 0:n.chat)==null?void 0:i.edit)??!0:!0)&&Ms(r);return{c(){l&&l.c(),e=ae()},l(o){l&&l.l(o),e=ae()},m(o,a){l&&l.m(o,a),V(o,e,a),t=!0},p(o,a){var f,u,c;o[27].role!=="user"||(((c=(u=(f=o[27])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:c.edit)??!0)?l?(l.p(o,a),a[0]&134217728&&b(l,1)):(l=Ms(o),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),re())},i(o){t||(b(l),t=!0)},o(o){D(l),t=!1},d(o){o&&h(e),l&&l.d(o)}}}function Ms(r){let e,t;return e=new Re({props:{content:r[26].t("Edit"),placement:"bottom",$$slots:{default:[ea]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&67108864&&(n.content=l[26].t("Edit")),s[0]&1024|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ea(r){let e,t,l,s,n,i;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=w(e);t=be(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=be(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),f.forEach(h),a.forEach(h),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){V(o,e,a),v(e,t),v(t,l),n||(i=me(e,"click",r[62]),n=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",s)},d(o){o&&h(e),n=!1,i()}}}function ta(r){let e,t,l,s,n,i;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=w(e);t=be(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=be(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),f.forEach(h),a.forEach(h),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){V(o,e,a),v(e,t),v(t,l),n||(i=me(e,"click",r[63]),n=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&d(e,"class",s)},d(o){o&&h(e),n=!1,i()}}}function la(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){V(l,e,s),v(e,t)},d(l){l&&h(e)}}}function sa(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){V(l,e,s),v(e,t)},d(l){l&&h(e)}}}function ra(r){let e,t,l,s,n,i;return{c(){e=pe("svg"),t=pe("style"),l=U(`.spinner_S1WN {\r
														animation: spinner_MGfb 0.8s linear infinite;\r
														animation-delay: -0.8s;\r
													}\r
\r
													.spinner_Km9P {\r
														animation-delay: -0.65s;\r
													}\r
\r
													.spinner_JApP {\r
														animation-delay: -0.5s;\r
													}\r
\r
													@keyframes spinner_MGfb {\r
														93.75%,\r
														100% {\r
															opacity: 0.2;\r
														}\r
													}\r
												`),s=pe("circle"),n=pe("circle"),i=pe("circle"),this.h()},l(o){e=be(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=w(e);t=be(a,"style",{});var f=w(t);l=q(f,`.spinner_S1WN {\r
														animation: spinner_MGfb 0.8s linear infinite;\r
														animation-delay: -0.8s;\r
													}\r
\r
													.spinner_Km9P {\r
														animation-delay: -0.65s;\r
													}\r
\r
													.spinner_JApP {\r
														animation-delay: -0.5s;\r
													}\r
\r
													@keyframes spinner_MGfb {\r
														93.75%,\r
														100% {\r
															opacity: 0.2;\r
														}\r
													}\r
												`),f.forEach(h),s=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(h),n=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(n).forEach(h),i=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(i).forEach(h),a.forEach(h),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(n,"class","spinner_S1WN spinner_Km9P"),d(n,"cx","12"),d(n,"cy","12"),d(n,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),v(e,t),v(t,l),v(e,s),v(e,n),v(e,i)},d(o){o&&h(e)}}}function na(r){let e,t,l,s,n;function i(f,u){return f[20]?ra:f[19]?sa:la}let o=i(r),a=o(r);return{c(){e=E("button"),a.c(),this.h()},l(f){e=N(f,"BUTTON",{id:!0,class:!0});var u=w(e);a.l(u),u.forEach(h),this.h()},h(){d(e,"id",t="speak-button-"+r[12].id),d(e,"class",l=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){V(f,e,u),a.m(e,null),s||(n=me(e,"click",r[64]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&4096&&t!==(t="speak-button-"+f[12].id)&&d(e,"id",t),u[0]&1024&&l!==(l=(f[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",l)},d(f){f&&h(e),a.d(),s=!1,n()}}}function Es(r){let e,t;return e=new Re({props:{content:r[26].t("Generate Image"),placement:"bottom",$$slots:{default:[aa]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&67108864&&(n.content=l[26].t("Generate Image")),s[0]&2102272|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ia(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width","2.3"),d(e,"stroke","currentColor"),d(e,"class","w-4 h-4")},m(l,s){V(l,e,s),v(e,t)},d(l){l&&h(e)}}}function oa(r){let e,t,l,s,n,i;return{c(){e=pe("svg"),t=pe("style"),l=U(`.spinner_S1WN {\r
															animation: spinner_MGfb 0.8s linear infinite;\r
															animation-delay: -0.8s;\r
														}\r
\r
														.spinner_Km9P {\r
															animation-delay: -0.65s;\r
														}\r
\r
														.spinner_JApP {\r
															animation-delay: -0.5s;\r
														}\r
\r
														@keyframes spinner_MGfb {\r
															93.75%,\r
															100% {\r
																opacity: 0.2;\r
															}\r
														}\r
													`),s=pe("circle"),n=pe("circle"),i=pe("circle"),this.h()},l(o){e=be(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=w(e);t=be(a,"style",{});var f=w(t);l=q(f,`.spinner_S1WN {\r
															animation: spinner_MGfb 0.8s linear infinite;\r
															animation-delay: -0.8s;\r
														}\r
\r
														.spinner_Km9P {\r
															animation-delay: -0.65s;\r
														}\r
\r
														.spinner_JApP {\r
															animation-delay: -0.5s;\r
														}\r
\r
														@keyframes spinner_MGfb {\r
															93.75%,\r
															100% {\r
																opacity: 0.2;\r
															}\r
														}\r
													`),f.forEach(h),s=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(h),n=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(n).forEach(h),i=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(i).forEach(h),a.forEach(h),this.h()},h(){d(s,"class","spinner_S1WN"),d(s,"cx","4"),d(s,"cy","12"),d(s,"r","3"),d(n,"class","spinner_S1WN spinner_Km9P"),d(n,"cx","12"),d(n,"cy","12"),d(n,"r","3"),d(i,"class","spinner_S1WN spinner_JApP"),d(i,"cx","20"),d(i,"cy","12"),d(i,"r","3"),d(e,"class","w-4 h-4"),d(e,"fill","currentColor"),d(e,"viewBox","0 0 24 24"),d(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),v(e,t),v(t,l),v(e,s),v(e,n),v(e,i)},d(o){o&&h(e)}}}function aa(r){let e,t,l,s;function n(a,f){return a[21]?oa:ia}let i=n(r),o=i(r);return{c(){e=E("button"),o.c(),this.h()},l(a){e=N(a,"BUTTON",{class:!0});var f=w(e);o.l(f),f.forEach(h),this.h()},h(){d(e,"class",t=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){V(a,e,f),o.m(e,null),l||(s=me(e,"click",r[65]),l=!0)},p(a,f){i!==(i=n(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&1024&&t!==(t=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&d(e,"class",t)},d(a){a&&h(e),o.d(),l=!1,s()}}}function Ns(r){let e,t;return e=new Re({props:{content:r[12].usage?`<pre>${pt(JSON.stringify(r[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ps).map(As).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[fa]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&4096&&(n.content=l[12].usage?`<pre>${pt(JSON.stringify(l[12].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ps).map(As).join(`
`))}</pre>`:""),s[0]&5120|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function fa(r){let e,t,l,s,n,i,o;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(a){e=N(a,"BUTTON",{class:!0,id:!0});var f=w(e);t=be(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=w(t);l=be(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),d(e,"id",n="info-"+r[12].id)},m(a,f){V(a,e,f),v(e,t),v(t,l),i||(o=me(e,"click",r[66]),i=!0)},p(a,f){f[0]&1024&&s!==(s=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&d(e,"class",s),f[0]&4096&&n!==(n="info-"+a[12].id)&&d(e,"id",n)},d(a){a&&h(e),i=!1,o()}}}function Ds(r){var m;let e,t,l,s,n,i,o,a=!r[28]&&(((m=r[25])==null?void 0:m.features.enable_message_rating)??!0)&&Vs(r),f=r[10]&&Cs(r);l=new Re({props:{content:r[26].t("Regenerate"),placement:"bottom",$$slots:{default:[ha]},$$scope:{ctx:r}}});let u=r[1].length>1&&Ts(r),c=r[10]&&Bs(r);return{c(){a&&a.c(),e=H(),f&&f.c(),t=H(),X(l.$$.fragment),s=H(),u&&u.c(),n=H(),c&&c.c(),i=ae()},l(g){a&&a.l(g),e=z(g),f&&f.l(g),t=z(g),$(l.$$.fragment,g),s=z(g),u&&u.l(g),n=z(g),c&&c.l(g),i=ae()},m(g,_){a&&a.m(g,_),V(g,e,_),f&&f.m(g,_),V(g,t,_),x(l,g,_),V(g,s,_),u&&u.m(g,_),V(g,n,_),c&&c.m(g,_),V(g,i,_),o=!0},p(g,_){var p;!g[28]&&(((p=g[25])==null?void 0:p.features.enable_message_rating)??!0)?a?(a.p(g,_),_[0]&301989888&&b(a,1)):(a=Vs(g),a.c(),b(a,1),a.m(e.parentNode,e)):a&&(se(),D(a,1,1,()=>{a=null}),re()),g[10]?f?(f.p(g,_),_[0]&1024&&b(f,1)):(f=Cs(g),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(se(),D(f,1,1,()=>{f=null}),re());const y={};_[0]&67108864&&(y.content=g[26].t("Regenerate")),_[0]&4265216|_[2]&67108864&&(y.$$scope={dirty:_,ctx:g}),l.$set(y),g[1].length>1?u?(u.p(g,_),_[0]&2&&b(u,1)):(u=Ts(g),u.c(),b(u,1),u.m(n.parentNode,n)):u&&(se(),D(u,1,1,()=>{u=null}),re()),g[10]?c?(c.p(g,_),_[0]&1024&&b(c,1)):(c=Bs(g),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(se(),D(c,1,1,()=>{c=null}),re())},i(g){o||(b(a),b(f),b(l.$$.fragment,g),b(u),b(c),o=!0)},o(g){D(a),D(f),D(l.$$.fragment,g),D(u),D(c),o=!1},d(g){g&&(h(e),h(t),h(s),h(n),h(i)),a&&a.d(g),f&&f.d(g),ee(l,g),u&&u.d(g),c&&c.d(g)}}}function Vs(r){let e,t,l,s;return e=new Re({props:{content:r[26].t("Good Response"),placement:"bottom",$$slots:{default:[ua]},$$scope:{ctx:r}}}),l=new Re({props:{content:r[26].t("Bad Response"),placement:"bottom",$$slots:{default:[ca]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment),t=H(),X(l.$$.fragment)},l(n){$(e.$$.fragment,n),t=z(n),$(l.$$.fragment,n)},m(n,i){x(e,n,i),V(n,t,i),x(l,n,i),s=!0},p(n,i){const o={};i[0]&67108864&&(o.content=n[26].t("Good Response")),i[0]&8393728|i[2]&67108864&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const a={};i[0]&67108864&&(a.content=n[26].t("Bad Response")),i[0]&8393728|i[2]&67108864&&(a.$$scope={dirty:i,ctx:n}),l.$set(a)},i(n){s||(b(e.$$.fragment,n),b(l.$$.fragment,n),s=!0)},o(n){D(e.$$.fragment,n),D(l.$$.fragment,n),s=!1},d(n){n&&h(t),ee(e,n),ee(l,n)}}}function ua(r){let e,t,l,s,n,i;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=w(e);t=be(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=w(t);l=be(f,"path",{d:!0}),w(l).forEach(h),f.forEach(h),a.forEach(h),this.h()},h(){var o,a;d(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=r[12])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[23]},m(o,a){V(o,e,a),v(e,t),v(t,l),n||(i=me(e,"click",r[67]),n=!0)},p(o,a){var f,u;a[0]&5120&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&8388608&&(e.disabled=o[23])},d(o){o&&h(e),n=!1,i()}}}function ca(r){let e,t,l,s,n,i;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(o){e=N(o,"BUTTON",{class:!0});var a=w(e);t=be(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=w(t);l=be(f,"path",{d:!0}),w(l).forEach(h),f.forEach(h),a.forEach(h),this.h()},h(){var o,a;d(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),d(t,"stroke","currentColor"),d(t,"fill","none"),d(t,"stroke-width","2.3"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"class","w-4 h-4"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=r[12])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[23]},m(o,a){V(o,e,a),v(e,t),v(t,l),n||(i=me(e,"click",r[68]),n=!0)},p(o,a){var f,u;a[0]&5120&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[12])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&d(e,"class",s),a[0]&8388608&&(e.disabled=o[23])},d(o){o&&h(e),n=!1,i()}}}function Cs(r){let e,t;return e=new Re({props:{content:r[26].t("Continue Response"),placement:"bottom",$$slots:{default:[da]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&67108864&&(n.content=l[26].t("Continue Response")),s[0]&1152|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function da(r){let e,t,l,s,n,i,o;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),s=pe("path"),this.h()},l(a){e=N(a,"BUTTON",{type:!0,id:!0,class:!0});var f=w(e);t=be(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=w(t);l=be(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),s=be(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(s).forEach(h),u.forEach(h),f.forEach(h),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),d(s,"stroke-linecap","round"),d(s,"stroke-linejoin","round"),d(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",n=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){V(a,e,f),v(e,t),v(t,l),v(t,s),i||(o=me(e,"click",r[69]),i=!0)},p(a,f){f[0]&1024&&n!==(n=(a[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",n)},d(a){a&&h(e),i=!1,o()}}}function ha(r){let e,t,l,s,n,i;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(o){e=N(o,"BUTTON",{type:!0,class:!0});var a=w(e);t=be(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=be(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),f.forEach(h),a.forEach(h),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2.3"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),v(e,t),v(t,l),n||(i=me(e,"click",r[70]),n=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&h(e),n=!1,i()}}}function Ts(r){let e,t;return e=new Re({props:{content:r[26].t("Delete"),placement:"bottom",$$slots:{default:[ma]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&67108864&&(n.content=l[26].t("Delete")),s[0]&33792|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ma(r){let e,t,l,s,n,i;return{c(){e=E("button"),t=pe("svg"),l=pe("path"),this.h()},l(o){e=N(o,"BUTTON",{type:!0,id:!0,class:!0});var a=w(e);t=be(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=be(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(h),f.forEach(h),a.forEach(h),this.h()},h(){d(l,"stroke-linecap","round"),d(l,"stroke-linejoin","round"),d(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),d(t,"xmlns","http://www.w3.org/2000/svg"),d(t,"fill","none"),d(t,"viewBox","0 0 24 24"),d(t,"stroke-width","2"),d(t,"stroke","currentColor"),d(t,"class","w-4 h-4"),d(e,"type","button"),d(e,"id","continue-response-button"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),v(e,t),v(t,l),n||(i=me(e,"click",r[71]),n=!0)},p(o,a){a[0]&1024&&s!==(s=(o[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&d(e,"class",s)},d(o){o&&h(e),n=!1,i()}}}function Bs(r){var i;let e,t,l=Ee(((i=r[16])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Ss(os(r,l,o));const n=o=>D(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ae()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ae()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);V(o,e,a),t=!0},p(o,a){var f;if(a[0]&70688){l=Ee(((f=o[16])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=os(o,l,u);s[u]?(s[u].p(c,a),b(s[u],1)):(s[u]=Ss(c),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(se(),u=l.length;u<s.length;u+=1)n(u);re()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(o){o&&h(e),qe(s,o)}}}function ga(r){let e,t;return e=new yi({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function _a(r){let e,t,l,s,n;return{c(){e=E("div"),t=E("img"),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=w(e);t=N(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(h),this.h()},h(){Ot(t.src,l=r[81].icon_url)||d(t,"src",l),d(t,"class",s="w-4 h-4 "+(r[81].icon_url.includes("svg")?"dark:invert-[80%]":"")),Rt(t,"fill","currentColor"),d(t,"alt",n=r[81].name),d(e,"class","size-4")},m(i,o){V(i,e,o),v(e,t)},p(i,o){o[0]&65536&&!Ot(t.src,l=i[81].icon_url)&&d(t,"src",l),o[0]&65536&&s!==(s="w-4 h-4 "+(i[81].icon_url.includes("svg")?"dark:invert-[80%]":""))&&d(t,"class",s),o[0]&65536&&n!==(n=i[81].name)&&d(t,"alt",n)},i:ve,o:ve,d(i){i&&h(e)}}}function va(r){let e,t,l,s,n,i,o,a;const f=[_a,ga],u=[];function c(g,_){return g[81].icon_url?0:1}t=c(r),l=u[t]=f[t](r);function m(){return r[72](r[81])}return{c(){e=E("button"),l.c(),n=H(),this.h()},l(g){e=N(g,"BUTTON",{type:!0,class:!0});var _=w(e);l.l(_),_.forEach(h),n=z(g),this.h()},h(){d(e,"type","button"),d(e,"class",s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(g,_){V(g,e,_),u[t].m(e,null),V(g,n,_),i=!0,o||(a=me(e,"click",m),o=!0)},p(g,_){r=g;let y=t;t=c(r),t===y?u[t].p(r,_):(se(),D(u[y],1,1,()=>{u[y]=null}),re(),l=u[t],l?l.p(r,_):(l=u[t]=f[t](r),l.c()),b(l,1),l.m(e,null)),(!i||_[0]&1024&&s!==(s=(r[10]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&d(e,"class",s)},i(g){i||(b(l),i=!0)},o(g){D(l),i=!1},d(g){g&&(h(e),h(n)),u[t].d(),o=!1,a()}}}function Ss(r){let e,t;return e=new Re({props:{content:r[81].name,placement:"bottom",$$slots:{default:[va]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&65536&&(n.content=l[81].name),s[0]&70688|s[2]&67108864&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Rs(r){let e,t,l,s;function n(a){r[74](a)}function i(a){r[75](a)}let o={};return r[12]!==void 0&&(o.message=r[12]),r[22]!==void 0&&(o.show=r[22]),e=new di({props:o}),Ae.push(()=>Ke(e,"message",n)),Ae.push(()=>Ke(e,"show",i)),e.$on("save",r[76]),{c(){X(e.$$.fragment)},l(a){$(e.$$.fragment,a)},m(a,f){x(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&4096&&(t=!0,u.message=a[12],Ze(()=>t=!1)),!l&&f[0]&4194304&&(l=!0,u.show=a[22],Ze(()=>l=!1)),e.$set(u)},i(a){s||(b(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){ee(e,a)}}}function Os(r){var le,de,te,ne,ue,he,ke,Q;let e,t,l,s,n,i,o,a,f,u=((le=r[12])==null?void 0:le.files)&&((de=r[12].files)==null?void 0:de.filter(Ls).length)>0,c,m,g,_,y,p,I,k,T,L,B,M;l=new Dr({props:{src:((ue=(ne=(te=r[16])==null?void 0:te.info)==null?void 0:ne.meta)==null?void 0:ue.profile_image_url)??(r[26].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`),className:"size-8"}}),o=new Kt({props:{$$slots:{default:[Ao]},$$scope:{ctx:r}}});let S=u&&us(r),O=(((he=r[12])==null?void 0:he.statusHistory)??[...(ke=r[12])!=null&&ke.status?[(Q=r[12])==null?void 0:Q.status]:[]]).length>0&&hs(Ut(r));const C=[Xo,Yo],P=[];function R(F,A){return F[13]===!0?0:1}y=R(r),p=P[y]=C[y](r);let W=!r[13]&&bs(r);return{c(){e=E("div"),t=E("div"),X(l.$$.fragment),n=H(),i=E("div"),X(o.$$.fragment),a=H(),f=E("div"),S&&S.c(),c=H(),m=E("div"),g=E("div"),O&&O.c(),_=H(),p.c(),k=H(),W&&W.c(),this.h()},l(F){e=N(F,"DIV",{class:!0,id:!0,dir:!0});var A=w(e);t=N(A,"DIV",{class:!0});var fe=w(t);$(l.$$.fragment,fe),fe.forEach(h),n=z(A),i=N(A,"DIV",{class:!0});var ie=w(i);$(o.$$.fragment,ie),a=z(ie),f=N(ie,"DIV",{});var ge=w(f);S&&S.l(ge),c=z(ge),m=N(ge,"DIV",{class:!0});var ye=w(m);g=N(ye,"DIV",{});var _e=w(g);O&&O.l(_e),_=z(_e),p.l(_e),_e.forEach(h),ye.forEach(h),k=z(ge),W&&W.l(ge),ge.forEach(h),ie.forEach(h),A.forEach(h),this.h()},h(){var F;d(t,"class",s=ul(`shrink-0 ${(((F=r[24])==null?void 0:F.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),d(m,"class",I="chat-"+r[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),d(i,"class","flex-auto w-0 pl-1"),d(e,"class",T="flex w-full message-"+r[12].id+" svelte-1u5gq5j"),d(e,"id",L="message-"+r[12].id),d(e,"dir",B=r[24].chatDirection)},m(F,A){V(F,e,A),v(e,t),x(l,t,null),v(e,n),v(e,i),x(o,i,null),v(i,a),v(i,f),S&&S.m(f,null),v(f,c),v(f,m),v(m,g),O&&O.m(g,null),v(g,_),P[y].m(g,null),v(f,k),W&&W.m(f,null),M=!0},p(F,A){var ye,_e,oe,j,K,Y,G,ce,we;const fe={};A[0]&67174400&&(fe.src=((oe=(_e=(ye=F[16])==null?void 0:ye.info)==null?void 0:_e.meta)==null?void 0:oe.profile_image_url)??(F[26].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`)),l.$set(fe),(!M||A[0]&16777216&&s!==(s=ul(`shrink-0 ${(((j=F[24])==null?void 0:j.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&d(t,"class",s);const ie={};A[0]&69632|A[2]&67108864&&(ie.$$scope={dirty:A,ctx:F}),o.$set(ie),A[0]&4096&&(u=((K=F[12])==null?void 0:K.files)&&((Y=F[12].files)==null?void 0:Y.filter(Ls).length)>0),u?S?(S.p(F,A),A[0]&4096&&b(S,1)):(S=us(F),S.c(),b(S,1),S.m(f,c)):S&&(se(),D(S,1,1,()=>{S=null}),re()),(((G=F[12])==null?void 0:G.statusHistory)??[...(ce=F[12])!=null&&ce.status?[(we=F[12])==null?void 0:we.status]:[]]).length>0?O?(O.p(Ut(F),A),A[0]&4096&&b(O,1)):(O=hs(Ut(F)),O.c(),b(O,1),O.m(g,_)):O&&(se(),D(O,1,1,()=>{O=null}),re());let ge=y;y=R(F),y===ge?P[y].p(F,A):(se(),D(P[ge],1,1,()=>{P[ge]=null}),re(),p=P[y],p?p.p(F,A):(p=P[y]=C[y](F),p.c()),b(p,1),p.m(g,null)),(!M||A[0]&4096&&I!==(I="chat-"+F[12].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&d(m,"class",I),F[13]?W&&(se(),D(W,1,1,()=>{W=null}),re()):W?(W.p(F,A),A[0]&8192&&b(W,1)):(W=bs(F),W.c(),b(W,1),W.m(f,null)),(!M||A[0]&4096&&T!==(T="flex w-full message-"+F[12].id+" svelte-1u5gq5j"))&&d(e,"class",T),(!M||A[0]&4096&&L!==(L="message-"+F[12].id))&&d(e,"id",L),(!M||A[0]&16777216&&B!==(B=F[24].chatDirection))&&d(e,"dir",B)},i(F){M||(b(l.$$.fragment,F),b(o.$$.fragment,F),b(S),b(O),b(p),b(W),M=!0)},o(F){D(l.$$.fragment,F),D(o.$$.fragment,F),D(S),D(O),D(p),D(W),M=!1},d(F){F&&h(e),ee(l),ee(o),S&&S.d(),O&&O.d(),P[y].d(),W&&W.d()}}}function pa(r){let e,t,l,s=r[12].id,n,i;function o(u){r[47](u)}let a={title:r[26].t("Delete message?")};r[15]!==void 0&&(a.show=r[15]),e=new Sr({props:a}),Ae.push(()=>Ke(e,"show",o)),e.$on("confirm",r[48]);let f=Os(r);return{c(){X(e.$$.fragment),l=H(),f.c(),n=ae()},l(u){$(e.$$.fragment,u),l=z(u),f.l(u),n=ae()},m(u,c){x(e,u,c),V(u,l,c),f.m(u,c),V(u,n,c),i=!0},p(u,c){const m={};c[0]&67108864&&(m.title=u[26].t("Delete message?")),!t&&c[0]&32768&&(t=!0,m.show=u[15],Ze(()=>t=!1)),e.$set(m),c[0]&4096&&Ve(s,s=u[12].id)?(se(),D(f,1,1,ve),re(),f=Os(u),f.c(),b(f,1),f.m(n.parentNode,n)):f.p(u,c)},i(u){i||(b(e.$$.fragment,u),b(f),i=!0)},o(u){D(e.$$.fragment,u),D(f),i=!1},d(u){u&&(h(l),h(n)),ee(e,u),f.d(u)}}}const Ls=r=>r.type==="image",ba=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`},Ps=r=>r.slice(2),As=r=>r.endsWith(",")?r.slice(0,-1):r;function ka(r,e,t){let l,s,n,i,o,a,f;Me(r,jt,J=>t(46,l=J)),Me(r,Ht,J=>t(24,s=J)),Me(r,Mr,J=>t(25,n=J)),Me(r,hl,J=>t(79,i=J)),Me(r,zt,J=>t(27,a=J)),Me(r,Zt,J=>t(28,f=J));const u=Ue("i18n");Me(r,u,J=>t(26,o=J));const c=gt();let{chatId:m=""}=e,{history:g}=e,{messageId:_}=e,y=JSON.parse(JSON.stringify(g.messages[_])),{siblings:p}=e,{showPreviousMessage:I}=e,{showNextMessage:k}=e,{updateChat:T}=e,{editMessage:L}=e,{saveMessage:B}=e,{rateMessage:M}=e,{actionMessage:S}=e,{deleteMessage:O}=e,{submitMessage:C}=e,{continueResponse:P}=e,{regenerateResponse:R}=e,{addMessages:W}=e,{isLastMessage:le=!0}=e,{readOnly:de=!1}=e,te,ne=!1,ue=null,he=!1,ke="",Q,F={},A=!1,fe,ie=!1,ge=!1,ye=!1;const _e=async J=>{await Er(J)&&Pe.success(o.t("Copying to clipboard was successful!"))},oe=J=>new Promise(Ne=>{fe=J;const Ie=F[J];if(!Ie)return Ne();Ie.play(),Ie.onended=async()=>{await new Promise(Le=>setTimeout(Le,300)),Object.keys(F).length-1===J&&t(19,A=!1),Ne()}}),j=async()=>{var J,Ne,Ie,Le,Je,Xe,Vt,ct,kt,Oe,Ge,rt,wt,Ct,Xt,$t,xt,el,tl,ll,sl,rl,nl;if(A){try{speechSynthesis.cancel(),fe!==void 0&&F[fe]&&(F[fe].pause(),F[fe].currentTime=0)}catch{}t(19,A=!1),fe=void 0;return}if(!((y==null?void 0:y.content)??"").trim().length){Pe.info(o.t("No content to speak"));return}if(t(19,A=!0),n.audio.tts.engine===""){let Qe=[];const _t=setInterval(()=>{var Ye,dt,$e;if(Qe=speechSynthesis.getVoices(),Qe.length>0){clearInterval(_t);const We=((Ye=Qe==null?void 0:Qe.filter(mt=>{var il,ol,al,fl;return mt.voiceURI===(((ol=(il=s==null?void 0:s.audio)==null?void 0:il.tts)==null?void 0:ol.voice)??((fl=(al=n==null?void 0:n.audio)==null?void 0:al.tts)==null?void 0:fl.voice))}))==null?void 0:Ye.at(0))??void 0;console.log(We);const ht=new SpeechSynthesisUtterance(y.content);ht.rate=(($e=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:$e.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(19,A=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},We&&(ht.voice=We),speechSynthesis.speak(ht)}},100)}else{t(20,ie=!0);const Qe=_n(y.content,((Ne=(J=n==null?void 0:n.audio)==null?void 0:J.tts)==null?void 0:Ne.split_on)??"punctuation");if(!Qe.length){console.log("No content to speak"),Pe.info(o.t("No content to speak")),t(19,A=!1),t(20,ie=!1);return}console.debug("Prepared message content for TTS",Qe),F=Qe.reduce((Ye,dt,$e)=>(Ye[$e]=null,Ye),{});let _t=Promise.resolve();if(((Le=(Ie=s.audio)==null?void 0:Ie.tts)==null?void 0:Le.engine)==="browser-kokoro"){i||(await hl.set(new Sn({dtype:((Vt=(Xe=(Je=s.audio)==null?void 0:Je.tts)==null?void 0:Xe.engineConfig)==null?void 0:Vt.dtype)??"fp32"})),await i.init());for(const[Ye,dt]of Qe.entries()){const $e=await i.generate({text:dt,voice:((kt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:kt.voice)??((Ge=(Oe=n==null?void 0:n.audio)==null?void 0:Oe.tts)==null?void 0:Ge.voice)}).catch(We=>{console.error(We),Pe.error(`${We}`),t(19,A=!1),t(20,ie=!1)});if($e){const We=new Audio($e);We.playbackRate=((wt=(rt=s.audio)==null?void 0:rt.tts)==null?void 0:wt.playbackRate)??1,F[Ye]=We,t(20,ie=!1),_t=_t.then(()=>oe(Ye))}}}else for(const[Ye,dt]of Qe.entries()){const $e=await bn(localStorage.token,((Xt=(Ct=s==null?void 0:s.audio)==null?void 0:Ct.tts)==null?void 0:Xt.defaultVoice)===n.audio.tts.voice?((xt=($t=s==null?void 0:s.audio)==null?void 0:$t.tts)==null?void 0:xt.voice)??((tl=(el=n==null?void 0:n.audio)==null?void 0:el.tts)==null?void 0:tl.voice):(sl=(ll=n==null?void 0:n.audio)==null?void 0:ll.tts)==null?void 0:sl.voice,dt).catch(We=>{console.error(We),Pe.error(`${We}`),t(19,A=!1),t(20,ie=!1)});if($e){const We=await $e.blob(),ht=URL.createObjectURL(We),mt=new Audio(ht);mt.playbackRate=((nl=(rl=s.audio)==null?void 0:rl.tts)==null?void 0:nl.playbackRate)??1,F[Ye]=mt,t(20,ie=!1),_t=_t.then(()=>oe(Ye))}}}},K=async()=>{t(13,he=!0),t(17,ke=y.content),await De(),t(18,Q.style.height="",Q),t(18,Q.style.height=`${Q.scrollHeight}px`,Q)},Y=async()=>{L(y.id,ke||"",!1),t(13,he=!1),t(17,ke=""),await De()},G=async()=>{L(y.id,ke||""),t(13,he=!1),t(17,ke=""),await De()},ce=async()=>{t(13,he=!1),t(17,ke=""),await De()},we=async J=>{t(21,ge=!0);const Ne=await kn(localStorage.token,J.content).catch(Ie=>{Pe.error(`${Ie}`)});if(console.log(Ne),Ne){const Ie=Ne.map(Le=>({type:"image",url:`${Le.url}`}));B(J.id,{...J,files:Ie})}t(21,ge=!1)};let Ce=!1;const Te=async(J=null,Ne=null)=>{var kt;t(23,Ce=!0),console.log("Feedback",J,Ne);const Ie={...y,annotation:{...(y==null?void 0:y.annotation)??{},...J!==null?{rating:J}:{},...Ne||{}}},Le=await hn(localStorage.token,m).catch(Oe=>{Pe.error(`${Oe}`)});if(!Le)return;const Je=Jt(g,y.id);let Xe={type:"rating",data:{...Ie!=null&&Ie.annotation?Ie.annotation:{},model_id:(y==null?void 0:y.selectedModelId)??y.model,...g.messages[y.parentId].childrenIds.length>1?{sibling_model_ids:g.messages[y.parentId].childrenIds.filter(Oe=>Oe!==y.id).map(Oe=>{var Ge;return((Ge=g.messages[Oe])==null?void 0:Ge.selectedModelId)??g.messages[Oe].model})}:{}},meta:{arena:y?y.arena:!1,model_id:y.model,message_id:y.id,message_index:Je.length,chat_id:m},snapshot:{chat:Le}};const Vt=[Xe.data.model_id,...Xe.data.sibling_model_ids??[]].reduce((Oe,Ge)=>{var wt;const rt=l.find(Ct=>Ct.id===Ge);return rt?Oe[rt.id]=((wt=rt==null?void 0:rt.info)==null?void 0:wt.base_model_id)??null:console.warn(`Model with ID ${Ge} not found`),Oe},{});Xe.meta.base_models=Vt;let ct=null;if(y!=null&&y.feedbackId?ct=await _l(localStorage.token,y.feedbackId,Xe).catch(Oe=>{Pe.error(`${Oe}`)}):(ct=await vn(localStorage.token,Xe).catch(Oe=>{Pe.error(`${Oe}`)}),ct&&(Ie.feedbackId=ct.id)),console.log(Ie),B(y.id,Ie),await De(),!Ne&&(t(22,ye=!0),!((kt=Ie.annotation)!=null&&kt.tags))){const Oe=await pn(localStorage.token,y.model,Je,m).catch(Ge=>(console.error(Ge),[]));console.log(Oe),Oe&&(Ie.annotation.tags=Oe,Xe.data.tags=Oe,B(y.id,Ie),await _l(localStorage.token,Ie.feedbackId,Xe).catch(Ge=>{Pe.error(`${Ge}`)}))}t(23,Ce=!1)},je=async()=>{O(y.id)};bt(async()=>{await De(),te&&(console.log(te),te.addEventListener("wheel",function(J){J.preventDefault(),J.deltaY!==0&&t(14,te.scrollLeft+=J.deltaY,te)}))});function ze(J){ne=J,t(15,ne)}const Fe=()=>{je()};function tt(J){Ae[J?"unshift":"push"](()=>{Q=J,t(18,Q)})}function lt(){ke=this.value,t(17,ke)}const ot=J=>{var Le,Je;J.key==="Escape"&&((Le=document.getElementById("close-edit-message-button"))==null||Le.click());const Ne=J.metaKey||J.ctrlKey,Ie=J.key==="Enter";Ne&&Ie&&((Je=document.getElementById("confirm-edit-message-button"))==null||Je.click())},at=()=>{G()},xe=()=>{ce()},ft=()=>{Y()},ut=async J=>{console.log(J)},st=async(J,Ne)=>{console.log(J,Ne);let Ie=document.getElementById(`source-${y.id}-${Ne}`);const Le=document.getElementById("collapsible-sources");Ie?Ie.click():Le&&(Le.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Je=>{requestAnimationFrame(()=>{requestAnimationFrame(Je)})}),Ie=document.getElementById(`source-${y.id}-${Ne}`),Ie&&Ie.click())},It=({modelId:J,parentId:Ne,messages:Ie})=>{W({modelId:J,parentId:Ne,messages:Ie})},Mt=J=>{const{raw:Ne,oldContent:Ie,newContent:Le}=J.detail;t(0,g.messages[y.id].content=g.messages[y.id].content.replace(Ne,Ne.replace(Ie,Le)),g),T()},Et=J=>{var Le;const{type:Ne,content:Ie}=J.detail;if(Ne==="explain")C(y.id,`Explain this section to me in more detail

\`\`\`
${Ie}
\`\`\``);else if(Ne==="ask"){const Je=((Le=J.detail)==null?void 0:Le.input)??"";C(y.id,`\`\`\`
${Ie}
\`\`\`
${Je}`)}},Nt=()=>{I(y)},Dt=()=>{k(y)},Lr=()=>{K()},Pr=()=>{_e(y.content)},Ar=()=>{ie||j()},jr=()=>{ge||we(y)},Hr=()=>{console.log(y)},zr=async()=>{await Te(1),window.setTimeout(()=>{var J;(J=document.getElementById(`message-feedback-${y.id}`))==null||J.scrollIntoView()},0)},Wr=async()=>{await Te(-1),window.setTimeout(()=>{var J;(J=document.getElementById(`message-feedback-${y.id}`))==null||J.scrollIntoView()},0)},Ur=()=>{P()},qr=()=>{t(22,ye=!1),R(y),((ue==null?void 0:ue.actions)??[]).forEach(J=>{c("action",{id:J.id,event:{id:"regenerate-response",data:{messageId:y.id}}})})},Fr=()=>{t(15,ne=!0)},Jr=J=>{S(J.id,y)};function Gr(J){Ae[J?"unshift":"push"](()=>{te=J,t(14,te)})}function Zr(J){y=J,t(12,y),t(0,g),t(41,_)}function Kr(J){ye=J,t(22,ye)}const Qr=async J=>{await Te(null,{...J.detail})};return r.$$set=J=>{"chatId"in J&&t(40,m=J.chatId),"history"in J&&t(0,g=J.history),"messageId"in J&&t(41,_=J.messageId),"siblings"in J&&t(1,p=J.siblings),"showPreviousMessage"in J&&t(2,I=J.showPreviousMessage),"showNextMessage"in J&&t(3,k=J.showNextMessage),"updateChat"in J&&t(4,T=J.updateChat),"editMessage"in J&&t(42,L=J.editMessage),"saveMessage"in J&&t(43,B=J.saveMessage),"rateMessage"in J&&t(44,M=J.rateMessage),"actionMessage"in J&&t(5,S=J.actionMessage),"deleteMessage"in J&&t(45,O=J.deleteMessage),"submitMessage"in J&&t(6,C=J.submitMessage),"continueResponse"in J&&t(7,P=J.continueResponse),"regenerateResponse"in J&&t(8,R=J.regenerateResponse),"addMessages"in J&&t(9,W=J.addMessages),"isLastMessage"in J&&t(10,le=J.isLastMessage),"readOnly"in J&&t(11,de=J.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&4097|r.$$.dirty[1]&1024&&g.messages&&JSON.stringify(y)!==JSON.stringify(g.messages[_])&&t(12,y=JSON.parse(JSON.stringify(g.messages[_]))),r.$$.dirty[0]&4096|r.$$.dirty[1]&32768&&t(16,ue=l.find(J=>J.id===y.model)),r.$$.dirty[0]&8192&&(he||(async()=>await De())())},[g,p,I,k,T,S,C,P,R,W,le,de,y,he,te,ne,ue,ke,Q,A,ie,ge,ye,Ce,s,n,o,a,f,u,c,_e,j,K,Y,G,ce,we,Te,je,m,_,L,B,M,O,l,ze,Fe,tt,lt,ot,at,xe,ft,ut,st,It,Mt,Et,Nt,Dt,Lr,Pr,Ar,jr,Hr,zr,Wr,Ur,qr,Fr,Jr,Gr,Zr,Kr,Qr]}class Or extends Be{constructor(e){super(),Se(this,e,ka,pa,Ve,{chatId:40,history:0,messageId:41,siblings:1,showPreviousMessage:2,showNextMessage:3,updateChat:4,editMessage:42,saveMessage:43,rateMessage:44,actionMessage:5,deleteMessage:45,submitMessage:6,continueResponse:7,regenerateResponse:8,addMessages:9,isLastMessage:10,readOnly:11},null,[-1,-1,-1])}}function wa(r){let e,t;return{c(){e=pe("svg"),t=pe("path"),this.h()},l(l){e=be(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=be(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(h),s.forEach(h),this.h()},h(){d(t,"stroke-linecap","round"),d(t,"stroke-linejoin","round"),d(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke-width",r[1]),d(e,"stroke","currentColor"),d(e,"class",r[0])},m(l,s){V(l,e,s),v(e,t)},p(l,[s]){s&2&&d(e,"stroke-width",l[1]),s&1&&d(e,"class",l[0])},i:ve,o:ve,d(l){l&&h(e)}}}function ya(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Ia extends Be{constructor(e){super(),Se(this,e,ya,wa,Ve,{className:0,strokeWidth:1})}}function qt(r){var l;const e=r.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function js(r,e,t){const l=r.slice();return l[36]=e[t],l}function Ft(r){const e=r.slice(),t=e[19][e[36]].messageIds[e[20][e[36]]];return e[39]=t,e}function Hs(r){let e,t,l,s,n,i=Ee(Object.keys(r[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=qs(js(r,i,u));const a=u=>D(o[u],1,1,()=>{o[u]=null});let f=!r[4]&&Fs(r);return{c(){e=E("div"),t=E("div");for(let u=0;u<o.length;u+=1)o[u].c();s=H(),f&&f.c(),this.h()},l(u){e=N(u,"DIV",{});var c=w(e);t=N(c,"DIV",{class:!0,id:!0});var m=w(t);for(let g=0;g<o.length;g+=1)o[g].l(m);m.forEach(h),s=z(c),f&&f.l(c),c.forEach(h),this.h()},h(){d(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),d(t,"id",l="responses-container-"+r[1]+"-"+r[18].id)},m(u,c){V(u,e,c),v(e,t);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(t,null);v(e,s),f&&f.m(e,null),n=!0},p(u,c){if(c[0]&54132727){i=Ee(Object.keys(u[19]));let m;for(m=0;m<i.length;m+=1){const g=js(u,i,m);o[m]?(o[m].p(g,c),b(o[m],1)):(o[m]=qs(g),o[m].c(),b(o[m],1),o[m].m(t,null))}for(se(),m=i.length;m<o.length;m+=1)a(m);re()}(!n||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&d(t,"id",l),u[4]?f&&(se(),D(f,1,1,()=>{f=null}),re()):f?(f.p(u,c),c[0]&16&&b(f,1)):(f=Fs(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!n){for(let c=0;c<i.length;c+=1)b(o[c]);b(f),n=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)D(o[c]);D(f),n=!1},d(u){u&&h(e),qe(o,u),f&&f.d()}}}function zs(r){let e,t=r[0].currentId,l,s,n,i,o,a=Us(r);function f(){return r[32](r[39])}return{c(){e=E("div"),a.c(),l=H(),this.h()},l(u){e=N(u,"DIV",{class:!0});var c=w(e);a.l(c),l=z(c),c.forEach(h),this.h()},h(){var u;d(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=r[0].messages[r[2]])==null?void 0:u.modelIdx)==r[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${r[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${r[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){V(u,e,c),a.m(e,null),v(e,l),n=!0,i||(o=me(e,"click",f),i=!0)},p(u,c){var m;r=u,c[0]&1&&Ve(t,t=r[0].currentId)?(se(),D(a,1,1,ve),re(),a=Us(r),a.c(),b(a,1),a.m(e,l)):a.p(r,c),(!n||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((m=r[0].messages[r[2]])==null?void 0:m.modelIdx)==r[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${r[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${r[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&d(e,"class",s)},i(u){n||(b(a),n=!0)},o(u){D(a),n=!1},d(u){u&&h(e),a.d(u),i=!1,o()}}}function Ws(r){let e,t;function l(){return r[29](r[36])}function s(){return r[30](r[36])}function n(...i){return r[31](r[36],...i)}return e=new Or({props:{chatId:r[1],history:r[0],messageId:r[39],isLastMessage:!0,siblings:r[19][r[36]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:r[5],editMessage:r[6],saveMessage:r[7],rateMessage:r[8],deleteMessage:r[11],actionMessage:r[9],submitMessage:r[10],continueResponse:r[12],regenerateResponse:n,addMessages:r[14],readOnly:r[4]}}),{c(){X(e.$$.fragment)},l(i){$(e.$$.fragment,i)},m(i,o){x(e,i,o),t=!0},p(i,o){r=i;const a={};o[0]&2&&(a.chatId=r[1]),o[0]&1&&(a.history=r[0]),o[0]&1572864&&(a.messageId=r[39]),o[0]&524288&&(a.siblings=r[19][r[36]].messageIds),o[0]&524288&&(a.showPreviousMessage=l),o[0]&524288&&(a.showNextMessage=s),o[0]&32&&(a.updateChat=r[5]),o[0]&64&&(a.editMessage=r[6]),o[0]&128&&(a.saveMessage=r[7]),o[0]&256&&(a.rateMessage=r[8]),o[0]&2048&&(a.deleteMessage=r[11]),o[0]&512&&(a.actionMessage=r[9]),o[0]&1024&&(a.submitMessage=r[10]),o[0]&4096&&(a.continueResponse=r[12]),o[0]&1581056&&(a.regenerateResponse=n),o[0]&16384&&(a.addMessages=r[14]),o[0]&16&&(a.readOnly=r[4]),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){ee(e,i)}}}function Us(r){let e,t,l=r[16]&&Ws(r);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,n){l&&l.m(s,n),V(s,e,n),t=!0},p(s,n){s[16]?l?(l.p(s,n),n[0]&65536&&b(l,1)):(l=Ws(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),re())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function qs(r){let e,t,l=r[20][r[36]]!==void 0&&r[19][r[36]].messageIds.length>0&&zs(Ft(r));return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,n){l&&l.m(s,n),V(s,e,n),t=!0},p(s,n){s[20][s[36]]!==void 0&&s[19][s[36]].messageIds.length>0?l?(l.p(Ft(s),n),n[0]&1572864&&b(l,1)):(l=zs(Ft(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),re())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function Fs(r){let e=!Object.keys(r[19]).find(r[28]),t,l,s=e&&Js(r);return{c(){s&&s.c(),t=ae()},l(n){s&&s.l(n),t=ae()},m(n,i){s&&s.m(n,i),V(n,t,i),l=!0},p(n,i){i[0]&1572865&&(e=!Object.keys(n[19]).find(n[28])),e?s?(s.p(n,i),i[0]&1572865&&b(s,1)):(s=Js(n),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(se(),D(s,1,1,()=>{s=null}),re())},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&h(t),s&&s.d(n)}}}function Js(r){var o,a;let e,t,l,s,n=((a=(o=r[0].messages[r[2]])==null?void 0:o.merged)==null?void 0:a.status)&&Gs(qt(r)),i=r[3]&&Ks(r);return{c(){e=E("div"),t=E("div"),n&&n.c(),l=H(),i&&i.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=w(e);t=N(u,"DIV",{class:!0});var c=w(t);n&&n.l(c),c.forEach(h),l=z(u),i&&i.l(u),u.forEach(h),this.h()},h(){d(t,"class","w-full"),d(e,"class","flex justify-end")},m(f,u){V(f,e,u),v(e,t),n&&n.m(t,null),v(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,m;(m=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&m.status?n?(n.p(qt(f),u),u[0]&5&&b(n,1)):(n=Gs(qt(f)),n.c(),b(n,1),n.m(t,null)):n&&(se(),D(n,1,1,()=>{n=null}),re()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Ks(f),i.c(),b(i,1),i.m(e,null)):i&&(se(),D(i,1,1,()=>{i=null}),re())},i(f){s||(b(n),b(i),s=!0)},o(f){D(n),D(i),s=!1},d(f){f&&h(e),n&&n.d(),i&&i.d()}}}function Gs(r){let e,t,l,s,n,i,o;t=new Kt({props:{$$slots:{default:[Ma]},$$scope:{ctx:r}}});const a=[Na,Ea],f=[];function u(c,m){var g;return(((g=c[16])==null?void 0:g.content)??"")===""?0:1}return n=u(r),i=f[n]=a[n](r),{c(){e=E("div"),X(t.$$.fragment),l=H(),s=E("div"),i.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var m=w(e);$(t.$$.fragment,m),l=z(m),s=N(m,"DIV",{class:!0});var g=w(s);i.l(g),g.forEach(h),m.forEach(h),this.h()},h(){d(s,"class","mt-1 markdown-prose w-full min-w-full"),d(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,m){V(c,e,m),x(t,e,null),v(e,l),v(e,s),f[n].m(s,null),o=!0},p(c,m){const g={};m[0]&5|m[1]&512&&(g.$$scope={dirty:m,ctx:c}),t.$set(g);let _=n;n=u(c),n===_?f[n].p(c,m):(se(),D(f[_],1,1,()=>{f[_]=null}),re(),i=f[n],i?i.p(c,m):(i=f[n]=a[n](c),i.c()),b(i,1),i.m(s,null))},i(c){o||(b(t.$$.fragment,c),b(i),o=!0)},o(c){D(t.$$.fragment,c),D(i),o=!1},d(c){c&&h(e),ee(t),f[n].d()}}}function Zs(r){let e,t=it(r[16].timestamp*1e3).format("LT")+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n[0]&5&&t!==(t=it(s[16].timestamp*1e3).format("LT")+"")&&Z(l,t)},d(s){s&&h(e)}}}function Ma(r){let e,t,l=r[16].timestamp&&Zs(r);return{c(){e=U(`Merged Response\r
\r
									`),l&&l.c(),t=ae()},l(s){e=q(s,`Merged Response\r
\r
									`),l&&l.l(s),t=ae()},m(s,n){V(s,e,n),l&&l.m(s,n),V(s,t,n)},p(s,n){s[16].timestamp?l?l.p(s,n):(l=Zs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(h(e),h(t)),l&&l.d(s)}}}function Ea(r){let e,t;return e=new yt({props:{id:"merged",content:r[16].content??""}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&5&&(n.content=l[16].content??""),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Na(r){let e,t;return e=new Yt({}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ks(r){let e,t,l;return t=new Re({props:{content:r[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[Da]},$$scope:{ctx:r}}}),{c(){e=E("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);$(t.$$.fragment,n),n.forEach(h),this.h()},h(){d(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,n){V(s,e,n),x(t,e,null),l=!0},p(s,n){const i={};n[0]&4194304&&(i.content=s[22].t("Merge Responses")),n[1]&512&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&h(e),ee(t)}}}function Da(r){let e,t,l,s,n;return t=new Ia({props:{className:" size-5 "}}),{c(){e=E("button"),X(t.$$.fragment),this.h()},l(i){e=N(i,"BUTTON",{type:!0,id:!0,class:!0});var o=w(e);$(t.$$.fragment,o),o.forEach(h),this.h()},h(){d(e,"type","button"),d(e,"id","merge-response-button"),d(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){V(i,e,o),x(t,e,null),l=!0,s||(n=me(e,"click",r[33]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&h(e),ee(t),s=!1,n()}}}function Va(r){let e,t,l=r[18]&&Hs(r);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,n){l&&l.m(s,n),V(s,e,n),t=!0},p(s,n){s[18]?l?(l.p(s,n),n[0]&262144&&b(l,1)):(l=Hs(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(se(),D(l,1,1,()=>{l=null}),re())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&h(e),l&&l.d(s)}}}function Ca(r,e,t){let l,s;Me(r,Ir,A=>t(21,l=A));const n=Ue("i18n");Me(r,n,A=>t(22,s=A)),it.extend(Nr);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:m}=e,{saveMessage:g}=e,{rateMessage:_}=e,{actionMessage:y}=e,{submitMessage:p}=e,{deleteMessage:I}=e,{continueResponse:k}=e,{regenerateResponse:T}=e,{mergeResponses:L}=e,{addMessages:B}=e,{triggerScroll:M}=e;gt();let S,O,C={},P={},R=JSON.parse(JSON.stringify(o.messages[a]));const W=async A=>{t(20,P[A]=Math.max(0,P[A]-1),P);let fe=C[A].messageIds[P[A]];console.log(fe);let ie=o.messages[fe].childrenIds;for(;ie.length!==0;)fe=ie.at(-1),ie=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await De(),await c(),M()},le=async A=>{t(20,P[A]=Math.min(C[A].messageIds.length-1,P[A]+1),P);let fe=C[A].messageIds[P[A]];console.log(fe);let ie=o.messages[fe].childrenIds;for(;ie.length!==0;)fe=ie.at(-1),ie=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await De(),await c(),M()},de=async()=>{console.log("multiresponse:initHandler"),await De(),t(17,S=a),t(18,O=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,C=O==null?void 0:O.models.reduce((A,fe,ie)=>{let ge=O==null?void 0:O.childrenIds.map(ye=>o.messages[ye]).filter(ye=>(ye==null?void 0:ye.modelIdx)===ie).map(ye=>ye.id);if(ge.length===0){let ye=O==null?void 0:O.childrenIds.map(_e=>o.messages[_e]).filter(_e=>(_e==null?void 0:_e.model)===fe);ye.forEach(_e=>{_e.modelIdx=ie}),ge=ye.map(_e=>_e.id)}return{...A,[ie]:{messageIds:ge}}},{})),t(20,P=O==null?void 0:O.models.reduce((A,fe,ie)=>{const ge=C[ie].messageIds.findIndex(ye=>ye===a);return ge!==-1?{...A,[ie]:ge}:{...A,[ie]:C[ie].messageIds.length-1}},{})),console.log(C,P),await De()},te=async()=>{const A=Object.keys(C).map(fe=>{const{messageIds:ie}=C[fe],ge=ie[P[fe]];return o.messages[ge].content});L(a,A,i)};bt(async()=>{await de(),await De();const A=document.getElementById(`message-${a}`);A&&A.scrollIntoView({block:"start"})});const ne=A=>{var ge;const{messageIds:fe}=C[A],ie=fe[P[A]];return!((ge=o.messages[ie])!=null&&ge.done)},ue=A=>W(A),he=A=>le(A),ke=async(A,fe)=>{T(fe),await De(),t(20,P[A]=C[A].messageIds.length-1,P)},Q=async A=>{if(a!=A){let fe=A,ie=o.messages[fe].childrenIds;for(;ie.length!==0;)fe=ie.at(-1),ie=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await De(),await c(),M()}},F=()=>{te()};return r.$$set=A=>{"chatId"in A&&t(1,i=A.chatId),"history"in A&&t(0,o=A.history),"messageId"in A&&t(2,a=A.messageId),"isLastMessage"in A&&t(3,f=A.isLastMessage),"readOnly"in A&&t(4,u=A.readOnly),"updateChat"in A&&t(5,c=A.updateChat),"editMessage"in A&&t(6,m=A.editMessage),"saveMessage"in A&&t(7,g=A.saveMessage),"rateMessage"in A&&t(8,_=A.rateMessage),"actionMessage"in A&&t(9,y=A.actionMessage),"submitMessage"in A&&t(10,p=A.submitMessage),"deleteMessage"in A&&t(11,I=A.deleteMessage),"continueResponse"in A&&t(12,k=A.continueResponse),"regenerateResponse"in A&&t(13,T=A.regenerateResponse),"mergeResponses"in A&&t(27,L=A.mergeResponses),"addMessages"in A&&t(14,B=A.addMessages),"triggerScroll"in A&&t(15,M=A.triggerScroll)},r.$$.update=()=>{r.$$.dirty[0]&65541&&o.messages&&JSON.stringify(R)!==JSON.stringify(o.messages[a])&&t(16,R=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,c,m,g,_,y,p,I,k,T,B,M,R,S,O,C,P,l,s,n,W,le,te,L,ne,ue,he,ke,Q,F]}class Ta extends Be{constructor(e){super(),Se(this,e,Ca,Va,Ve,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Qs(r,e,t){const l=r.slice();return l[41]=e[t],l}function Ys(r){var n,i,o,a;let e,t,l,s;return t=new Dr({props:{src:r[6].user?((o=(i=(n=r[13].find(r[27]))==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??"/user.png":((a=r[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=E("div"),X(t.$$.fragment),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=w(e);$(t.$$.fragment,u),u.forEach(h),this.h()},h(){var f;d(e,"class",l=`shrink-0 ${(((f=r[12])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){V(f,e,u),x(t,e,null),s=!0},p(f,u){var m,g,_,y,p;const c={};u[0]&8257&&(c.src=f[6].user?((_=(g=(m=f[13].find(f[27]))==null?void 0:m.info)==null?void 0:g.meta)==null?void 0:_.profile_image_url)??"/user.png":((y=f[0])==null?void 0:y.profile_image_url)??"/user.png"),t.$set(c),(!s||u[0]&4096&&l!==(l=`shrink-0 ${(((p=f[12])==null?void 0:p.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&d(e,"class",l)},i(f){s||(b(t.$$.fragment,f),s=!0)},o(f){D(t.$$.fragment,f),s=!1},d(f){f&&h(e),ee(t)}}}function Xs(r){let e,t,l;return t=new Kt({props:{$$slots:{default:[La]},$$scope:{ctx:r}}}),{c(){e=E("div"),X(t.$$.fragment)},l(s){e=N(s,"DIV",{});var n=w(e);$(t.$$.fragment,n),n.forEach(h)},m(s,n){V(s,e,n),x(t,e,null),l=!0},p(s,n){const i={};n[0]&22593|n[1]&8192&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&h(e),ee(t)}}}function Ba(r){let e=r[11].t("You")+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&2048&&e!==(e=l[11].t("You")+"")&&Z(t,e)},d(l){l&&h(t)}}}function Sa(r){let e=r[0].name+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&Z(t,e)},d(l){l&&h(t)}}}function Ra(r){var o;let e=r[11].t("You")+"",t,l,s,n=(((o=r[6])==null?void 0:o.user)??"")+"",i;return{c(){t=U(e),l=H(),s=E("span"),i=U(n),this.h()},l(a){t=q(a,e),l=z(a),s=N(a,"SPAN",{class:!0});var f=w(s);i=q(f,n),f.forEach(h),this.h()},h(){d(s,"class","text-gray-500 text-sm font-medium")},m(a,f){V(a,t,f),V(a,l,f),V(a,s,f),v(s,i)},p(a,f){var u;f[0]&2048&&e!==(e=a[11].t("You")+"")&&Z(t,e),f[0]&64&&n!==(n=(((u=a[6])==null?void 0:u.user)??"")+"")&&Z(i,n)},d(a){a&&(h(t),h(l),h(s))}}}function $s(r){let e,t,l;return t=new Re({props:{content:it(r[6].timestamp*1e3).format("LLLL"),$$slots:{default:[Oa]},$$scope:{ctx:r}}}),{c(){e=E("div"),X(t.$$.fragment),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);$(t.$$.fragment,n),n.forEach(h),this.h()},h(){d(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){V(s,e,n),x(t,e,null),l=!0},p(s,n){const i={};n[0]&64&&(i.content=it(s[6].timestamp*1e3).format("LLLL")),n[0]&64|n[1]&8192&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&h(e),ee(t)}}}function Oa(r){let e,t=Pt(r[6].timestamp*1e3)+"",l;return{c(){e=E("span"),l=U(t),this.h()},l(s){e=N(s,"SPAN",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","line-clamp-1")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n[0]&64&&t!==(t=Pt(s[6].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&h(e)}}}function La(r){let e,t,l;function s(a,f){return a[6].user?Ra:a[12].showUsername||a[14].name!==a[0].name?Sa:Ba}let n=s(r),i=n(r),o=r[6].timestamp&&$s(r);return{c(){i.c(),e=H(),o&&o.c(),t=ae()},l(a){i.l(a),e=z(a),o&&o.l(a),t=ae()},m(a,f){i.m(a,f),V(a,e,f),o&&o.m(a,f),V(a,t,f),l=!0},p(a,f){n===(n=s(a))&&i?i.p(a,f):(i.d(1),i=n(a),i&&(i.c(),i.m(e.parentNode,e))),a[6].timestamp?o?(o.p(a,f),f[0]&64&&b(o,1)):(o=$s(a),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(se(),D(o,1,1,()=>{o=null}),re())},i(a){l||(b(o),l=!0)},o(a){D(o),l=!1},d(a){a&&(h(e),h(t)),i.d(a),o&&o.d(a)}}}function xs(r){let e,t,l=Ee(r[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=er(Qs(r,l,i));const n=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=E("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=N(i,"DIV",{class:!0});var o=w(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(h),this.h()},h(){d(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4160){l=Ee(i[6].files);let a;for(a=0;a<l.length;a+=1){const f=Qs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=er(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(se(),a=l.length;a<s.length;a+=1)n(a);re()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&h(e),qe(s,i)}}}function Pa(r){var l;let e,t;return e=new En({props:{item:r[41],url:r[41].url,name:r[41].name,type:r[41].type,size:(l=r[41])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){X(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,n){x(e,s,n),t=!0},p(s,n){var o;const i={};n[0]&64&&(i.item=s[41]),n[0]&64&&(i.url=s[41].url),n[0]&64&&(i.name=s[41].name),n[0]&64&&(i.type=s[41].type),n[0]&64&&(i.size=(o=s[41])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function Aa(r){let e,t;return e=new Vr({props:{src:r[41].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.src=l[41].url),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function er(r){let e,t,l,s,n,i;const o=[Aa,Pa],a=[];function f(u,c){return u[41].type==="image"?0:1}return t=f(r),l=a[t]=o[t](r),{c(){e=E("div"),l.c(),s=H(),this.h()},l(u){e=N(u,"DIV",{class:!0});var c=w(e);l.l(c),s=z(c),c.forEach(h),this.h()},h(){var u;d(e,"class",n=((u=r[12])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){V(u,e,c),a[t].m(e,null),v(e,s),i=!0},p(u,c){var g;let m=t;t=f(u),t===m?a[t].p(u,c):(se(),D(a[m],1,1,()=>{a[m]=null}),re(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),b(l,1),l.m(e,s)),(!i||c[0]&4096&&n!==(n=((g=u[12])==null?void 0:g.chatBubble)??!0?"self-end":""))&&d(e,"class",n)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&h(e),a[t].d()}}}function tr(r){let e,t,l,s;const n=[Ha,ja],i=[];function o(a,f){return a[8]===!0?0:1}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function ja(r){var L,B;let e,t,l,s,n,i,o,a,f,u,c,m,g,_,y=r[6].content&&lr(r),p=!(((L=r[12])==null?void 0:L.chatBubble)??!0)&&sr(r),I=!r[5]&&nr(r);u=new Re({props:{content:r[11].t("Copy"),placement:"bottom",$$slots:{default:[Wa]},$$scope:{ctx:r}}});let k=!r[4]&&!r[5]&&ir(r),T=(((B=r[12])==null?void 0:B.chatBubble)??!0)&&or(r);return{c(){e=E("div"),t=E("div"),l=E("div"),y&&y.c(),i=H(),o=E("div"),p&&p.c(),a=H(),I&&I.c(),f=H(),X(u.$$.fragment),c=H(),k&&k.c(),m=H(),T&&T.c(),this.h()},l(M){e=N(M,"DIV",{class:!0});var S=w(e);t=N(S,"DIV",{class:!0});var O=w(t);l=N(O,"DIV",{class:!0});var C=w(l);y&&y.l(C),C.forEach(h),O.forEach(h),i=z(S),o=N(S,"DIV",{class:!0});var P=w(o);p&&p.l(P),a=z(P),I&&I.l(P),f=z(P),$(u.$$.fragment,P),c=z(P),k&&k.l(P),m=z(P),T&&T.l(P),P.forEach(h),S.forEach(h),this.h()},h(){var M,S,O;d(l,"class",s="rounded-3xl "+(((M=r[12])==null?void 0:M.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${r[6].files?"rounded-tr-lg":""}`:" w-full")),d(t,"class",n="flex "+(((S=r[12])==null?void 0:S.chatBubble)??!0?"justify-end pb-1":"w-full")),d(o,"class",g="flex "+(((O=r[12])==null?void 0:O.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),d(e,"class","w-full")},m(M,S){V(M,e,S),v(e,t),v(t,l),y&&y.m(l,null),v(e,i),v(e,o),p&&p.m(o,null),v(o,a),I&&I.m(o,null),v(o,f),x(u,o,null),v(o,c),k&&k.m(o,null),v(o,m),T&&T.m(o,null),_=!0},p(M,S){var C,P,R,W,le;M[6].content?y?(y.p(M,S),S[0]&64&&b(y,1)):(y=lr(M),y.c(),b(y,1),y.m(l,null)):y&&(se(),D(y,1,1,()=>{y=null}),re()),(!_||S[0]&4160&&s!==(s="rounded-3xl "+(((C=M[12])==null?void 0:C.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${M[6].files?"rounded-tr-lg":""}`:" w-full")))&&d(l,"class",s),(!_||S[0]&4096&&n!==(n="flex "+(((P=M[12])==null?void 0:P.chatBubble)??!0?"justify-end pb-1":"w-full")))&&d(t,"class",n),((R=M[12])==null?void 0:R.chatBubble)??!0?p&&(p.d(1),p=null):p?p.p(M,S):(p=sr(M),p.c(),p.m(o,a)),M[5]?I&&(se(),D(I,1,1,()=>{I=null}),re()):I?(I.p(M,S),S[0]&32&&b(I,1)):(I=nr(M),I.c(),b(I,1),I.m(o,f));const O={};S[0]&2048&&(O.content=M[11].t("Copy")),S[0]&64|S[1]&8192&&(O.$$scope={dirty:S,ctx:M}),u.$set(O),!M[4]&&!M[5]?k?(k.p(M,S),S[0]&48&&b(k,1)):(k=ir(M),k.c(),b(k,1),k.m(o,m)):k&&(se(),D(k,1,1,()=>{k=null}),re()),((W=M[12])==null?void 0:W.chatBubble)??!0?T?T.p(M,S):(T=or(M),T.c(),T.m(o,null)):T&&(T.d(1),T=null),(!_||S[0]&4096&&g!==(g="flex "+(((le=M[12])==null?void 0:le.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&d(o,"class",g)},i(M){_||(b(y),b(I),b(u.$$.fragment,M),b(k),_=!0)},o(M){D(y),D(I),D(u.$$.fragment,M),D(k),_=!1},d(M){M&&h(e),y&&y.d(),p&&p.d(),I&&I.d(),ee(u),k&&k.d(),T&&T.d()}}}function Ha(r){let e,t,l,s,n,i,o,a,f=r[11].t("Save")+"",u,c,m,g,_=r[11].t("Cancel")+"",y,p,I,k=r[11].t("Send")+"",T,L,B;return{c(){e=E("div"),t=E("div"),l=E("textarea"),n=H(),i=E("div"),o=E("div"),a=E("button"),u=U(f),c=H(),m=E("div"),g=E("button"),y=U(_),p=H(),I=E("button"),T=U(k),this.h()},l(M){e=N(M,"DIV",{class:!0});var S=w(e);t=N(S,"DIV",{class:!0});var O=w(t);l=N(O,"TEXTAREA",{id:!0,class:!0}),w(l).forEach(h),O.forEach(h),n=z(S),i=N(S,"DIV",{class:!0});var C=w(i);o=N(C,"DIV",{});var P=w(o);a=N(P,"BUTTON",{id:!0,class:!0});var R=w(a);u=q(R,f),R.forEach(h),P.forEach(h),c=z(C),m=N(C,"DIV",{class:!0});var W=w(m);g=N(W,"BUTTON",{id:!0,class:!0});var le=w(g);y=q(le,_),le.forEach(h),p=z(W),I=N(W,"BUTTON",{id:!0,class:!0});var de=w(I);T=q(de,k),de.forEach(h),W.forEach(h),C.forEach(h),S.forEach(h),this.h()},h(){d(l,"id",s="message-edit-"+r[6].id),d(l,"class","bg-transparent outline-hidden w-full resize-none"),d(t,"class","max-h-96 overflow-auto"),d(a,"id","save-edit-message-button"),d(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),d(g,"id","close-edit-message-button"),d(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),d(I,"id","confirm-edit-message-button"),d(I,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),d(m,"class","flex space-x-1.5"),d(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),d(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(M,S){V(M,e,S),v(e,t),v(t,l),r[28](l),nt(l,r[9]),v(e,n),v(e,i),v(i,o),v(o,a),v(a,u),v(i,c),v(i,m),v(m,g),v(g,y),v(m,p),v(m,I),v(I,T),L||(B=[me(l,"input",r[29]),me(l,"input",Fa),me(l,"keydown",r[30]),me(a,"click",r[31]),me(g,"click",r[32]),me(I,"click",r[33])],L=!0)},p(M,S){S[0]&64&&s!==(s="message-edit-"+M[6].id)&&d(l,"id",s),S[0]&512&&nt(l,M[9]),S[0]&2048&&f!==(f=M[11].t("Save")+"")&&Z(u,f),S[0]&2048&&_!==(_=M[11].t("Cancel")+"")&&Z(y,_),S[0]&2048&&k!==(k=M[11].t("Send")+"")&&Z(T,k)},i:ve,o:ve,d(M){M&&h(e),r[28](null),L=!1,et(B)}}}function lr(r){let e,t;return e=new yt({props:{id:r[6].id,content:r[6].content}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.id=l[6].id),s[0]&64&&(n.content=l[6].content),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function sr(r){let e,t=r[1].length>1&&rr(r);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=rr(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&h(e),t&&t.d(l)}}}function rr(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",o,a,f=r[1].length+"",u,c,m,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,y;return{c(){e=E("div"),t=E("button"),t.innerHTML=l,s=H(),n=E("div"),o=U(i),a=U("/"),u=U(f),c=H(),m=E("button"),m.innerHTML=g,this.h()},l(p){e=N(p,"DIV",{class:!0,dir:!0});var I=w(e);t=N(I,"BUTTON",{class:!0,"data-svelte-h":!0}),He(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(I),n=N(I,"DIV",{class:!0});var k=w(n);o=q(k,i),a=q(k,"/"),u=q(k,f),k.forEach(h),c=z(I),m=N(I,"BUTTON",{class:!0,"data-svelte-h":!0}),He(m)!=="svelte-4phel2"&&(m.innerHTML=g),I.forEach(h),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),d(m,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(p,I){V(p,e,I),v(e,t),v(e,s),v(e,n),v(n,o),v(n,a),v(n,u),v(e,c),v(e,m),_||(y=[me(t,"click",r[34]),me(m,"click",r[35])],_=!0)},p(p,I){I[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&Z(o,i),I[0]&2&&f!==(f=p[1].length+"")&&Z(u,f)},d(p){p&&h(e),_=!1,et(y)}}}function nr(r){let e,t;return e=new Re({props:{content:r[11].t("Edit"),placement:"bottom",$$slots:{default:[za]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&2048&&(n.content=l[11].t("Edit")),s[1]&8192&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function za(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=E("button"),e.innerHTML=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,"data-svelte-h":!0}),He(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(n,i){V(n,e,i),l||(s=me(e,"click",r[36]),l=!0)},p:ve,d(n){n&&h(e),l=!1,s()}}}function Wa(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=E("button"),e.innerHTML=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,"data-svelte-h":!0}),He(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(n,i){V(n,e,i),l||(s=me(e,"click",r[37]),l=!0)},p:ve,d(n){n&&h(e),l=!1,s()}}}function ir(r){let e,t;return e=new Re({props:{content:r[11].t("Delete"),placement:"bottom",$$slots:{default:[Ua]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&2048&&(n.content=l[11].t("Delete")),s[0]&128|s[1]&8192&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function Ua(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=E("button"),e.innerHTML=t,this.h()},l(n){e=N(n,"BUTTON",{class:!0,"data-svelte-h":!0}),He(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){d(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(n,i){V(n,e,i),l||(s=me(e,"click",r[38]),l=!0)},p:ve,d(n){n&&h(e),l=!1,s()}}}function or(r){let e,t=r[1].length>1&&ar(r);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=ar(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&h(e),t&&t.d(l)}}}function ar(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",o,a,f=r[1].length+"",u,c,m,g='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',_,y;return{c(){e=E("div"),t=E("button"),t.innerHTML=l,s=H(),n=E("div"),o=U(i),a=U("/"),u=U(f),c=H(),m=E("button"),m.innerHTML=g,this.h()},l(p){e=N(p,"DIV",{class:!0,dir:!0});var I=w(e);t=N(I,"BUTTON",{class:!0,"data-svelte-h":!0}),He(t)!=="svelte-buado9"&&(t.innerHTML=l),s=z(I),n=N(I,"DIV",{class:!0});var k=w(n);o=q(k,i),a=q(k,"/"),u=q(k,f),k.forEach(h),c=z(I),m=N(I,"BUTTON",{class:!0,"data-svelte-h":!0}),He(m)!=="svelte-4phel2"&&(m.innerHTML=g),I.forEach(h),this.h()},h(){d(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),d(m,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),d(e,"class","flex self-center"),d(e,"dir","ltr")},m(p,I){V(p,e,I),v(e,t),v(e,s),v(e,n),v(n,o),v(n,a),v(n,u),v(e,c),v(e,m),_||(y=[me(t,"click",r[39]),me(m,"click",r[40])],_=!0)},p(p,I){I[0]&66&&i!==(i=p[1].indexOf(p[6].id)+1+"")&&Z(o,i),I[0]&2&&f!==(f=p[1].length+"")&&Z(u,f)},d(p){p&&h(e),_=!1,et(y)}}}function qa(r){var L,B;let e,t,l,s,n,i,o,a,f,u,c,m,g;function _(M){r[25](M)}let y={title:r[11].t("Delete message?")};r[7]!==void 0&&(y.show=r[7]),e=new Sr({props:y}),Ae.push(()=>Ke(e,"show",_)),e.$on("confirm",r[26]);let p=!(((L=r[12])==null?void 0:L.chatBubble)??!0)&&Ys(r),I=!(((B=r[12])==null?void 0:B.chatBubble)??!0)&&Xs(r),k=r[6].files&&xs(r),T=r[6].content!==""&&tr(r);return{c(){X(e.$$.fragment),l=H(),s=E("div"),p&&p.c(),n=H(),i=E("div"),I&&I.c(),o=H(),a=E("div"),k&&k.c(),f=H(),T&&T.c(),this.h()},l(M){$(e.$$.fragment,M),l=z(M),s=N(M,"DIV",{class:!0,dir:!0,id:!0});var S=w(s);p&&p.l(S),n=z(S),i=N(S,"DIV",{class:!0});var O=w(i);I&&I.l(O),o=z(O),a=N(O,"DIV",{class:!0});var C=w(a);k&&k.l(C),f=z(C),T&&T.l(C),C.forEach(h),O.forEach(h),S.forEach(h),this.h()},h(){d(a,"class",u="chat-"+r[6].role+" w-full min-w-full markdown-prose"),d(i,"class","flex-auto w-0 max-w-full pl-1"),d(s,"class","flex w-full user-message"),d(s,"dir",c=r[12].chatDirection),d(s,"id",m="message-"+r[6].id)},m(M,S){x(e,M,S),V(M,l,S),V(M,s,S),p&&p.m(s,null),v(s,n),v(s,i),I&&I.m(i,null),v(i,o),v(i,a),k&&k.m(a,null),v(a,f),T&&T.m(a,null),g=!0},p(M,S){var C,P;const O={};S[0]&2048&&(O.title=M[11].t("Delete message?")),!t&&S[0]&128&&(t=!0,O.show=M[7],Ze(()=>t=!1)),e.$set(O),((C=M[12])==null?void 0:C.chatBubble)??!0?p&&(se(),D(p,1,1,()=>{p=null}),re()):p?(p.p(M,S),S[0]&4096&&b(p,1)):(p=Ys(M),p.c(),b(p,1),p.m(s,n)),((P=M[12])==null?void 0:P.chatBubble)??!0?I&&(se(),D(I,1,1,()=>{I=null}),re()):I?(I.p(M,S),S[0]&4096&&b(I,1)):(I=Xs(M),I.c(),b(I,1),I.m(i,o)),M[6].files?k?(k.p(M,S),S[0]&64&&b(k,1)):(k=xs(M),k.c(),b(k,1),k.m(a,f)):k&&(se(),D(k,1,1,()=>{k=null}),re()),M[6].content!==""?T?(T.p(M,S),S[0]&64&&b(T,1)):(T=tr(M),T.c(),b(T,1),T.m(a,null)):T&&(se(),D(T,1,1,()=>{T=null}),re()),(!g||S[0]&64&&u!==(u="chat-"+M[6].role+" w-full min-w-full markdown-prose"))&&d(a,"class",u),(!g||S[0]&4096&&c!==(c=M[12].chatDirection))&&d(s,"dir",c),(!g||S[0]&64&&m!==(m="message-"+M[6].id))&&d(s,"id",m)},i(M){g||(b(e.$$.fragment,M),b(p),b(I),b(k),b(T),g=!0)},o(M){D(e.$$.fragment,M),D(p),D(I),D(k),D(T),g=!1},d(M){M&&(h(l),h(s)),ee(e,M),p&&p.d(),I&&I.d(),k&&k.d(),T&&T.d()}}}const Fa=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`};function Ja(r,e,t){let l,s,n,i;Me(r,Ht,oe=>t(12,s=oe)),Me(r,jt,oe=>t(13,n=oe)),Me(r,zt,oe=>t(14,i=oe));const o=Ue("i18n");Me(r,o,oe=>t(11,l=oe)),it.extend(Nr);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{showPreviousMessage:m}=e,{showNextMessage:g}=e,{editMessage:_}=e,{deleteMessage:y}=e,{isFirstMessage:p}=e,{readOnly:I}=e,k=!1,T=!1,L="",B,M=JSON.parse(JSON.stringify(f.messages[u]));const S=async oe=>{await Er(oe)&&Pe.success(l.t("Copying to clipboard was successful!"))},O=async()=>{t(8,T=!0),t(9,L=M.content),await De(),t(10,B.style.height="",B),t(10,B.style.height=`${B.scrollHeight}px`,B),B==null||B.focus()},C=async(oe=!0)=>{_(M.id,L,oe),t(8,T=!1),t(9,L="")},P=()=>{t(8,T=!1),t(9,L="")},R=async()=>{y(M.id)};bt(()=>{});function W(oe){k=oe,t(7,k)}const le=()=>{R()},de=oe=>oe.id===M.user;function te(oe){Ae[oe?"unshift":"push"](()=>{B=oe,t(10,B)})}function ne(){L=this.value,t(9,L)}const ue=oe=>{var Y,G;oe.key==="Escape"&&((Y=document.getElementById("close-edit-message-button"))==null||Y.click());const j=oe.metaKey||oe.ctrlKey,K=oe.key==="Enter";j&&K&&((G=document.getElementById("confirm-edit-message-button"))==null||G.click())},he=()=>{C(!1)},ke=()=>{P()},Q=()=>{C()},F=()=>{m(M)},A=()=>{g(M)},fe=()=>{O()},ie=()=>{S(M.content)},ge=()=>{t(7,k=!0)},ye=()=>{m(M)},_e=()=>{g(M)};return r.$$set=oe=>{"user"in oe&&t(0,a=oe.user),"history"in oe&&t(21,f=oe.history),"messageId"in oe&&t(22,u=oe.messageId),"siblings"in oe&&t(1,c=oe.siblings),"showPreviousMessage"in oe&&t(2,m=oe.showPreviousMessage),"showNextMessage"in oe&&t(3,g=oe.showNextMessage),"editMessage"in oe&&t(23,_=oe.editMessage),"deleteMessage"in oe&&t(24,y=oe.deleteMessage),"isFirstMessage"in oe&&t(4,p=oe.isFirstMessage),"readOnly"in oe&&t(5,I=oe.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&6291520&&f.messages&&JSON.stringify(M)!==JSON.stringify(f.messages[u])&&t(6,M=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,m,g,p,I,M,k,T,L,B,l,s,n,i,o,S,O,C,P,R,f,u,_,y,W,le,de,te,ne,ue,he,ke,Q,F,A,fe,ie,ge,ye,_e]}class Ga extends Be{constructor(e){super(),Se(this,e,Ja,qa,Ve,{user:0,history:21,messageId:22,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:23,deleteMessage:24,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function fr(r){let e,t,l,s;const n=[Qa,Ka,Za],i=[];function o(a,f){var u,c;return a[0].messages[a[3]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(se(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&h(l),i[e].d(a)}}}function Za(r){var i;let e,t,l;function s(o){r[21](o)}let n={chatId:r[1],messageId:r[3],isLastMessage:r[3]===((i=r[0])==null?void 0:i.currentId),updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],deleteMessage:r[10],continueResponse:r[15],regenerateResponse:r[14],mergeResponses:r[16],triggerScroll:r[18],addMessages:r[17],readOnly:r[19]};return r[0]!==void 0&&(n.history=r[0]),e=new Ta({props:n}),Ae.push(()=>Ke(e,"history",s)),{c(){X(e.$$.fragment)},l(o){$(e.$$.fragment,o)},m(o,a){x(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&128&&(f.updateChat=o[7]),a&256&&(f.editMessage=o[8]),a&512&&(f.saveMessage=o[9]),a&2048&&(f.rateMessage=o[11]),a&4096&&(f.actionMessage=o[12]),a&8192&&(f.submitMessage=o[13]),a&1024&&(f.deleteMessage=o[10]),a&32768&&(f.continueResponse=o[15]),a&16384&&(f.regenerateResponse=o[14]),a&65536&&(f.mergeResponses=o[16]),a&262144&&(f.triggerScroll=o[18]),a&131072&&(f.addMessages=o[17]),a&524288&&(f.readOnly=o[19]),!t&&a&1&&(t=!0,f.history=o[0],Ze(()=>t=!1)),e.$set(f)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),l=!1},d(o){ee(e,o)}}}function Ka(r){var l;let e,t;return e=new Or({props:{chatId:r[1],history:r[0],messageId:r[3],isLastMessage:r[3]===r[0].currentId,siblings:((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:r[5],showNextMessage:r[6],updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],deleteMessage:r[10],continueResponse:r[15],regenerateResponse:r[14],addMessages:r[17],readOnly:r[19]}}),{c(){X(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,n){x(e,s,n),t=!0},p(s,n){var o;const i={};n&2&&(i.chatId=s[1]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&9&&(i.isLastMessage=s[3]===s[0].currentId),n&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&128&&(i.updateChat=s[7]),n&256&&(i.editMessage=s[8]),n&512&&(i.saveMessage=s[9]),n&2048&&(i.rateMessage=s[11]),n&4096&&(i.actionMessage=s[12]),n&8192&&(i.submitMessage=s[13]),n&1024&&(i.deleteMessage=s[10]),n&32768&&(i.continueResponse=s[15]),n&16384&&(i.regenerateResponse=s[14]),n&131072&&(i.addMessages=s[17]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function Qa(r){var l;let e,t;return e=new Ga({props:{user:r[4],history:r[0],messageId:r[3],isFirstMessage:r[2]===0,siblings:r[0].messages[r[3]].parentId!==null?((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(r[0].messages).filter(ur).map(cr)??[],showPreviousMessage:r[5],showNextMessage:r[6],editMessage:r[8],deleteMessage:r[10],readOnly:r[19]}}),{c(){X(e.$$.fragment)},l(s){$(e.$$.fragment,s)},m(s,n){x(e,s,n),t=!0},p(s,n){var o;const i={};n&16&&(i.user=s[4]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&4&&(i.isFirstMessage=s[2]===0),n&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(ur).map(cr)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&256&&(i.editMessage=s[8]),n&1024&&(i.deleteMessage=s[10]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){ee(e,s)}}}function Ya(r){let e,t,l,s=r[0].messages[r[3]]&&fr(r);return{c(){e=E("div"),s&&s.c(),this.h()},l(n){e=N(n,"DIV",{class:!0});var i=w(e);s&&s.l(i),i.forEach(h),this.h()},h(){var n;d(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((n=r[20])==null?void 0:n.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(n,i){V(n,e,i),s&&s.m(e,null),l=!0},p(n,[i]){var o;n[0].messages[n[3]]?s?(s.p(n,i),i&9&&b(s,1)):(s=fr(n),s.c(),b(s,1),s.m(e,null)):s&&(se(),D(s,1,1,()=>{s=null}),re()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=n[20])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&d(e,"class",t)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&h(e),s&&s.d()}}}const ur=r=>r.parentId===null,cr=r=>r.id;function Xa(r,e,t){let l;Me(r,Ht,C=>t(20,l=C)),gt(),Ue("i18n");let{chatId:s}=e,{idx:n=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:c}=e,{editMessage:m}=e,{saveMessage:g}=e,{deleteMessage:_}=e,{rateMessage:y}=e,{actionMessage:p}=e,{submitMessage:I}=e,{regenerateResponse:k}=e,{continueResponse:T}=e,{mergeResponses:L}=e,{addMessages:B}=e,{triggerScroll:M}=e,{readOnly:S=!1}=e;function O(C){i=C,t(0,i)}return r.$$set=C=>{"chatId"in C&&t(1,s=C.chatId),"idx"in C&&t(2,n=C.idx),"history"in C&&t(0,i=C.history),"messageId"in C&&t(3,o=C.messageId),"user"in C&&t(4,a=C.user),"showPreviousMessage"in C&&t(5,f=C.showPreviousMessage),"showNextMessage"in C&&t(6,u=C.showNextMessage),"updateChat"in C&&t(7,c=C.updateChat),"editMessage"in C&&t(8,m=C.editMessage),"saveMessage"in C&&t(9,g=C.saveMessage),"deleteMessage"in C&&t(10,_=C.deleteMessage),"rateMessage"in C&&t(11,y=C.rateMessage),"actionMessage"in C&&t(12,p=C.actionMessage),"submitMessage"in C&&t(13,I=C.submitMessage),"regenerateResponse"in C&&t(14,k=C.regenerateResponse),"continueResponse"in C&&t(15,T=C.continueResponse),"mergeResponses"in C&&t(16,L=C.mergeResponses),"addMessages"in C&&t(17,B=C.addMessages),"triggerScroll"in C&&t(18,M=C.triggerScroll),"readOnly"in C&&t(19,S=C.readOnly)},[i,s,n,o,a,f,u,c,m,g,_,y,p,I,k,T,L,B,M,S,l,O]}class $a extends Be{constructor(e){super(),Se(this,e,Xa,Ya,Ve,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function dr(r,e,t){const l=r.slice();return l[14]=e[t],l[16]=t,l}function xa(r){let e,t;return{c(){e=E("img"),this.h()},l(l){e=N(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,n;d(e,"crossorigin","anonymous"),Ot(e.src,t=((n=(s=(l=r[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.profile_image_url)??(r[5].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))||d(e,"src",t),d(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),d(e,"alt","logo"),d(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var n,i,o;s&33&&!Ot(e.src,t=((o=(i=(n=l[14])==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))&&d(e,"src",t)},d(l){l&&h(e)}}}function hr(r){var a,f,u;let e,t,l,s,n,i;t=new Re({props:{content:At.parse(pt(((u=(f=(a=r[0][r[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[xa]},$$scope:{ctx:r}}});function o(){return r[12](r[16])}return{c(){e=E("button"),X(t.$$.fragment),l=H()},l(c){e=N(c,"BUTTON",{});var m=w(e);$(t.$$.fragment,m),l=z(m),m.forEach(h)},m(c,m){V(c,e,m),x(t,e,null),v(e,l),s=!0,n||(i=me(e,"click",o),n=!0)},p(c,m){var _,y,p;r=c;const g={};m&17&&(g.content=At.parse(pt(((p=(y=(_=r[0][r[4]])==null?void 0:_.info)==null?void 0:y.meta)==null?void 0:p.description)??""))),m&131105&&(g.$$scope={dirty:m,ctx:r}),t.$set(g)},i(c){s||(b(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&h(e),ee(t),n=!1,i()}}}function mr(r){let e,t;return e=new Re({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[ef]},$$scope:{ctx:r}}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function ef(r){let e,t,l,s;return t=new Gn({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=E("div"),X(t.$$.fragment),l=U(" Temporary Chat"),this.h()},l(n){e=N(n,"DIV",{class:!0});var i=w(e);$(t.$$.fragment,i),l=q(i," Temporary Chat"),i.forEach(h),this.h()},h(){d(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(n,i){V(n,e,i),x(t,e,null),v(e,l),s=!0},p:ve,i(n){s||(b(t.$$.fragment,n),s=!0)},o(n){D(t.$$.fragment,n),s=!1},d(n){n&&h(e),ee(t)}}}function tf(r){let e=r[5].t("Hello, {{name}}",{name:r[7].name})+"",t;return{c(){t=U(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&160&&e!==(e=l[5].t("Hello, {{name}}",{name:l[7].name})+"")&&Z(t,e)},d(l){l&&h(t)}}}function lf(r){var l;let e=((l=r[0][r[4]])==null?void 0:l.name)+"",t;return{c(){t=U(e)},l(s){t=q(s,e)},m(s,n){V(s,t,n)},p(s,n){var i;n&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&Z(t,e)},d(s){s&&h(t)}}}function sf(r){let e,t=r[5].t("How can I help you today?")+"",l;return{c(){e=E("div"),l=U(t),this.h()},l(s){e=N(s,"DIV",{class:!0});var n=w(e);l=q(n,t),n.forEach(h),this.h()},h(){d(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,n){V(s,e,n),v(e,l)},p(s,n){n&32&&t!==(t=s[5].t("How can I help you today?")+"")&&Z(l,t)},d(s){s&&h(e)}}}function rf(r){var o,a,f,u,c,m;let e,t,l=At.parse(pt((f=(a=(o=r[0][r[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,n,i=((m=(c=(u=r[0][r[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:m.user)&&gr(r);return{c(){e=E("div"),t=new sn(!1),s=H(),i&&i.c(),n=ae(),this.h()},l(g){e=N(g,"DIV",{class:!0});var _=w(e);t=rn(_,!1),_.forEach(h),s=z(g),i&&i.l(g),n=ae(),this.h()},h(){t.a=null,d(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(g,_){V(g,e,_),t.m(l,e),V(g,s,_),i&&i.m(g,_),V(g,n,_)},p(g,_){var y,p,I,k,T,L;_&17&&l!==(l=At.parse(pt((I=(p=(y=g[0][g[4]])==null?void 0:y.info)==null?void 0:p.meta)==null?void 0:I.description))+"")&&t.p(l),(L=(T=(k=g[0][g[4]])==null?void 0:k.info)==null?void 0:T.meta)!=null&&L.user?i?i.p(g,_):(i=gr(g),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(g){g&&(h(e),h(s),h(n)),i&&i.d(g)}}}function gr(r){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?of:nf}let s=l(r),n=s(r);return{c(){e=E("div"),t=U(`By\r
								`),n.c(),this.h()},l(i){e=N(i,"DIV",{class:!0});var o=w(e);t=q(o,`By\r
								`),n.l(o),o.forEach(h),this.h()},h(){d(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){V(i,e,o),v(e,t),n.m(e,null)},p(i,o){s===(s=l(i))&&n?n.p(i,o):(n.d(1),n=s(i),n&&(n.c(),n.m(e,null)))},d(i){i&&h(e),n.d()}}}function nf(r){var l,s,n;let e=((n=(s=(l=r[0][r[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.user.name)+"",t;return{c(){t=U(e)},l(i){t=q(i,e)},m(i,o){V(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&Z(t,e)},d(i){i&&h(t)}}}function of(r){var n,i,o,a,f,u,c,m,g;let e,t=((o=(i=(n=r[0][r[4]])==null?void 0:n.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=r[0][r[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(g=(m=(c=r[0][r[4]])==null?void 0:c.info)==null?void 0:m.meta)==null?void 0:g.user.username}`)+"",l,s;return{c(){e=E("a"),l=U(t),this.h()},l(_){e=N(_,"A",{href:!0});var y=w(e);l=q(y,t),y.forEach(h),this.h()},h(){var _,y,p;d(e,"href",s="https://openwebui.com/m/"+((p=(y=(_=r[0][r[4]])==null?void 0:_.info)==null?void 0:y.meta)==null?void 0:p.user.username))},m(_,y){V(_,e,y),v(e,l)},p(_,y){var p,I,k,T,L,B,M,S,O,C,P,R;y&17&&t!==(t=((k=(I=(p=_[0][_[4]])==null?void 0:p.info)==null?void 0:I.meta)!=null&&k.user.name?(B=(L=(T=_[0][_[4]])==null?void 0:T.info)==null?void 0:L.meta)==null?void 0:B.user.name:`@${(O=(S=(M=_[0][_[4]])==null?void 0:M.info)==null?void 0:S.meta)==null?void 0:O.user.username}`)+"")&&Z(l,t),y&17&&s!==(s="https://openwebui.com/m/"+((R=(P=(C=_[0][_[4]])==null?void 0:C.info)==null?void 0:P.meta)==null?void 0:R.user.username))&&d(e,"href",s)},d(_){_&&h(e)}}}function _r(r){var le,de,te,ne,ue,he,ke;let e,t,l,s,n,i,o,a,f,u,c,m,g,_,y,p,I,k,T=Ee(r[0]),L=[];for(let Q=0;Q<T.length;Q+=1)L[Q]=hr(dr(r,T,Q));const B=Q=>D(L[Q],1,1,()=>{L[Q]=null});let M=r[6]&&mr(r);function S(Q,F){var A;return(A=Q[0][Q[4]])!=null&&A.name?lf:tf}let O=S(r),C=O(r);function P(Q,F){var A,fe,ie;return((ie=(fe=(A=Q[0][Q[4]])==null?void 0:A.info)==null?void 0:fe.meta)==null?void 0:ie.description)??null?rf:sf}let R=P(r),W=R(r);return p=new qn({props:{className:"grid grid-cols-2",suggestionPrompts:((te=(de=(le=r[1])==null?void 0:le.info)==null?void 0:de.meta)==null?void 0:te.suggestion_prompts)??((he=(ue=(ne=r[0][r[4]])==null?void 0:ne.info)==null?void 0:ue.meta)==null?void 0:he.suggestion_prompts)??((ke=r[8])==null?void 0:ke.default_prompt_suggestions)??[]}}),p.$on("select",r[13]),{c(){e=E("div"),t=E("div"),l=E("div");for(let Q=0;Q<L.length;Q+=1)L[Q].c();n=H(),M&&M.c(),i=H(),o=E("div"),a=E("div"),f=E("div"),C.c(),c=H(),m=E("div"),W.c(),_=H(),y=E("div"),X(p.$$.fragment),this.h()},l(Q){e=N(Q,"DIV",{class:!0});var F=w(e);t=N(F,"DIV",{class:!0});var A=w(t);l=N(A,"DIV",{class:!0});var fe=w(l);for(let j=0;j<L.length;j+=1)L[j].l(fe);fe.forEach(h),A.forEach(h),n=z(F),M&&M.l(F),i=z(F),o=N(F,"DIV",{class:!0});var ie=w(o);a=N(ie,"DIV",{});var ge=w(a);f=N(ge,"DIV",{class:!0});var ye=w(f);C.l(ye),ye.forEach(h),c=z(ge),m=N(ge,"DIV",{});var _e=w(m);W.l(_e),_e.forEach(h),ge.forEach(h),ie.forEach(h),_=z(F),y=N(F,"DIV",{class:!0});var oe=w(y);$(p.$$.fragment,oe),oe.forEach(h),F.forEach(h),this.h()},h(){d(l,"class","flex -space-x-4 mb-0.5"),d(t,"class","flex justify-start"),d(f,"class","capitalize line-clamp-1"),d(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),d(y,"class","w-full font-primary"),d(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(Q,F){V(Q,e,F),v(e,t),v(t,l);for(let A=0;A<L.length;A+=1)L[A]&&L[A].m(l,null);v(e,n),M&&M.m(e,null),v(e,i),v(e,o),v(o,a),v(a,f),C.m(f,null),v(a,c),v(a,m),W.m(m,null),v(e,_),v(e,y),x(p,y,null),k=!0},p(Q,F){var fe,ie,ge,ye,_e,oe,j;if(F&49){T=Ee(Q[0]);let K;for(K=0;K<T.length;K+=1){const Y=dr(Q,T,K);L[K]?(L[K].p(Y,F),b(L[K],1)):(L[K]=hr(Y),L[K].c(),b(L[K],1),L[K].m(l,null))}for(se(),K=T.length;K<L.length;K+=1)B(K);re()}Q[6]?M?F&64&&b(M,1):(M=mr(Q),M.c(),b(M,1),M.m(e,i)):M&&(se(),D(M,1,1,()=>{M=null}),re()),O===(O=S(Q))&&C?C.p(Q,F):(C.d(1),C=O(Q),C&&(C.c(),C.m(f,null))),R===(R=P(Q))&&W?W.p(Q,F):(W.d(1),W=R(Q),W&&(W.c(),W.m(m,null)));const A={};F&275&&(A.suggestionPrompts=((ge=(ie=(fe=Q[1])==null?void 0:fe.info)==null?void 0:ie.meta)==null?void 0:ge.suggestion_prompts)??((oe=(_e=(ye=Q[0][Q[4]])==null?void 0:ye.info)==null?void 0:_e.meta)==null?void 0:oe.suggestion_prompts)??((j=Q[8])==null?void 0:j.default_prompt_suggestions)??[]),p.$set(A)},i(Q){if(!k){for(let F=0;F<T.length;F+=1)b(L[F]);Q&&(s||Tt(()=>{s=Bt(l,St,{duration:200}),s.start()})),b(M),Q&&(u||Tt(()=>{u=Bt(f,St,{duration:200}),u.start()})),Q&&(g||Tt(()=>{g=Bt(m,St,{duration:200,delay:200}),g.start()})),b(p.$$.fragment,Q),Q&&(I||Tt(()=>{I=Bt(y,St,{duration:200,delay:300}),I.start()})),k=!0}},o(Q){L=L.filter(Boolean);for(let F=0;F<L.length;F+=1)D(L[F]);D(M),D(p.$$.fragment,Q),k=!1},d(Q){Q&&h(e),qe(L,Q),M&&M.d(),C.d(),W.d(),ee(p)}}}function af(r){let e=r[3],t,l,s=_r(r);return{c(){s.c(),t=ae()},l(n){s.l(n),t=ae()},m(n,i){s.m(n,i),V(n,t,i),l=!0},p(n,[i]){i&8&&Ve(e,e=n[3])?(se(),D(s,1,1,ve),re(),s=_r(n),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&h(t),s.d(n)}}}function ff(r,e,t){let l,s,n,i,o;Me(r,jt,I=>t(11,l=I)),Me(r,Zt,I=>t(6,n=I)),Me(r,zt,I=>t(7,i=I)),Me(r,Mr,I=>t(8,o=I));const a=Ue("i18n");Me(r,a,I=>t(5,s=I));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{submitPrompt:m}=e,g=!1,_=0;bt(()=>{t(3,g=!0)});const y=I=>{t(4,_=I)},p=I=>{m(I.detail)};return r.$$set=I=>{"modelIds"in I&&t(10,f=I.modelIds),"models"in I&&t(0,u=I.models),"atSelectedModel"in I&&t(1,c=I.atSelectedModel),"submitPrompt"in I&&t(2,m=I.submitPrompt)},r.$$.update=()=>{r.$$.dirty&3072&&t(0,u=f.map(I=>l.find(k=>k.id===I))),r.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,m,g,_,s,n,i,o,a,f,l,y,p]}class uf extends Be{constructor(e){super(),Se(this,e,ff,af,Ve,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function vr(r,e,t){const l=r.slice();return l[43]=e[t],l[45]=t,l}function cf(r){let e,t=r[3],l,s=wr(r);return{c(){e=E("div"),s.c(),this.h()},l(n){e=N(n,"DIV",{class:!0});var i=w(e);s.l(i),i.forEach(h),this.h()},h(){d(e,"class","w-full pt-2")},m(n,i){V(n,e,i),s.m(e,null),l=!0},p(n,i){i[0]&8&&Ve(t,t=n[3])?(se(),D(s,1,1,ve),re(),s=wr(n),s.c(),b(s,1),s.m(e,null)):s.p(n,i)},i(n){l||(b(s),l=!0)},o(n){D(s),l=!1},d(n){n&&h(e),s.d(n)}}}function df(r){let e,t;return e=new uf({props:{modelIds:r[5],atSelectedModel:r[6],submitPrompt:r[33]}}),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[0]&32&&(n.modelIds=l[5]),s[0]&64&&(n.atSelectedModel=l[6]),s[0]&65538&&(n.submitPrompt=l[33]),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function pr(r){let e,t;return e=new Cn({props:{$$slots:{default:[hf]},$$scope:{ctx:r}}}),e.$on("visible",r[34]),{c(){X(e.$$.fragment)},l(l){$(e.$$.fragment,l)},m(l,s){x(e,l,s),t=!0},p(l,s){const n={};s[1]&32768&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){ee(e,l)}}}function hf(r){let e,t,l,s,n="Loading...",i;return t=new Wt({props:{className:" size-4"}}),{c(){e=E("div"),X(t.$$.fragment),l=H(),s=E("div"),s.textContent=n,this.h()},l(o){e=N(o,"DIV",{class:!0});var a=w(e);$(t.$$.fragment,a),l=z(a),s=N(a,"DIV",{class:!0,"data-svelte-h":!0}),He(s)!=="svelte-17uns3n"&&(s.textContent=n),a.forEach(h),this.h()},h(){d(s,"class",""),d(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){V(o,e,a),x(t,e,null),v(e,l),v(e,s),i=!0},p:ve,i(o){i||(b(t.$$.fragment,o),i=!0)},o(o){D(t.$$.fragment,o),i=!1},d(o){o&&h(e),ee(t)}}}function br(r,e){let t,l,s,n;function i(a){e[35](a)}let o={chatId:e[3],messageId:e[43].id,idx:e[45],user:e[4],showPreviousMessage:e[20],showNextMessage:e[21],updateChat:e[19],editMessage:e[23],deleteMessage:e[26],rateMessage:e[22],actionMessage:e[24],saveMessage:e[25],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[27],readOnly:e[12]};return e[0]!==void 0&&(o.history=e[0]),l=new $a({props:o}),Ae.push(()=>Ke(l,"history",i)),{key:r,first:null,c(){t=ae(),X(l.$$.fragment),this.h()},l(a){t=ae(),$(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){V(a,t,f),x(l,a,f),n=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[43].id),f[0]&16384&&(u.idx=e[45]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ze(()=>s=!1)),l.$set(u)},i(a){n||(b(l.$$.fragment,a),n=!0)},o(a){D(l.$$.fragment,a),n=!1},d(a){a&&h(t),ee(l,a)}}}function kr(r){let e;return{c(){e=E("div"),this.h()},l(t){e=N(t,"DIV",{class:!0}),w(e).forEach(h),this.h()},h(){d(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&h(e)}}}function wr(r){var y;let e,t=((y=r[14].at(0))==null?void 0:y.parentId)!==null,l,s=[],n=new Map,i,o,a,f,u,c=t&&pr(r),m=Ee(r[14]);const g=p=>p[43].id;for(let p=0;p<m.length;p+=1){let I=vr(r,m,p),k=g(I);n.set(k,s[p]=br(k,I))}let _=r[13]&&kr();return{c(){e=E("div"),c&&c.c(),l=H();for(let p=0;p<s.length;p+=1)s[p].c();i=H(),o=E("div"),a=H(),_&&_.c(),f=ae(),this.h()},l(p){e=N(p,"DIV",{class:!0});var I=w(e);c&&c.l(I),l=z(I);for(let k=0;k<s.length;k+=1)s[k].l(I);I.forEach(h),i=z(p),o=N(p,"DIV",{class:!0}),w(o).forEach(h),a=z(p),_&&_.l(p),f=ae(),this.h()},h(){d(e,"class","w-full"),d(o,"class","pb-12")},m(p,I){V(p,e,I),c&&c.m(e,null),v(e,l);for(let k=0;k<s.length;k+=1)s[k]&&s[k].m(e,null);V(p,i,I),V(p,o,I),V(p,a,I),_&&_.m(p,I),V(p,f,I),u=!0},p(p,I){var k;I[0]&16384&&(t=((k=p[14].at(0))==null?void 0:k.parentId)!==null),t?c?(c.p(p,I),I[0]&16384&&b(c,1)):(c=pr(p),c.c(),b(c,1),c.m(e,l)):c&&(se(),D(c,1,1,()=>{c=null}),re()),I[0]&267935641&&(m=Ee(p[14]),se(),s=Gt(s,I,g,1,p,m,n,e,yr,br,null,vr),re()),p[13]?_||(_=kr(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(p){if(!u){b(c);for(let I=0;I<m.length;I+=1)b(s[I]);u=!0}},o(p){D(c);for(let I=0;I<s.length;I+=1)D(s[I]);u=!1},d(p){p&&(h(e),h(i),h(o),h(a),h(f)),c&&c.d();for(let I=0;I<s.length;I+=1)s[I].d();_&&_.d(p)}}}function mf(r){let e,t,l,s,n;const i=[df,cf],o=[];function a(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=a(r,[-1,-1]),s=o[l]=i[l](r),{c(){e=E("div"),s.c(),this.h()},l(f){e=N(f,"DIV",{class:!0});var u=w(e);s.l(u),u.forEach(h),this.h()},h(){d(e,"class",r[2])},m(f,u){V(f,e,u),o[l].m(e,null),n=!0},p(f,u){let c=l;l=a(f,u),l===c?o[l].p(f,u):(se(),D(o[c],1,1,()=>{o[c]=null}),re(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!n||u[0]&4)&&d(e,"class",f[2])},i(f){n||(b(s),n=!0)},o(f){D(s),n=!1},d(f){f&&h(e),o[l].d()}}}function gf(r,e,t){let l,s,n,i,o,a;Me(r,Ht,j=>t(36,l=j)),Me(r,ml,j=>t(37,s=j)),Me(r,cn,j=>t(38,n=j)),Me(r,Zt,j=>t(39,i=j)),Me(r,zt,j=>t(40,o=j)),gt();const f=Ue("i18n");Me(r,f,j=>t(16,a=j));let{className:u="h-full flex pt-8"}=e,{chatId:c=""}=e,{user:m=o}=e,{prompt:g}=e,{history:_={}}=e,{selectedModels:y}=e,{atSelectedModel:p}=e,I=[],{sendPrompt:k}=e,{continueResponse:T}=e,{regenerateResponse:L}=e,{mergeResponses:B}=e,{chatActionHandler:M}=e,{showMessage:S=()=>{}}=e,{submitMessage:O=()=>{}}=e,{addMessages:C=()=>{}}=e,{readOnly:P=!1}=e,{bottomPadding:R=!1}=e,{autoScroll:W}=e,le=20,de=!1;const te=async()=>{const j=document.getElementById("messages-container");j.scrollTop=j.scrollTop+100,t(15,de=!0),t(32,le+=20),await De(),t(15,de=!1)},ne=()=>{const j=document.getElementById("messages-container");j.scrollTop=j.scrollHeight},ue=async()=>{i||(t(0,_),await De(),t(0,_.is_confidential=n,_),await mn(localStorage.token,c,{history:_,messages:I}),ml.set(1),await dn.set(await gn(localStorage.token,s)))},he=async j=>{if(j.parentId!==null){let K=_.messages[j.parentId].childrenIds[Math.max(_.messages[j.parentId].childrenIds.indexOf(j.id)-1,0)];if(j.id!==K){let Y=_.messages[K].childrenIds;for(;Y.length!==0;)K=Y.at(-1),Y=_.messages[K].childrenIds;t(0,_.currentId=K,_)}}else{let K=Object.values(_.messages).filter(G=>G.parentId===null).map(G=>G.id),Y=K[Math.max(K.indexOf(j.id)-1,0)];if(j.id!==Y){let G=_.messages[Y].childrenIds;for(;G.length!==0;)Y=G.at(-1),G=_.messages[Y].childrenIds;t(0,_.currentId=Y,_)}}if(await De(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(28,W=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ne()},100)}},ke=async j=>{if(j.parentId!==null){let K=_.messages[j.parentId].childrenIds[Math.min(_.messages[j.parentId].childrenIds.indexOf(j.id)+1,_.messages[j.parentId].childrenIds.length-1)];if(j.id!==K){let Y=_.messages[K].childrenIds;for(;Y.length!==0;)K=Y.at(-1),Y=_.messages[K].childrenIds;t(0,_.currentId=K,_)}}else{let K=Object.values(_.messages).filter(G=>G.parentId===null).map(G=>G.id),Y=K[Math.min(K.indexOf(j.id)+1,K.length-1)];if(j.id!==Y){let G=_.messages[Y].childrenIds;for(;G.length!==0;)Y=G.at(-1),G=_.messages[Y].childrenIds;t(0,_.currentId=Y,_)}}if(await De(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(28,W=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ne()},100)}},Q=async(j,K)=>{t(0,_.messages[j].annotation={..._.messages[j].annotation,rating:K},_),await ue()},F=async(j,K,Y=!0)=>{if(_.messages[j].role==="user")if(Y){let G=K,ce=gl(),we={id:ce,parentId:_.messages[j].parentId,childrenIds:[],role:"user",content:G,..._.messages[j].files&&{files:_.messages[j].files},models:y,timestamp:Math.floor(Date.now()/1e3)},Ce=_.messages[j].parentId;Ce!==null&&t(0,_.messages[Ce].childrenIds=[..._.messages[Ce].childrenIds,ce],_),t(0,_.messages[ce]=we,_),t(0,_.currentId=ce,_),await De(),await k(_,G,ce)}else t(0,_.messages[j].content=K,_),await ue();else if(Y){const G=gl(),ce=_.messages[j],we=ce.parentId,Ce={...ce,id:G,parentId:we,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,_.messages[G]=Ce,_),t(0,_.currentId=G,_),we!==null&&t(0,_.messages[we].childrenIds=[..._.messages[we].childrenIds,G],_),await ue()}else t(0,_.messages[j].originalContent=_.messages[j].content,_),t(0,_.messages[j].content=K,_),await ue()},A=async(j,K,Y=null)=>{await M(c,j,K.model,K.id,Y)},fe=async(j,K)=>{t(0,_.messages[j]=K,_),await ue()},ie=async j=>{const K=_.messages[j],Y=K.parentId,G=K.childrenIds??[],ce=G.flatMap(we=>{var Ce;return((Ce=_.messages[we])==null?void 0:Ce.childrenIds)??[]});Y&&_.messages[Y]&&t(0,_.messages[Y].childrenIds=[..._.messages[Y].childrenIds.filter(we=>we!==j),...ce],_),ce.forEach(we=>{_.messages[we]&&t(0,_.messages[we].parentId=Y,_)}),[j,...G].forEach(we=>{delete _.messages[we]}),await De(),S({id:Y}),await ue()},ge=()=>{if(W){const j=document.getElementById("messages-container");t(28,W=j.scrollHeight-j.scrollTop<=j.clientHeight+50),setTimeout(()=>{ne()},100)}},ye=async j=>{let K=j;if(j.includes("{{CLIPBOARD}}")){const G=await navigator.clipboard.readText().catch(ce=>(Pe.error(a.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));K=j.replaceAll("{{CLIPBOARD}}",G)}t(1,g=K),await De();const Y=document.getElementById("chat-input-container");Y&&(t(1,g=j),Y.style.height="",Y.style.height=Math.min(Y.scrollHeight,200)+"px",Y.focus()),await De()},_e=j=>{console.log("visible"),de||te()};function oe(j){_=j,t(0,_)}return r.$$set=j=>{"className"in j&&t(2,u=j.className),"chatId"in j&&t(3,c=j.chatId),"user"in j&&t(4,m=j.user),"prompt"in j&&t(1,g=j.prompt),"history"in j&&t(0,_=j.history),"selectedModels"in j&&t(5,y=j.selectedModels),"atSelectedModel"in j&&t(6,p=j.atSelectedModel),"sendPrompt"in j&&t(29,k=j.sendPrompt),"continueResponse"in j&&t(7,T=j.continueResponse),"regenerateResponse"in j&&t(8,L=j.regenerateResponse),"mergeResponses"in j&&t(9,B=j.mergeResponses),"chatActionHandler"in j&&t(30,M=j.chatActionHandler),"showMessage"in j&&t(31,S=j.showMessage),"submitMessage"in j&&t(10,O=j.submitMessage),"addMessages"in j&&t(11,C=j.addMessages),"readOnly"in j&&t(12,P=j.readOnly),"bottomPadding"in j&&t(13,R=j.bottomPadding),"autoScroll"in j&&t(28,W=j.autoScroll)},r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&2)if(_.currentId){let j=[],K=_.messages[_.currentId];for(;K&&j.length<=le;)j.unshift({...K}),K=K.parentId!==null?_.messages[K.parentId]:null;t(14,I=j)}else t(14,I=[]);r.$$.dirty[0]&268443648&&W&&R&&(async()=>(await De(),ne()))()},[_,g,u,c,m,y,p,T,L,B,O,C,P,R,I,de,a,f,te,ue,he,ke,Q,F,A,fe,ie,ge,W,k,M,S,le,ye,_e,oe]}class Yf extends Be{constructor(e){super(),Se(this,e,gf,mf,Ve,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:29,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:30,showMessage:31,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:28},null,[-1,-1])}}export{Gn as E,Sn as K,Yf as M,qn as S};
//# sourceMappingURL=Messages.DXKfQvit.js.map
